psql -h hops.cs.uwaterloo.ca -U yaboulna -p 5433 -d full -c  'CREATE TABLE hgram_cnt_1hr2 ( date         integer,  epochstartux bigint,  ngram        text,  cnt          integer );'
psql -h hops.cs.uwaterloo.ca -U yaboulna -p 5433 -d full -c  "BEGIN;create table hgram_occ_121029_1 as select * from hgram_occ_121029 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121029 where ngramlen = 2); select dropUnextended(121029); ALTER TABLE hgram_occ_121029_1 inherit hgram_occ_121029; CREATE TABLE hgram_cnt_1hr2_121029 AS SELECT 121029 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121029 group by ngram,epochstartux;ALTER TABLE hgram_cnt_1hr2_121029 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121029 AS SELECT 121029 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121029 group by epochstartux;CREATE INDEX hgram_occ_121029_1_date ON hgram_occ_121029_1(date);CREATE INDEX hgram_occ_121029_1_ngramlen ON hgram_occ_121029_1(ngramlen);CREATE INDEX hgram_occ_121029_1_timemillis ON hgram_occ_121029_1(timemillis);CREATE INDEX hgram_cnt_1hr2_121029_date ON hgram_cnt_1hr2_121029(date);CREATE INDEX hgram_cnt_1hr2_121029_time ON hgram_cnt_1hr2_121029(epochstartux);CREATE INDEX hgram_vol_1hr2_121029_time ON hgram_vol_1hr2_121029(epochstartux);COMMIT;"&
echo 'remember to run VACUUM ANALYZE after this is done'
psql -h hops.cs.uwaterloo.ca -U yaboulna -p 5433 -d full -c  "BEGIN;create table hgram_occ_121030_1 as select * from hgram_occ_121030 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121030 where ngramlen = 2); select dropUnextended(121030); ALTER TABLE hgram_occ_121030_1 inherit hgram_occ_121030; CREATE TABLE hgram_cnt_1hr2_121030 AS SELECT 121030 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121030 group by ngram,epochstartux;ALTER TABLE hgram_cnt_1hr2_121030 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121030 AS SELECT 121030 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121030 group by epochstartux;CREATE INDEX hgram_occ_121030_1_date ON hgram_occ_121030_1(date);CREATE INDEX hgram_occ_121030_1_ngramlen ON hgram_occ_121030_1(ngramlen);CREATE INDEX hgram_occ_121030_1_timemillis ON hgram_occ_121030_1(timemillis);CREATE INDEX hgram_cnt_1hr2_121030_date ON hgram_cnt_1hr2_121030(date);CREATE INDEX hgram_cnt_1hr2_121030_time ON hgram_cnt_1hr2_121030(epochstartux);CREATE INDEX hgram_vol_1hr2_121030_time ON hgram_vol_1hr2_121030(epochstartux);COMMIT;"&
echo 'remember to run VACUUM ANALYZE after this is done'
psql -h hops.cs.uwaterloo.ca -U yaboulna -p 5433 -d full -c  "BEGIN;create table hgram_occ_121031_1 as select * from hgram_occ_121031 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121031 where ngramlen = 2); select dropUnextended(121031); ALTER TABLE hgram_occ_121031_1 inherit hgram_occ_121031; CREATE TABLE hgram_cnt_1hr2_121031 AS SELECT 121031 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121031 group by ngram,epochstartux;ALTER TABLE hgram_cnt_1hr2_121031 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121031 AS SELECT 121031 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121031 group by epochstartux;CREATE INDEX hgram_occ_121031_1_date ON hgram_occ_121031_1(date);CREATE INDEX hgram_occ_121031_1_ngramlen ON hgram_occ_121031_1(ngramlen);CREATE INDEX hgram_occ_121031_1_timemillis ON hgram_occ_121031_1(timemillis);CREATE INDEX hgram_cnt_1hr2_121031_date ON hgram_cnt_1hr2_121031(date);CREATE INDEX hgram_cnt_1hr2_121031_time ON hgram_cnt_1hr2_121031(epochstartux);CREATE INDEX hgram_vol_1hr2_121031_time ON hgram_vol_1hr2_121031(epochstartux);COMMIT;"&
echo 'remember to run VACUUM ANALYZE after this is done'
psql -h hops.cs.uwaterloo.ca -U yaboulna -p 5433 -d full -c  "BEGIN;create table hgram_occ_121101_1 as select * from hgram_occ_121101 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121101 where ngramlen = 2); select dropUnextended(121101); ALTER TABLE hgram_occ_121101_1 inherit hgram_occ_121101; CREATE TABLE hgram_cnt_1hr2_121101 AS SELECT 121101 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121101 group by ngram,epochstartux;ALTER TABLE hgram_cnt_1hr2_121101 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121101 AS SELECT 121101 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121101 group by epochstartux;CREATE INDEX hgram_occ_121101_1_date ON hgram_occ_121101_1(date);CREATE INDEX hgram_occ_121101_1_ngramlen ON hgram_occ_121101_1(ngramlen);CREATE INDEX hgram_occ_121101_1_timemillis ON hgram_occ_121101_1(timemillis);CREATE INDEX hgram_cnt_1hr2_121101_date ON hgram_cnt_1hr2_121101(date);CREATE INDEX hgram_cnt_1hr2_121101_time ON hgram_cnt_1hr2_121101(epochstartux);CREATE INDEX hgram_vol_1hr2_121101_time ON hgram_vol_1hr2_121101(epochstartux);COMMIT;"&
echo 'remember to run VACUUM ANALYZE after this is done'
psql -h hops.cs.uwaterloo.ca -U yaboulna -p 5433 -d full -c  "BEGIN;create table hgram_occ_121102_1 as select * from hgram_occ_121102 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121102 where ngramlen = 2); select dropUnextended(121102); ALTER TABLE hgram_occ_121102_1 inherit hgram_occ_121102; CREATE TABLE hgram_cnt_1hr2_121102 AS SELECT 121102 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121102 group by ngram,epochstartux;ALTER TABLE hgram_cnt_1hr2_121102 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121102 AS SELECT 121102 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121102 group by epochstartux;CREATE INDEX hgram_occ_121102_1_date ON hgram_occ_121102_1(date);CREATE INDEX hgram_occ_121102_1_ngramlen ON hgram_occ_121102_1(ngramlen);CREATE INDEX hgram_occ_121102_1_timemillis ON hgram_occ_121102_1(timemillis);CREATE INDEX hgram_cnt_1hr2_121102_date ON hgram_cnt_1hr2_121102(date);CREATE INDEX hgram_cnt_1hr2_121102_time ON hgram_cnt_1hr2_121102(epochstartux);CREATE INDEX hgram_vol_1hr2_121102_time ON hgram_vol_1hr2_121102(epochstartux);COMMIT;"&
echo 'remember to run VACUUM ANALYZE after this is done'
psql -h hops.cs.uwaterloo.ca -U yaboulna -p 5433 -d full -c  "BEGIN;create table hgram_occ_121103_1 as select * from hgram_occ_121103 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121103 where ngramlen = 2); select dropUnextended(121103); ALTER TABLE hgram_occ_121103_1 inherit hgram_occ_121103; CREATE TABLE hgram_cnt_1hr2_121103 AS SELECT 121103 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121103 group by ngram,epochstartux;ALTER TABLE hgram_cnt_1hr2_121103 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121103 AS SELECT 121103 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121103 group by epochstartux;CREATE INDEX hgram_occ_121103_1_date ON hgram_occ_121103_1(date);CREATE INDEX hgram_occ_121103_1_ngramlen ON hgram_occ_121103_1(ngramlen);CREATE INDEX hgram_occ_121103_1_timemillis ON hgram_occ_121103_1(timemillis);CREATE INDEX hgram_cnt_1hr2_121103_date ON hgram_cnt_1hr2_121103(date);CREATE INDEX hgram_cnt_1hr2_121103_time ON hgram_cnt_1hr2_121103(epochstartux);CREATE INDEX hgram_vol_1hr2_121103_time ON hgram_vol_1hr2_121103(epochstartux);COMMIT;"&
echo 'remember to run VACUUM ANALYZE after this is done'
psql -h hops.cs.uwaterloo.ca -U yaboulna -p 5433 -d full -c  "BEGIN;create table hgram_occ_121104_1 as select * from hgram_occ_121104 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121104 where ngramlen = 2); select dropUnextended(121104); ALTER TABLE hgram_occ_121104_1 inherit hgram_occ_121104; CREATE TABLE hgram_cnt_1hr2_121104 AS SELECT 121104 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121104 group by ngram,epochstartux;ALTER TABLE hgram_cnt_1hr2_121104 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121104 AS SELECT 121104 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121104 group by epochstartux;CREATE INDEX hgram_occ_121104_1_date ON hgram_occ_121104_1(date);CREATE INDEX hgram_occ_121104_1_ngramlen ON hgram_occ_121104_1(ngramlen);CREATE INDEX hgram_occ_121104_1_timemillis ON hgram_occ_121104_1(timemillis);CREATE INDEX hgram_cnt_1hr2_121104_date ON hgram_cnt_1hr2_121104(date);CREATE INDEX hgram_cnt_1hr2_121104_time ON hgram_cnt_1hr2_121104(epochstartux);CREATE INDEX hgram_vol_1hr2_121104_time ON hgram_vol_1hr2_121104(epochstartux);COMMIT;"&
echo 'remember to run VACUUM ANALYZE after this is done'
psql -h hops.cs.uwaterloo.ca -U yaboulna -p 5433 -d full -c  "BEGIN;create table hgram_occ_121105_1 as select * from hgram_occ_121105 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121105 where ngramlen = 2); select dropUnextended(121105); ALTER TABLE hgram_occ_121105_1 inherit hgram_occ_121105; CREATE TABLE hgram_cnt_1hr2_121105 AS SELECT 121105 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121105 group by ngram,epochstartux;ALTER TABLE hgram_cnt_1hr2_121105 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121105 AS SELECT 121105 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121105 group by epochstartux;CREATE INDEX hgram_occ_121105_1_date ON hgram_occ_121105_1(date);CREATE INDEX hgram_occ_121105_1_ngramlen ON hgram_occ_121105_1(ngramlen);CREATE INDEX hgram_occ_121105_1_timemillis ON hgram_occ_121105_1(timemillis);CREATE INDEX hgram_cnt_1hr2_121105_date ON hgram_cnt_1hr2_121105(date);CREATE INDEX hgram_cnt_1hr2_121105_time ON hgram_cnt_1hr2_121105(epochstartux);CREATE INDEX hgram_vol_1hr2_121105_time ON hgram_vol_1hr2_121105(epochstartux);COMMIT;"&
echo 'remember to run VACUUM ANALYZE after this is done'
psql -h hops.cs.uwaterloo.ca -U yaboulna -p 5433 -d full -c  "BEGIN;create table hgram_occ_121106_1 as select * from hgram_occ_121106 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121106 where ngramlen = 2); select dropUnextended(121106); ALTER TABLE hgram_occ_121106_1 inherit hgram_occ_121106; CREATE TABLE hgram_cnt_1hr2_121106 AS SELECT 121106 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121106 group by ngram,epochstartux;ALTER TABLE hgram_cnt_1hr2_121106 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121106 AS SELECT 121106 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121106 group by epochstartux;CREATE INDEX hgram_occ_121106_1_date ON hgram_occ_121106_1(date);CREATE INDEX hgram_occ_121106_1_ngramlen ON hgram_occ_121106_1(ngramlen);CREATE INDEX hgram_occ_121106_1_timemillis ON hgram_occ_121106_1(timemillis);CREATE INDEX hgram_cnt_1hr2_121106_date ON hgram_cnt_1hr2_121106(date);CREATE INDEX hgram_cnt_1hr2_121106_time ON hgram_cnt_1hr2_121106(epochstartux);CREATE INDEX hgram_vol_1hr2_121106_time ON hgram_vol_1hr2_121106(epochstartux);COMMIT;"&
echo 'remember to run VACUUM ANALYZE after this is done'
psql -h hops.cs.uwaterloo.ca -U yaboulna -p 5433 -d full -c  "BEGIN;create table hgram_occ_121107_1 as select * from hgram_occ_121107 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121107 where ngramlen = 2); select dropUnextended(121107); ALTER TABLE hgram_occ_121107_1 inherit hgram_occ_121107; CREATE TABLE hgram_cnt_1hr2_121107 AS SELECT 121107 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121107 group by ngram,epochstartux;ALTER TABLE hgram_cnt_1hr2_121107 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121107 AS SELECT 121107 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121107 group by epochstartux;CREATE INDEX hgram_occ_121107_1_date ON hgram_occ_121107_1(date);CREATE INDEX hgram_occ_121107_1_ngramlen ON hgram_occ_121107_1(ngramlen);CREATE INDEX hgram_occ_121107_1_timemillis ON hgram_occ_121107_1(timemillis);CREATE INDEX hgram_cnt_1hr2_121107_date ON hgram_cnt_1hr2_121107(date);CREATE INDEX hgram_cnt_1hr2_121107_time ON hgram_cnt_1hr2_121107(epochstartux);CREATE INDEX hgram_vol_1hr2_121107_time ON hgram_vol_1hr2_121107(epochstartux);COMMIT;"&
echo 'remember to run VACUUM ANALYZE after this is done'
