psql -h hops -U yaboulna -p 5433 -d full -c  'CREATE TABLE hgram_cnt_1hr2 ( date         integer,  epochstartux bigint,  ngram        text,  cnt          integer );'
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121011;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121011;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121011_1 () inherits (hgram_occ_121011); insert into hgram_occ_121011_1 select * from hgram_occ_121011 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121011 where ngramlen = 2); select dropUnextended(121011); CREATE TABLE hgram_cnt_1hr2_121011 AS SELECT 121011 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121011 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121011_date ON hgram_cnt_1hr2_121011(date);CREATE INDEX hgram_cnt_1hr2_121011_time ON hgram_cnt_1hr2_121011(epochstartux);ALTER TABLE hgram_cnt_1hr2_121011 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121011 AS SELECT 121011 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121011 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121011_time ON hgram_vol_1hr2_121011(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121012;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121012;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121012_1 () inherits (hgram_occ_121012); insert into hgram_occ_121012_1 select * from hgram_occ_121012 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121012 where ngramlen = 2); select dropUnextended(121012); CREATE TABLE hgram_cnt_1hr2_121012 AS SELECT 121012 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121012 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121012_date ON hgram_cnt_1hr2_121012(date);CREATE INDEX hgram_cnt_1hr2_121012_time ON hgram_cnt_1hr2_121012(epochstartux);ALTER TABLE hgram_cnt_1hr2_121012 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121012 AS SELECT 121012 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121012 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121012_time ON hgram_vol_1hr2_121012(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121013;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121013;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121013_1 () inherits (hgram_occ_121013); insert into hgram_occ_121013_1 select * from hgram_occ_121013 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121013 where ngramlen = 2); select dropUnextended(121013); CREATE TABLE hgram_cnt_1hr2_121013 AS SELECT 121013 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121013 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121013_date ON hgram_cnt_1hr2_121013(date);CREATE INDEX hgram_cnt_1hr2_121013_time ON hgram_cnt_1hr2_121013(epochstartux);ALTER TABLE hgram_cnt_1hr2_121013 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121013 AS SELECT 121013 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121013 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121013_time ON hgram_vol_1hr2_121013(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121014;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121014;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121014_1 () inherits (hgram_occ_121014); insert into hgram_occ_121014_1 select * from hgram_occ_121014 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121014 where ngramlen = 2); select dropUnextended(121014); CREATE TABLE hgram_cnt_1hr2_121014 AS SELECT 121014 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121014 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121014_date ON hgram_cnt_1hr2_121014(date);CREATE INDEX hgram_cnt_1hr2_121014_time ON hgram_cnt_1hr2_121014(epochstartux);ALTER TABLE hgram_cnt_1hr2_121014 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121014 AS SELECT 121014 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121014 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121014_time ON hgram_vol_1hr2_121014(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121015;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121015;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121015_1 () inherits (hgram_occ_121015); insert into hgram_occ_121015_1 select * from hgram_occ_121015 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121015 where ngramlen = 2); select dropUnextended(121015); CREATE TABLE hgram_cnt_1hr2_121015 AS SELECT 121015 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121015 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121015_date ON hgram_cnt_1hr2_121015(date);CREATE INDEX hgram_cnt_1hr2_121015_time ON hgram_cnt_1hr2_121015(epochstartux);ALTER TABLE hgram_cnt_1hr2_121015 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121015 AS SELECT 121015 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121015 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121015_time ON hgram_vol_1hr2_121015(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121016;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121016;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121016_1 () inherits (hgram_occ_121016); insert into hgram_occ_121016_1 select * from hgram_occ_121016 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121016 where ngramlen = 2); select dropUnextended(121016); CREATE TABLE hgram_cnt_1hr2_121016 AS SELECT 121016 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121016 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121016_date ON hgram_cnt_1hr2_121016(date);CREATE INDEX hgram_cnt_1hr2_121016_time ON hgram_cnt_1hr2_121016(epochstartux);ALTER TABLE hgram_cnt_1hr2_121016 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121016 AS SELECT 121016 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121016 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121016_time ON hgram_vol_1hr2_121016(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121017;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121017;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121017_1 () inherits (hgram_occ_121017); insert into hgram_occ_121017_1 select * from hgram_occ_121017 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121017 where ngramlen = 2); select dropUnextended(121017); CREATE TABLE hgram_cnt_1hr2_121017 AS SELECT 121017 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121017 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121017_date ON hgram_cnt_1hr2_121017(date);CREATE INDEX hgram_cnt_1hr2_121017_time ON hgram_cnt_1hr2_121017(epochstartux);ALTER TABLE hgram_cnt_1hr2_121017 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121017 AS SELECT 121017 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121017 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121017_time ON hgram_vol_1hr2_121017(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121018;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121018;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121018_1 () inherits (hgram_occ_121018); insert into hgram_occ_121018_1 select * from hgram_occ_121018 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121018 where ngramlen = 2); select dropUnextended(121018); CREATE TABLE hgram_cnt_1hr2_121018 AS SELECT 121018 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121018 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121018_date ON hgram_cnt_1hr2_121018(date);CREATE INDEX hgram_cnt_1hr2_121018_time ON hgram_cnt_1hr2_121018(epochstartux);ALTER TABLE hgram_cnt_1hr2_121018 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121018 AS SELECT 121018 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121018 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121018_time ON hgram_vol_1hr2_121018(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121019;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121019;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121019_1 () inherits (hgram_occ_121019); insert into hgram_occ_121019_1 select * from hgram_occ_121019 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121019 where ngramlen = 2); select dropUnextended(121019); CREATE TABLE hgram_cnt_1hr2_121019 AS SELECT 121019 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121019 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121019_date ON hgram_cnt_1hr2_121019(date);CREATE INDEX hgram_cnt_1hr2_121019_time ON hgram_cnt_1hr2_121019(epochstartux);ALTER TABLE hgram_cnt_1hr2_121019 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121019 AS SELECT 121019 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121019 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121019_time ON hgram_vol_1hr2_121019(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121020;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121020;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121020_1 () inherits (hgram_occ_121020); insert into hgram_occ_121020_1 select * from hgram_occ_121020 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121020 where ngramlen = 2); select dropUnextended(121020); CREATE TABLE hgram_cnt_1hr2_121020 AS SELECT 121020 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121020 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121020_date ON hgram_cnt_1hr2_121020(date);CREATE INDEX hgram_cnt_1hr2_121020_time ON hgram_cnt_1hr2_121020(epochstartux);ALTER TABLE hgram_cnt_1hr2_121020 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121020 AS SELECT 121020 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121020 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121020_time ON hgram_vol_1hr2_121020(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121021;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121021;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121021_1 () inherits (hgram_occ_121021); insert into hgram_occ_121021_1 select * from hgram_occ_121021 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121021 where ngramlen = 2); select dropUnextended(121021); CREATE TABLE hgram_cnt_1hr2_121021 AS SELECT 121021 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121021 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121021_date ON hgram_cnt_1hr2_121021(date);CREATE INDEX hgram_cnt_1hr2_121021_time ON hgram_cnt_1hr2_121021(epochstartux);ALTER TABLE hgram_cnt_1hr2_121021 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121021 AS SELECT 121021 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121021 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121021_time ON hgram_vol_1hr2_121021(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121022;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121022;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121022_1 () inherits (hgram_occ_121022); insert into hgram_occ_121022_1 select * from hgram_occ_121022 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121022 where ngramlen = 2); select dropUnextended(121022); CREATE TABLE hgram_cnt_1hr2_121022 AS SELECT 121022 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121022 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121022_date ON hgram_cnt_1hr2_121022(date);CREATE INDEX hgram_cnt_1hr2_121022_time ON hgram_cnt_1hr2_121022(epochstartux);ALTER TABLE hgram_cnt_1hr2_121022 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121022 AS SELECT 121022 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121022 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121022_time ON hgram_vol_1hr2_121022(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121023;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121023;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121023_1 () inherits (hgram_occ_121023); insert into hgram_occ_121023_1 select * from hgram_occ_121023 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121023 where ngramlen = 2); select dropUnextended(121023); CREATE TABLE hgram_cnt_1hr2_121023 AS SELECT 121023 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121023 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121023_date ON hgram_cnt_1hr2_121023(date);CREATE INDEX hgram_cnt_1hr2_121023_time ON hgram_cnt_1hr2_121023(epochstartux);ALTER TABLE hgram_cnt_1hr2_121023 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121023 AS SELECT 121023 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121023 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121023_time ON hgram_vol_1hr2_121023(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121024;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121024;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121024_1 () inherits (hgram_occ_121024); insert into hgram_occ_121024_1 select * from hgram_occ_121024 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121024 where ngramlen = 2); select dropUnextended(121024); CREATE TABLE hgram_cnt_1hr2_121024 AS SELECT 121024 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121024 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121024_date ON hgram_cnt_1hr2_121024(date);CREATE INDEX hgram_cnt_1hr2_121024_time ON hgram_cnt_1hr2_121024(epochstartux);ALTER TABLE hgram_cnt_1hr2_121024 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121024 AS SELECT 121024 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121024 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121024_time ON hgram_vol_1hr2_121024(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121025;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121025;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121025_1 () inherits (hgram_occ_121025); insert into hgram_occ_121025_1 select * from hgram_occ_121025 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121025 where ngramlen = 2); select dropUnextended(121025); CREATE TABLE hgram_cnt_1hr2_121025 AS SELECT 121025 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121025 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121025_date ON hgram_cnt_1hr2_121025(date);CREATE INDEX hgram_cnt_1hr2_121025_time ON hgram_cnt_1hr2_121025(epochstartux);ALTER TABLE hgram_cnt_1hr2_121025 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121025 AS SELECT 121025 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121025 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121025_time ON hgram_vol_1hr2_121025(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121026;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121026;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121026_1 () inherits (hgram_occ_121026); insert into hgram_occ_121026_1 select * from hgram_occ_121026 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121026 where ngramlen = 2); select dropUnextended(121026); CREATE TABLE hgram_cnt_1hr2_121026 AS SELECT 121026 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121026 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121026_date ON hgram_cnt_1hr2_121026(date);CREATE INDEX hgram_cnt_1hr2_121026_time ON hgram_cnt_1hr2_121026(epochstartux);ALTER TABLE hgram_cnt_1hr2_121026 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121026 AS SELECT 121026 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121026 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121026_time ON hgram_vol_1hr2_121026(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121027;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121027;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121027_1 () inherits (hgram_occ_121027); insert into hgram_occ_121027_1 select * from hgram_occ_121027 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121027 where ngramlen = 2); select dropUnextended(121027); CREATE TABLE hgram_cnt_1hr2_121027 AS SELECT 121027 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121027 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121027_date ON hgram_cnt_1hr2_121027(date);CREATE INDEX hgram_cnt_1hr2_121027_time ON hgram_cnt_1hr2_121027(epochstartux);ALTER TABLE hgram_cnt_1hr2_121027 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121027 AS SELECT 121027 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121027 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121027_time ON hgram_vol_1hr2_121027(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121028;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121028;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121028_1 () inherits (hgram_occ_121028); insert into hgram_occ_121028_1 select * from hgram_occ_121028 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121028 where ngramlen = 2); select dropUnextended(121028); CREATE TABLE hgram_cnt_1hr2_121028 AS SELECT 121028 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121028 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121028_date ON hgram_cnt_1hr2_121028(date);CREATE INDEX hgram_cnt_1hr2_121028_time ON hgram_cnt_1hr2_121028(epochstartux);ALTER TABLE hgram_cnt_1hr2_121028 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121028 AS SELECT 121028 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121028 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121028_time ON hgram_vol_1hr2_121028(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121029;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121029;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121029_1 () inherits (hgram_occ_121029); insert into hgram_occ_121029_1 select * from hgram_occ_121029 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121029 where ngramlen = 2); select dropUnextended(121029); CREATE TABLE hgram_cnt_1hr2_121029 AS SELECT 121029 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121029 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121029_date ON hgram_cnt_1hr2_121029(date);CREATE INDEX hgram_cnt_1hr2_121029_time ON hgram_cnt_1hr2_121029(epochstartux);ALTER TABLE hgram_cnt_1hr2_121029 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121029 AS SELECT 121029 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121029 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121029_time ON hgram_vol_1hr2_121029(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121030;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121030;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121030_1 () inherits (hgram_occ_121030); insert into hgram_occ_121030_1 select * from hgram_occ_121030 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121030 where ngramlen = 2); select dropUnextended(121030); CREATE TABLE hgram_cnt_1hr2_121030 AS SELECT 121030 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121030 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121030_date ON hgram_cnt_1hr2_121030(date);CREATE INDEX hgram_cnt_1hr2_121030_time ON hgram_cnt_1hr2_121030(epochstartux);ALTER TABLE hgram_cnt_1hr2_121030 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121030 AS SELECT 121030 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121030 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121030_time ON hgram_vol_1hr2_121030(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121031;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121031;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121031_1 () inherits (hgram_occ_121031); insert into hgram_occ_121031_1 select * from hgram_occ_121031 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121031 where ngramlen = 2); select dropUnextended(121031); CREATE TABLE hgram_cnt_1hr2_121031 AS SELECT 121031 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121031 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121031_date ON hgram_cnt_1hr2_121031(date);CREATE INDEX hgram_cnt_1hr2_121031_time ON hgram_cnt_1hr2_121031(epochstartux);ALTER TABLE hgram_cnt_1hr2_121031 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121031 AS SELECT 121031 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121031 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121031_time ON hgram_vol_1hr2_121031(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121101;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121101;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121101_1 () inherits (hgram_occ_121101); insert into hgram_occ_121101_1 select * from hgram_occ_121101 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121101 where ngramlen = 2); select dropUnextended(121101); CREATE TABLE hgram_cnt_1hr2_121101 AS SELECT 121101 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121101 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121101_date ON hgram_cnt_1hr2_121101(date);CREATE INDEX hgram_cnt_1hr2_121101_time ON hgram_cnt_1hr2_121101(epochstartux);ALTER TABLE hgram_cnt_1hr2_121101 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121101 AS SELECT 121101 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121101 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121101_time ON hgram_vol_1hr2_121101(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121102;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121102;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121102_1 () inherits (hgram_occ_121102); insert into hgram_occ_121102_1 select * from hgram_occ_121102 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121102 where ngramlen = 2); select dropUnextended(121102); CREATE TABLE hgram_cnt_1hr2_121102 AS SELECT 121102 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121102 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121102_date ON hgram_cnt_1hr2_121102(date);CREATE INDEX hgram_cnt_1hr2_121102_time ON hgram_cnt_1hr2_121102(epochstartux);ALTER TABLE hgram_cnt_1hr2_121102 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121102 AS SELECT 121102 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121102 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121102_time ON hgram_vol_1hr2_121102(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121103;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121103;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121103_1 () inherits (hgram_occ_121103); insert into hgram_occ_121103_1 select * from hgram_occ_121103 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121103 where ngramlen = 2); select dropUnextended(121103); CREATE TABLE hgram_cnt_1hr2_121103 AS SELECT 121103 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121103 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121103_date ON hgram_cnt_1hr2_121103(date);CREATE INDEX hgram_cnt_1hr2_121103_time ON hgram_cnt_1hr2_121103(epochstartux);ALTER TABLE hgram_cnt_1hr2_121103 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121103 AS SELECT 121103 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121103 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121103_time ON hgram_vol_1hr2_121103(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121104;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121104;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121104_1 () inherits (hgram_occ_121104); insert into hgram_occ_121104_1 select * from hgram_occ_121104 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121104 where ngramlen = 2); select dropUnextended(121104); CREATE TABLE hgram_cnt_1hr2_121104 AS SELECT 121104 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121104 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121104_date ON hgram_cnt_1hr2_121104(date);CREATE INDEX hgram_cnt_1hr2_121104_time ON hgram_cnt_1hr2_121104(epochstartux);ALTER TABLE hgram_cnt_1hr2_121104 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121104 AS SELECT 121104 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121104 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121104_time ON hgram_vol_1hr2_121104(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121105;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121105;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121105_1 () inherits (hgram_occ_121105); insert into hgram_occ_121105_1 select * from hgram_occ_121105 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121105 where ngramlen = 2); select dropUnextended(121105); CREATE TABLE hgram_cnt_1hr2_121105 AS SELECT 121105 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121105 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121105_date ON hgram_cnt_1hr2_121105(date);CREATE INDEX hgram_cnt_1hr2_121105_time ON hgram_cnt_1hr2_121105(epochstartux);ALTER TABLE hgram_cnt_1hr2_121105 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121105 AS SELECT 121105 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121105 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121105_time ON hgram_vol_1hr2_121105(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121106;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121106;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121106_1 () inherits (hgram_occ_121106); insert into hgram_occ_121106_1 select * from hgram_occ_121106 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121106 where ngramlen = 2); select dropUnextended(121106); CREATE TABLE hgram_cnt_1hr2_121106 AS SELECT 121106 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121106 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121106_date ON hgram_cnt_1hr2_121106(date);CREATE INDEX hgram_cnt_1hr2_121106_time ON hgram_cnt_1hr2_121106(epochstartux);ALTER TABLE hgram_cnt_1hr2_121106 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121106 AS SELECT 121106 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121106 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121106_time ON hgram_vol_1hr2_121106(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121107;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121107;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121107_1 () inherits (hgram_occ_121107); insert into hgram_occ_121107_1 select * from hgram_occ_121107 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121107 where ngramlen = 2); select dropUnextended(121107); CREATE TABLE hgram_cnt_1hr2_121107 AS SELECT 121107 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121107 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121107_date ON hgram_cnt_1hr2_121107(date);CREATE INDEX hgram_cnt_1hr2_121107_time ON hgram_cnt_1hr2_121107(epochstartux);ALTER TABLE hgram_cnt_1hr2_121107 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121107 AS SELECT 121107 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121107 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121107_time ON hgram_vol_1hr2_121107(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121108;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121108;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121108_1 () inherits (hgram_occ_121108); insert into hgram_occ_121108_1 select * from hgram_occ_121108 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121108 where ngramlen = 2); select dropUnextended(121108); CREATE TABLE hgram_cnt_1hr2_121108 AS SELECT 121108 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121108 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121108_date ON hgram_cnt_1hr2_121108(date);CREATE INDEX hgram_cnt_1hr2_121108_time ON hgram_cnt_1hr2_121108(epochstartux);ALTER TABLE hgram_cnt_1hr2_121108 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121108 AS SELECT 121108 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121108 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121108_time ON hgram_vol_1hr2_121108(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121109;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121109;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121109_1 () inherits (hgram_occ_121109); insert into hgram_occ_121109_1 select * from hgram_occ_121109 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121109 where ngramlen = 2); select dropUnextended(121109); CREATE TABLE hgram_cnt_1hr2_121109 AS SELECT 121109 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121109 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121109_date ON hgram_cnt_1hr2_121109(date);CREATE INDEX hgram_cnt_1hr2_121109_time ON hgram_cnt_1hr2_121109(epochstartux);ALTER TABLE hgram_cnt_1hr2_121109 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121109 AS SELECT 121109 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121109 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121109_time ON hgram_vol_1hr2_121109(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121110;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121110;"
psql -h hops -U yaboulna -p 5433 -d full -c  "create table hgram_occ_121110_1 () inherits (hgram_occ_121110); insert into hgram_occ_121110_1 select * from hgram_occ_121110 where ngramlen = 1 and (id,pos) not in (select id,(pos+1) from hgram_occ_121110 where ngramlen = 2); select dropUnextended(121110); CREATE TABLE hgram_cnt_1hr2_121110 AS SELECT 121110 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121110 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121110_date ON hgram_cnt_1hr2_121110(date);CREATE INDEX hgram_cnt_1hr2_121110_time ON hgram_cnt_1hr2_121110(epochstartux);ALTER TABLE hgram_cnt_1hr2_121110 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121110 AS SELECT 121110 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121110 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121110_time ON hgram_vol_1hr2_121110(epochstartux);"&
