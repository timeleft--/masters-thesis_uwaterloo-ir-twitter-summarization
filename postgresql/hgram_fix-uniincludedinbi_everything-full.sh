psql -h hops -U yaboulna -p 5433 -d full -c  'CREATE TABLE hgram_cnt_1hr2 ( date         integer,  epochstartux bigint,  ngram        text,  cnt          integer );'
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121110;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121110;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121110 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121110 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121110 AS SELECT 121110 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121110 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121110_date ON hgram_cnt_1hr2_121110(date);CREATE INDEX hgram_cnt_1hr2_121110_time ON hgram_cnt_1hr2_121110(epochstartux);ALTER TABLE hgram_cnt_1hr2_121110 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121110 AS SELECT 121110 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121110 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121110_time ON hgram_vol_1hr2_121110(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_130103;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_130103;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_130103 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_130103 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_130103 AS SELECT 130103 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_130103 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_130103_date ON hgram_cnt_1hr2_130103(date);CREATE INDEX hgram_cnt_1hr2_130103_time ON hgram_cnt_1hr2_130103(epochstartux);ALTER TABLE hgram_cnt_1hr2_130103 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_130103 AS SELECT 130103 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_130103 group by epochstartux;CREATE INDEX hgram_vol_1hr2_130103_time ON hgram_vol_1hr2_130103(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121016;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121016;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121016 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121016 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121016 AS SELECT 121016 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121016 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121016_date ON hgram_cnt_1hr2_121016(date);CREATE INDEX hgram_cnt_1hr2_121016_time ON hgram_cnt_1hr2_121016(epochstartux);ALTER TABLE hgram_cnt_1hr2_121016 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121016 AS SELECT 121016 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121016 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121016_time ON hgram_vol_1hr2_121016(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121206;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121206;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121206 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121206 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121206 AS SELECT 121206 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121206 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121206_date ON hgram_cnt_1hr2_121206(date);CREATE INDEX hgram_cnt_1hr2_121206_time ON hgram_cnt_1hr2_121206(epochstartux);ALTER TABLE hgram_cnt_1hr2_121206 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121206 AS SELECT 121206 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121206 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121206_time ON hgram_vol_1hr2_121206(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121210;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121210;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121210 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121210 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121210 AS SELECT 121210 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121210 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121210_date ON hgram_cnt_1hr2_121210(date);CREATE INDEX hgram_cnt_1hr2_121210_time ON hgram_cnt_1hr2_121210(epochstartux);ALTER TABLE hgram_cnt_1hr2_121210 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121210 AS SELECT 121210 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121210 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121210_time ON hgram_vol_1hr2_121210(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_120925;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_120925;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_120925 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_120925 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_120925 AS SELECT 120925 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_120925 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_120925_date ON hgram_cnt_1hr2_120925(date);CREATE INDEX hgram_cnt_1hr2_120925_time ON hgram_cnt_1hr2_120925(epochstartux);ALTER TABLE hgram_cnt_1hr2_120925 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_120925 AS SELECT 120925 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_120925 group by epochstartux;CREATE INDEX hgram_vol_1hr2_120925_time ON hgram_vol_1hr2_120925(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121223;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121223;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121223 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121223 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121223 AS SELECT 121223 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121223 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121223_date ON hgram_cnt_1hr2_121223(date);CREATE INDEX hgram_cnt_1hr2_121223_time ON hgram_cnt_1hr2_121223(epochstartux);ALTER TABLE hgram_cnt_1hr2_121223 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121223 AS SELECT 121223 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121223 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121223_time ON hgram_vol_1hr2_121223(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121205;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121205;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121205 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121205 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121205 AS SELECT 121205 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121205 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121205_date ON hgram_cnt_1hr2_121205(date);CREATE INDEX hgram_cnt_1hr2_121205_time ON hgram_cnt_1hr2_121205(epochstartux);ALTER TABLE hgram_cnt_1hr2_121205 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121205 AS SELECT 121205 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121205 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121205_time ON hgram_vol_1hr2_121205(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_130104;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_130104;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_130104 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_130104 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_130104 AS SELECT 130104 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_130104 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_130104_date ON hgram_cnt_1hr2_130104(date);CREATE INDEX hgram_cnt_1hr2_130104_time ON hgram_cnt_1hr2_130104(epochstartux);ALTER TABLE hgram_cnt_1hr2_130104 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_130104 AS SELECT 130104 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_130104 group by epochstartux;CREATE INDEX hgram_vol_1hr2_130104_time ON hgram_vol_1hr2_130104(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121108;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121108;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121108 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121108 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121108 AS SELECT 121108 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121108 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121108_date ON hgram_cnt_1hr2_121108(date);CREATE INDEX hgram_cnt_1hr2_121108_time ON hgram_cnt_1hr2_121108(epochstartux);ALTER TABLE hgram_cnt_1hr2_121108 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121108 AS SELECT 121108 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121108 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121108_time ON hgram_vol_1hr2_121108(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121214;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121214;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121214 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121214 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121214 AS SELECT 121214 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121214 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121214_date ON hgram_cnt_1hr2_121214(date);CREATE INDEX hgram_cnt_1hr2_121214_time ON hgram_cnt_1hr2_121214(epochstartux);ALTER TABLE hgram_cnt_1hr2_121214 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121214 AS SELECT 121214 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121214 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121214_time ON hgram_vol_1hr2_121214(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121030;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121030;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121030 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121030 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121030 AS SELECT 121030 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121030 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121030_date ON hgram_cnt_1hr2_121030(date);CREATE INDEX hgram_cnt_1hr2_121030_time ON hgram_cnt_1hr2_121030(epochstartux);ALTER TABLE hgram_cnt_1hr2_121030 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121030 AS SELECT 121030 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121030 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121030_time ON hgram_vol_1hr2_121030(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_120930;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_120930;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_120930 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_120930 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_120930 AS SELECT 120930 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_120930 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_120930_date ON hgram_cnt_1hr2_120930(date);CREATE INDEX hgram_cnt_1hr2_120930_time ON hgram_cnt_1hr2_120930(epochstartux);ALTER TABLE hgram_cnt_1hr2_120930 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_120930 AS SELECT 120930 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_120930 group by epochstartux;CREATE INDEX hgram_vol_1hr2_120930_time ON hgram_vol_1hr2_120930(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121123;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121123;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121123 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121123 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121123 AS SELECT 121123 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121123 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121123_date ON hgram_cnt_1hr2_121123(date);CREATE INDEX hgram_cnt_1hr2_121123_time ON hgram_cnt_1hr2_121123(epochstartux);ALTER TABLE hgram_cnt_1hr2_121123 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121123 AS SELECT 121123 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121123 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121123_time ON hgram_vol_1hr2_121123(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121125;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121125;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121125 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121125 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121125 AS SELECT 121125 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121125 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121125_date ON hgram_cnt_1hr2_121125(date);CREATE INDEX hgram_cnt_1hr2_121125_time ON hgram_cnt_1hr2_121125(epochstartux);ALTER TABLE hgram_cnt_1hr2_121125 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121125 AS SELECT 121125 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121125 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121125_time ON hgram_vol_1hr2_121125(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121027;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121027;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121027 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121027 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121027 AS SELECT 121027 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121027 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121027_date ON hgram_cnt_1hr2_121027(date);CREATE INDEX hgram_cnt_1hr2_121027_time ON hgram_cnt_1hr2_121027(epochstartux);ALTER TABLE hgram_cnt_1hr2_121027 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121027 AS SELECT 121027 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121027 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121027_time ON hgram_vol_1hr2_121027(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121105;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121105;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121105 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121105 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121105 AS SELECT 121105 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121105 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121105_date ON hgram_cnt_1hr2_121105(date);CREATE INDEX hgram_cnt_1hr2_121105_time ON hgram_cnt_1hr2_121105(epochstartux);ALTER TABLE hgram_cnt_1hr2_121105 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121105 AS SELECT 121105 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121105 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121105_time ON hgram_vol_1hr2_121105(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121116;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121116;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121116 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121116 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121116 AS SELECT 121116 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121116 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121116_date ON hgram_cnt_1hr2_121116(date);CREATE INDEX hgram_cnt_1hr2_121116_time ON hgram_cnt_1hr2_121116(epochstartux);ALTER TABLE hgram_cnt_1hr2_121116 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121116 AS SELECT 121116 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121116 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121116_time ON hgram_vol_1hr2_121116(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121106;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121106;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121106 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121106 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121106 AS SELECT 121106 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121106 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121106_date ON hgram_cnt_1hr2_121106(date);CREATE INDEX hgram_cnt_1hr2_121106_time ON hgram_cnt_1hr2_121106(epochstartux);ALTER TABLE hgram_cnt_1hr2_121106 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121106 AS SELECT 121106 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121106 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121106_time ON hgram_vol_1hr2_121106(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121222;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121222;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121222 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121222 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121222 AS SELECT 121222 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121222 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121222_date ON hgram_cnt_1hr2_121222(date);CREATE INDEX hgram_cnt_1hr2_121222_time ON hgram_cnt_1hr2_121222(epochstartux);ALTER TABLE hgram_cnt_1hr2_121222 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121222 AS SELECT 121222 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121222 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121222_time ON hgram_vol_1hr2_121222(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121026;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121026;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121026 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121026 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121026 AS SELECT 121026 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121026 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121026_date ON hgram_cnt_1hr2_121026(date);CREATE INDEX hgram_cnt_1hr2_121026_time ON hgram_cnt_1hr2_121026(epochstartux);ALTER TABLE hgram_cnt_1hr2_121026 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121026 AS SELECT 121026 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121026 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121026_time ON hgram_vol_1hr2_121026(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121028;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121028;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121028 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121028 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121028 AS SELECT 121028 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121028 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121028_date ON hgram_cnt_1hr2_121028(date);CREATE INDEX hgram_cnt_1hr2_121028_time ON hgram_cnt_1hr2_121028(epochstartux);ALTER TABLE hgram_cnt_1hr2_121028 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121028 AS SELECT 121028 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121028 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121028_time ON hgram_vol_1hr2_121028(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_120926;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_120926;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_120926 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_120926 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_120926 AS SELECT 120926 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_120926 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_120926_date ON hgram_cnt_1hr2_120926(date);CREATE INDEX hgram_cnt_1hr2_120926_time ON hgram_cnt_1hr2_120926(epochstartux);ALTER TABLE hgram_cnt_1hr2_120926 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_120926 AS SELECT 120926 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_120926 group by epochstartux;CREATE INDEX hgram_vol_1hr2_120926_time ON hgram_vol_1hr2_120926(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121008;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121008;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121008 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121008 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121008 AS SELECT 121008 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121008 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121008_date ON hgram_cnt_1hr2_121008(date);CREATE INDEX hgram_cnt_1hr2_121008_time ON hgram_cnt_1hr2_121008(epochstartux);ALTER TABLE hgram_cnt_1hr2_121008 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121008 AS SELECT 121008 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121008 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121008_time ON hgram_vol_1hr2_121008(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121104;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121104;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121104 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121104 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121104 AS SELECT 121104 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121104 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121104_date ON hgram_cnt_1hr2_121104(date);CREATE INDEX hgram_cnt_1hr2_121104_time ON hgram_cnt_1hr2_121104(epochstartux);ALTER TABLE hgram_cnt_1hr2_121104 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121104 AS SELECT 121104 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121104 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121104_time ON hgram_vol_1hr2_121104(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121103;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121103;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121103 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121103 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121103 AS SELECT 121103 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121103 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121103_date ON hgram_cnt_1hr2_121103(date);CREATE INDEX hgram_cnt_1hr2_121103_time ON hgram_cnt_1hr2_121103(epochstartux);ALTER TABLE hgram_cnt_1hr2_121103 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121103 AS SELECT 121103 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121103 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121103_time ON hgram_vol_1hr2_121103(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121122;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121122;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121122 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121122 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121122 AS SELECT 121122 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121122 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121122_date ON hgram_cnt_1hr2_121122(date);CREATE INDEX hgram_cnt_1hr2_121122_time ON hgram_cnt_1hr2_121122(epochstartux);ALTER TABLE hgram_cnt_1hr2_121122 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121122 AS SELECT 121122 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121122 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121122_time ON hgram_vol_1hr2_121122(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121114;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121114;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121114 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121114 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121114 AS SELECT 121114 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121114 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121114_date ON hgram_cnt_1hr2_121114(date);CREATE INDEX hgram_cnt_1hr2_121114_time ON hgram_cnt_1hr2_121114(epochstartux);ALTER TABLE hgram_cnt_1hr2_121114 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121114 AS SELECT 121114 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121114 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121114_time ON hgram_vol_1hr2_121114(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121231;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121231;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121231 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121231 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121231 AS SELECT 121231 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121231 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121231_date ON hgram_cnt_1hr2_121231(date);CREATE INDEX hgram_cnt_1hr2_121231_time ON hgram_cnt_1hr2_121231(epochstartux);ALTER TABLE hgram_cnt_1hr2_121231 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121231 AS SELECT 121231 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121231 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121231_time ON hgram_vol_1hr2_121231(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_120914;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_120914;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_120914 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_120914 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_120914 AS SELECT 120914 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_120914 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_120914_date ON hgram_cnt_1hr2_120914(date);CREATE INDEX hgram_cnt_1hr2_120914_time ON hgram_cnt_1hr2_120914(epochstartux);ALTER TABLE hgram_cnt_1hr2_120914 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_120914 AS SELECT 120914 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_120914 group by epochstartux;CREATE INDEX hgram_vol_1hr2_120914_time ON hgram_vol_1hr2_120914(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121120;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121120;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121120 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121120 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121120 AS SELECT 121120 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121120 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121120_date ON hgram_cnt_1hr2_121120(date);CREATE INDEX hgram_cnt_1hr2_121120_time ON hgram_cnt_1hr2_121120(epochstartux);ALTER TABLE hgram_cnt_1hr2_121120 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121120 AS SELECT 121120 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121120 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121120_time ON hgram_vol_1hr2_121120(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121119;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121119;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121119 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121119 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121119 AS SELECT 121119 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121119 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121119_date ON hgram_cnt_1hr2_121119(date);CREATE INDEX hgram_cnt_1hr2_121119_time ON hgram_cnt_1hr2_121119(epochstartux);ALTER TABLE hgram_cnt_1hr2_121119 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121119 AS SELECT 121119 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121119 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121119_time ON hgram_vol_1hr2_121119(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121029;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121029;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121029 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121029 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121029 AS SELECT 121029 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121029 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121029_date ON hgram_cnt_1hr2_121029(date);CREATE INDEX hgram_cnt_1hr2_121029_time ON hgram_cnt_1hr2_121029(epochstartux);ALTER TABLE hgram_cnt_1hr2_121029 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121029 AS SELECT 121029 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121029 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121029_time ON hgram_vol_1hr2_121029(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121215;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121215;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121215 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121215 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121215 AS SELECT 121215 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121215 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121215_date ON hgram_cnt_1hr2_121215(date);CREATE INDEX hgram_cnt_1hr2_121215_time ON hgram_cnt_1hr2_121215(epochstartux);ALTER TABLE hgram_cnt_1hr2_121215 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121215 AS SELECT 121215 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121215 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121215_time ON hgram_vol_1hr2_121215(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121013;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121013;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121013 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121013 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121013 AS SELECT 121013 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121013 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121013_date ON hgram_cnt_1hr2_121013(date);CREATE INDEX hgram_cnt_1hr2_121013_time ON hgram_cnt_1hr2_121013(epochstartux);ALTER TABLE hgram_cnt_1hr2_121013 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121013 AS SELECT 121013 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121013 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121013_time ON hgram_vol_1hr2_121013(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121220;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121220;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121220 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121220 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121220 AS SELECT 121220 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121220 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121220_date ON hgram_cnt_1hr2_121220(date);CREATE INDEX hgram_cnt_1hr2_121220_time ON hgram_cnt_1hr2_121220(epochstartux);ALTER TABLE hgram_cnt_1hr2_121220 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121220 AS SELECT 121220 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121220 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121220_time ON hgram_vol_1hr2_121220(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121212;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121212;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121212 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121212 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121212 AS SELECT 121212 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121212 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121212_date ON hgram_cnt_1hr2_121212(date);CREATE INDEX hgram_cnt_1hr2_121212_time ON hgram_cnt_1hr2_121212(epochstartux);ALTER TABLE hgram_cnt_1hr2_121212 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121212 AS SELECT 121212 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121212 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121212_time ON hgram_vol_1hr2_121212(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121111;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121111;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121111 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121111 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121111 AS SELECT 121111 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121111 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121111_date ON hgram_cnt_1hr2_121111(date);CREATE INDEX hgram_cnt_1hr2_121111_time ON hgram_cnt_1hr2_121111(epochstartux);ALTER TABLE hgram_cnt_1hr2_121111 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121111 AS SELECT 121111 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121111 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121111_time ON hgram_vol_1hr2_121111(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121217;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121217;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121217 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121217 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121217 AS SELECT 121217 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121217 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121217_date ON hgram_cnt_1hr2_121217(date);CREATE INDEX hgram_cnt_1hr2_121217_time ON hgram_cnt_1hr2_121217(epochstartux);ALTER TABLE hgram_cnt_1hr2_121217 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121217 AS SELECT 121217 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121217 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121217_time ON hgram_vol_1hr2_121217(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_130101;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_130101;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_130101 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_130101 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_130101 AS SELECT 130101 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_130101 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_130101_date ON hgram_cnt_1hr2_130101(date);CREATE INDEX hgram_cnt_1hr2_130101_time ON hgram_cnt_1hr2_130101(epochstartux);ALTER TABLE hgram_cnt_1hr2_130101 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_130101 AS SELECT 130101 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_130101 group by epochstartux;CREATE INDEX hgram_vol_1hr2_130101_time ON hgram_vol_1hr2_130101(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121226;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121226;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121226 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121226 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121226 AS SELECT 121226 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121226 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121226_date ON hgram_cnt_1hr2_121226(date);CREATE INDEX hgram_cnt_1hr2_121226_time ON hgram_cnt_1hr2_121226(epochstartux);ALTER TABLE hgram_cnt_1hr2_121226 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121226 AS SELECT 121226 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121226 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121226_time ON hgram_vol_1hr2_121226(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121127;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121127;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121127 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121127 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121127 AS SELECT 121127 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121127 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121127_date ON hgram_cnt_1hr2_121127(date);CREATE INDEX hgram_cnt_1hr2_121127_time ON hgram_cnt_1hr2_121127(epochstartux);ALTER TABLE hgram_cnt_1hr2_121127 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121127 AS SELECT 121127 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121127 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121127_time ON hgram_vol_1hr2_121127(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121128;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121128;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121128 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121128 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121128 AS SELECT 121128 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121128 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121128_date ON hgram_cnt_1hr2_121128(date);CREATE INDEX hgram_cnt_1hr2_121128_time ON hgram_cnt_1hr2_121128(epochstartux);ALTER TABLE hgram_cnt_1hr2_121128 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121128 AS SELECT 121128 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121128 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121128_time ON hgram_vol_1hr2_121128(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121124;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121124;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121124 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121124 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121124 AS SELECT 121124 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121124 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121124_date ON hgram_cnt_1hr2_121124(date);CREATE INDEX hgram_cnt_1hr2_121124_time ON hgram_cnt_1hr2_121124(epochstartux);ALTER TABLE hgram_cnt_1hr2_121124 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121124 AS SELECT 121124 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121124 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121124_time ON hgram_vol_1hr2_121124(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121229;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121229;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121229 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121229 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121229 AS SELECT 121229 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121229 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121229_date ON hgram_cnt_1hr2_121229(date);CREATE INDEX hgram_cnt_1hr2_121229_time ON hgram_cnt_1hr2_121229(epochstartux);ALTER TABLE hgram_cnt_1hr2_121229 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121229 AS SELECT 121229 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121229 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121229_time ON hgram_vol_1hr2_121229(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121020;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121020;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121020 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121020 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121020 AS SELECT 121020 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121020 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121020_date ON hgram_cnt_1hr2_121020(date);CREATE INDEX hgram_cnt_1hr2_121020_time ON hgram_cnt_1hr2_121020(epochstartux);ALTER TABLE hgram_cnt_1hr2_121020 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121020 AS SELECT 121020 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121020 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121020_time ON hgram_vol_1hr2_121020(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_120913;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_120913;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_120913 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_120913 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_120913 AS SELECT 120913 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_120913 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_120913_date ON hgram_cnt_1hr2_120913(date);CREATE INDEX hgram_cnt_1hr2_120913_time ON hgram_cnt_1hr2_120913(epochstartux);ALTER TABLE hgram_cnt_1hr2_120913 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_120913 AS SELECT 120913 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_120913 group by epochstartux;CREATE INDEX hgram_vol_1hr2_120913_time ON hgram_vol_1hr2_120913(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121121;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121121;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121121 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121121 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121121 AS SELECT 121121 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121121 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121121_date ON hgram_cnt_1hr2_121121(date);CREATE INDEX hgram_cnt_1hr2_121121_time ON hgram_cnt_1hr2_121121(epochstartux);ALTER TABLE hgram_cnt_1hr2_121121 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121121 AS SELECT 121121 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121121 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121121_time ON hgram_vol_1hr2_121121(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121007;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121007;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121007 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121007 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121007 AS SELECT 121007 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121007 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121007_date ON hgram_cnt_1hr2_121007(date);CREATE INDEX hgram_cnt_1hr2_121007_time ON hgram_cnt_1hr2_121007(epochstartux);ALTER TABLE hgram_cnt_1hr2_121007 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121007 AS SELECT 121007 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121007 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121007_time ON hgram_vol_1hr2_121007(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121010;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121010;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121010 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121010 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121010 AS SELECT 121010 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121010 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121010_date ON hgram_cnt_1hr2_121010(date);CREATE INDEX hgram_cnt_1hr2_121010_time ON hgram_cnt_1hr2_121010(epochstartux);ALTER TABLE hgram_cnt_1hr2_121010 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121010 AS SELECT 121010 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121010 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121010_time ON hgram_vol_1hr2_121010(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121203;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121203;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121203 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121203 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121203 AS SELECT 121203 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121203 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121203_date ON hgram_cnt_1hr2_121203(date);CREATE INDEX hgram_cnt_1hr2_121203_time ON hgram_cnt_1hr2_121203(epochstartux);ALTER TABLE hgram_cnt_1hr2_121203 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121203 AS SELECT 121203 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121203 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121203_time ON hgram_vol_1hr2_121203(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121207;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121207;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121207 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121207 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121207 AS SELECT 121207 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121207 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121207_date ON hgram_cnt_1hr2_121207(date);CREATE INDEX hgram_cnt_1hr2_121207_time ON hgram_cnt_1hr2_121207(epochstartux);ALTER TABLE hgram_cnt_1hr2_121207 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121207 AS SELECT 121207 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121207 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121207_time ON hgram_vol_1hr2_121207(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121218;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121218;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121218 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121218 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121218 AS SELECT 121218 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121218 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121218_date ON hgram_cnt_1hr2_121218(date);CREATE INDEX hgram_cnt_1hr2_121218_time ON hgram_cnt_1hr2_121218(epochstartux);ALTER TABLE hgram_cnt_1hr2_121218 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121218 AS SELECT 121218 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121218 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121218_time ON hgram_vol_1hr2_121218(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_130102;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_130102;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_130102 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_130102 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_130102 AS SELECT 130102 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_130102 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_130102_date ON hgram_cnt_1hr2_130102(date);CREATE INDEX hgram_cnt_1hr2_130102_time ON hgram_cnt_1hr2_130102(epochstartux);ALTER TABLE hgram_cnt_1hr2_130102 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_130102 AS SELECT 130102 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_130102 group by epochstartux;CREATE INDEX hgram_vol_1hr2_130102_time ON hgram_vol_1hr2_130102(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121025;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121025;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121025 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121025 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121025 AS SELECT 121025 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121025 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121025_date ON hgram_cnt_1hr2_121025(date);CREATE INDEX hgram_cnt_1hr2_121025_time ON hgram_cnt_1hr2_121025(epochstartux);ALTER TABLE hgram_cnt_1hr2_121025 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121025 AS SELECT 121025 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121025 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121025_time ON hgram_vol_1hr2_121025(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_120920;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_120920;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_120920 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_120920 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_120920 AS SELECT 120920 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_120920 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_120920_date ON hgram_cnt_1hr2_120920(date);CREATE INDEX hgram_cnt_1hr2_120920_time ON hgram_cnt_1hr2_120920(epochstartux);ALTER TABLE hgram_cnt_1hr2_120920 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_120920 AS SELECT 120920 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_120920 group by epochstartux;CREATE INDEX hgram_vol_1hr2_120920_time ON hgram_vol_1hr2_120920(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_120929;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_120929;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_120929 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_120929 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_120929 AS SELECT 120929 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_120929 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_120929_date ON hgram_cnt_1hr2_120929(date);CREATE INDEX hgram_cnt_1hr2_120929_time ON hgram_cnt_1hr2_120929(epochstartux);ALTER TABLE hgram_cnt_1hr2_120929 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_120929 AS SELECT 120929 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_120929 group by epochstartux;CREATE INDEX hgram_vol_1hr2_120929_time ON hgram_vol_1hr2_120929(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121009;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121009;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121009 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121009 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121009 AS SELECT 121009 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121009 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121009_date ON hgram_cnt_1hr2_121009(date);CREATE INDEX hgram_cnt_1hr2_121009_time ON hgram_cnt_1hr2_121009(epochstartux);ALTER TABLE hgram_cnt_1hr2_121009 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121009 AS SELECT 121009 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121009 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121009_time ON hgram_vol_1hr2_121009(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121126;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121126;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121126 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121126 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121126 AS SELECT 121126 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121126 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121126_date ON hgram_cnt_1hr2_121126(date);CREATE INDEX hgram_cnt_1hr2_121126_time ON hgram_cnt_1hr2_121126(epochstartux);ALTER TABLE hgram_cnt_1hr2_121126 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121126 AS SELECT 121126 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121126 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121126_time ON hgram_vol_1hr2_121126(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121021;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121021;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121021 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121021 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121021 AS SELECT 121021 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121021 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121021_date ON hgram_cnt_1hr2_121021(date);CREATE INDEX hgram_cnt_1hr2_121021_time ON hgram_cnt_1hr2_121021(epochstartux);ALTER TABLE hgram_cnt_1hr2_121021 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121021 AS SELECT 121021 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121021 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121021_time ON hgram_vol_1hr2_121021(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121002;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121002;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121002 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121002 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121002 AS SELECT 121002 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121002 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121002_date ON hgram_cnt_1hr2_121002(date);CREATE INDEX hgram_cnt_1hr2_121002_time ON hgram_cnt_1hr2_121002(epochstartux);ALTER TABLE hgram_cnt_1hr2_121002 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121002 AS SELECT 121002 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121002 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121002_time ON hgram_vol_1hr2_121002(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121201;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121201;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121201 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121201 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121201 AS SELECT 121201 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121201 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121201_date ON hgram_cnt_1hr2_121201(date);CREATE INDEX hgram_cnt_1hr2_121201_time ON hgram_cnt_1hr2_121201(epochstartux);ALTER TABLE hgram_cnt_1hr2_121201 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121201 AS SELECT 121201 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121201 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121201_time ON hgram_vol_1hr2_121201(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_120918;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_120918;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_120918 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_120918 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_120918 AS SELECT 120918 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_120918 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_120918_date ON hgram_cnt_1hr2_120918(date);CREATE INDEX hgram_cnt_1hr2_120918_time ON hgram_cnt_1hr2_120918(epochstartux);ALTER TABLE hgram_cnt_1hr2_120918 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_120918 AS SELECT 120918 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_120918 group by epochstartux;CREATE INDEX hgram_vol_1hr2_120918_time ON hgram_vol_1hr2_120918(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_120919;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_120919;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_120919 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_120919 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_120919 AS SELECT 120919 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_120919 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_120919_date ON hgram_cnt_1hr2_120919(date);CREATE INDEX hgram_cnt_1hr2_120919_time ON hgram_cnt_1hr2_120919(epochstartux);ALTER TABLE hgram_cnt_1hr2_120919 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_120919 AS SELECT 120919 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_120919 group by epochstartux;CREATE INDEX hgram_vol_1hr2_120919_time ON hgram_vol_1hr2_120919(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_120927;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_120927;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_120927 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_120927 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_120927 AS SELECT 120927 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_120927 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_120927_date ON hgram_cnt_1hr2_120927(date);CREATE INDEX hgram_cnt_1hr2_120927_time ON hgram_cnt_1hr2_120927(epochstartux);ALTER TABLE hgram_cnt_1hr2_120927 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_120927 AS SELECT 120927 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_120927 group by epochstartux;CREATE INDEX hgram_vol_1hr2_120927_time ON hgram_vol_1hr2_120927(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121012;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121012;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121012 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121012 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121012 AS SELECT 121012 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121012 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121012_date ON hgram_cnt_1hr2_121012(date);CREATE INDEX hgram_cnt_1hr2_121012_time ON hgram_cnt_1hr2_121012(epochstartux);ALTER TABLE hgram_cnt_1hr2_121012 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121012 AS SELECT 121012 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121012 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121012_time ON hgram_vol_1hr2_121012(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_120924;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_120924;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_120924 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_120924 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_120924 AS SELECT 120924 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_120924 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_120924_date ON hgram_cnt_1hr2_120924(date);CREATE INDEX hgram_cnt_1hr2_120924_time ON hgram_cnt_1hr2_120924(epochstartux);ALTER TABLE hgram_cnt_1hr2_120924 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_120924 AS SELECT 120924 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_120924 group by epochstartux;CREATE INDEX hgram_vol_1hr2_120924_time ON hgram_vol_1hr2_120924(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_120928;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_120928;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_120928 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_120928 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_120928 AS SELECT 120928 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_120928 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_120928_date ON hgram_cnt_1hr2_120928(date);CREATE INDEX hgram_cnt_1hr2_120928_time ON hgram_cnt_1hr2_120928(epochstartux);ALTER TABLE hgram_cnt_1hr2_120928 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_120928 AS SELECT 120928 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_120928 group by epochstartux;CREATE INDEX hgram_vol_1hr2_120928_time ON hgram_vol_1hr2_120928(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121024;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121024;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121024 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121024 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121024 AS SELECT 121024 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121024 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121024_date ON hgram_cnt_1hr2_121024(date);CREATE INDEX hgram_cnt_1hr2_121024_time ON hgram_cnt_1hr2_121024(epochstartux);ALTER TABLE hgram_cnt_1hr2_121024 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121024 AS SELECT 121024 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121024 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121024_time ON hgram_vol_1hr2_121024(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121209;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121209;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121209 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121209 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121209 AS SELECT 121209 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121209 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121209_date ON hgram_cnt_1hr2_121209(date);CREATE INDEX hgram_cnt_1hr2_121209_time ON hgram_cnt_1hr2_121209(epochstartux);ALTER TABLE hgram_cnt_1hr2_121209 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121209 AS SELECT 121209 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121209 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121209_time ON hgram_vol_1hr2_121209(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121115;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121115;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121115 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121115 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121115 AS SELECT 121115 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121115 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121115_date ON hgram_cnt_1hr2_121115(date);CREATE INDEX hgram_cnt_1hr2_121115_time ON hgram_cnt_1hr2_121115(epochstartux);ALTER TABLE hgram_cnt_1hr2_121115 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121115 AS SELECT 121115 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121115 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121115_time ON hgram_vol_1hr2_121115(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121112;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121112;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121112 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121112 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121112 AS SELECT 121112 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121112 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121112_date ON hgram_cnt_1hr2_121112(date);CREATE INDEX hgram_cnt_1hr2_121112_time ON hgram_cnt_1hr2_121112(epochstartux);ALTER TABLE hgram_cnt_1hr2_121112 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121112 AS SELECT 121112 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121112 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121112_time ON hgram_vol_1hr2_121112(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121227;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121227;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121227 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121227 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121227 AS SELECT 121227 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121227 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121227_date ON hgram_cnt_1hr2_121227(date);CREATE INDEX hgram_cnt_1hr2_121227_time ON hgram_cnt_1hr2_121227(epochstartux);ALTER TABLE hgram_cnt_1hr2_121227 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121227 AS SELECT 121227 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121227 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121227_time ON hgram_vol_1hr2_121227(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121101;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121101;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121101 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121101 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121101 AS SELECT 121101 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121101 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121101_date ON hgram_cnt_1hr2_121101(date);CREATE INDEX hgram_cnt_1hr2_121101_time ON hgram_cnt_1hr2_121101(epochstartux);ALTER TABLE hgram_cnt_1hr2_121101 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121101 AS SELECT 121101 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121101 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121101_time ON hgram_vol_1hr2_121101(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121113;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121113;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121113 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121113 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121113 AS SELECT 121113 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121113 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121113_date ON hgram_cnt_1hr2_121113(date);CREATE INDEX hgram_cnt_1hr2_121113_time ON hgram_cnt_1hr2_121113(epochstartux);ALTER TABLE hgram_cnt_1hr2_121113 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121113 AS SELECT 121113 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121113 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121113_time ON hgram_vol_1hr2_121113(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121211;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121211;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121211 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121211 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121211 AS SELECT 121211 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121211 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121211_date ON hgram_cnt_1hr2_121211(date);CREATE INDEX hgram_cnt_1hr2_121211_time ON hgram_cnt_1hr2_121211(epochstartux);ALTER TABLE hgram_cnt_1hr2_121211 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121211 AS SELECT 121211 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121211 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121211_time ON hgram_vol_1hr2_121211(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121204;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121204;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121204 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121204 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121204 AS SELECT 121204 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121204 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121204_date ON hgram_cnt_1hr2_121204(date);CREATE INDEX hgram_cnt_1hr2_121204_time ON hgram_cnt_1hr2_121204(epochstartux);ALTER TABLE hgram_cnt_1hr2_121204 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121204 AS SELECT 121204 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121204 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121204_time ON hgram_vol_1hr2_121204(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_120921;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_120921;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_120921 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_120921 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_120921 AS SELECT 120921 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_120921 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_120921_date ON hgram_cnt_1hr2_120921(date);CREATE INDEX hgram_cnt_1hr2_120921_time ON hgram_cnt_1hr2_120921(epochstartux);ALTER TABLE hgram_cnt_1hr2_120921 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_120921 AS SELECT 120921 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_120921 group by epochstartux;CREATE INDEX hgram_vol_1hr2_120921_time ON hgram_vol_1hr2_120921(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121224;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121224;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121224 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121224 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121224 AS SELECT 121224 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121224 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121224_date ON hgram_cnt_1hr2_121224(date);CREATE INDEX hgram_cnt_1hr2_121224_time ON hgram_cnt_1hr2_121224(epochstartux);ALTER TABLE hgram_cnt_1hr2_121224 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121224 AS SELECT 121224 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121224 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121224_time ON hgram_vol_1hr2_121224(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121130;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121130;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121130 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121130 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121130 AS SELECT 121130 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121130 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121130_date ON hgram_cnt_1hr2_121130(date);CREATE INDEX hgram_cnt_1hr2_121130_time ON hgram_cnt_1hr2_121130(epochstartux);ALTER TABLE hgram_cnt_1hr2_121130 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121130 AS SELECT 121130 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121130 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121130_time ON hgram_vol_1hr2_121130(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121208;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121208;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121208 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121208 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121208 AS SELECT 121208 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121208 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121208_date ON hgram_cnt_1hr2_121208(date);CREATE INDEX hgram_cnt_1hr2_121208_time ON hgram_cnt_1hr2_121208(epochstartux);ALTER TABLE hgram_cnt_1hr2_121208 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121208 AS SELECT 121208 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121208 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121208_time ON hgram_vol_1hr2_121208(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_120922;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_120922;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_120922 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_120922 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_120922 AS SELECT 120922 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_120922 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_120922_date ON hgram_cnt_1hr2_120922(date);CREATE INDEX hgram_cnt_1hr2_120922_time ON hgram_cnt_1hr2_120922(epochstartux);ALTER TABLE hgram_cnt_1hr2_120922 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_120922 AS SELECT 120922 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_120922 group by epochstartux;CREATE INDEX hgram_vol_1hr2_120922_time ON hgram_vol_1hr2_120922(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121230;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121230;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121230 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121230 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121230 AS SELECT 121230 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121230 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121230_date ON hgram_cnt_1hr2_121230(date);CREATE INDEX hgram_cnt_1hr2_121230_time ON hgram_cnt_1hr2_121230(epochstartux);ALTER TABLE hgram_cnt_1hr2_121230 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121230 AS SELECT 121230 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121230 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121230_time ON hgram_vol_1hr2_121230(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121001;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121001;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121001 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121001 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121001 AS SELECT 121001 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121001 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121001_date ON hgram_cnt_1hr2_121001(date);CREATE INDEX hgram_cnt_1hr2_121001_time ON hgram_cnt_1hr2_121001(epochstartux);ALTER TABLE hgram_cnt_1hr2_121001 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121001 AS SELECT 121001 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121001 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121001_time ON hgram_vol_1hr2_121001(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121006;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121006;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121006 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121006 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121006 AS SELECT 121006 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121006 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121006_date ON hgram_cnt_1hr2_121006(date);CREATE INDEX hgram_cnt_1hr2_121006_time ON hgram_cnt_1hr2_121006(epochstartux);ALTER TABLE hgram_cnt_1hr2_121006 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121006 AS SELECT 121006 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121006 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121006_time ON hgram_vol_1hr2_121006(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121031;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121031;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121031 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121031 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121031 AS SELECT 121031 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121031 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121031_date ON hgram_cnt_1hr2_121031(date);CREATE INDEX hgram_cnt_1hr2_121031_time ON hgram_cnt_1hr2_121031(epochstartux);ALTER TABLE hgram_cnt_1hr2_121031 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121031 AS SELECT 121031 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121031 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121031_time ON hgram_vol_1hr2_121031(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121015;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121015;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121015 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121015 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121015 AS SELECT 121015 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121015 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121015_date ON hgram_cnt_1hr2_121015(date);CREATE INDEX hgram_cnt_1hr2_121015_time ON hgram_cnt_1hr2_121015(epochstartux);ALTER TABLE hgram_cnt_1hr2_121015 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121015 AS SELECT 121015 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121015 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121015_time ON hgram_vol_1hr2_121015(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121129;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121129;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121129 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121129 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121129 AS SELECT 121129 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121129 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121129_date ON hgram_cnt_1hr2_121129(date);CREATE INDEX hgram_cnt_1hr2_121129_time ON hgram_cnt_1hr2_121129(epochstartux);ALTER TABLE hgram_cnt_1hr2_121129 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121129 AS SELECT 121129 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121129 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121129_time ON hgram_vol_1hr2_121129(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121014;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121014;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121014 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121014 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121014 AS SELECT 121014 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121014 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121014_date ON hgram_cnt_1hr2_121014(date);CREATE INDEX hgram_cnt_1hr2_121014_time ON hgram_cnt_1hr2_121014(epochstartux);ALTER TABLE hgram_cnt_1hr2_121014 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121014 AS SELECT 121014 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121014 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121014_time ON hgram_vol_1hr2_121014(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121003;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121003;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121003 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121003 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121003 AS SELECT 121003 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121003 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121003_date ON hgram_cnt_1hr2_121003(date);CREATE INDEX hgram_cnt_1hr2_121003_time ON hgram_cnt_1hr2_121003(epochstartux);ALTER TABLE hgram_cnt_1hr2_121003 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121003 AS SELECT 121003 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121003 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121003_time ON hgram_vol_1hr2_121003(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121117;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121117;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121117 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121117 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121117 AS SELECT 121117 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121117 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121117_date ON hgram_cnt_1hr2_121117(date);CREATE INDEX hgram_cnt_1hr2_121117_time ON hgram_cnt_1hr2_121117(epochstartux);ALTER TABLE hgram_cnt_1hr2_121117 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121117 AS SELECT 121117 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121117 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121117_time ON hgram_vol_1hr2_121117(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121118;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121118;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121118 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121118 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121118 AS SELECT 121118 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121118 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121118_date ON hgram_cnt_1hr2_121118(date);CREATE INDEX hgram_cnt_1hr2_121118_time ON hgram_cnt_1hr2_121118(epochstartux);ALTER TABLE hgram_cnt_1hr2_121118 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121118 AS SELECT 121118 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121118 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121118_time ON hgram_vol_1hr2_121118(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121213;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121213;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121213 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121213 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121213 AS SELECT 121213 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121213 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121213_date ON hgram_cnt_1hr2_121213(date);CREATE INDEX hgram_cnt_1hr2_121213_time ON hgram_cnt_1hr2_121213(epochstartux);ALTER TABLE hgram_cnt_1hr2_121213 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121213 AS SELECT 121213 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121213 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121213_time ON hgram_vol_1hr2_121213(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121107;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121107;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121107 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121107 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121107 AS SELECT 121107 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121107 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121107_date ON hgram_cnt_1hr2_121107(date);CREATE INDEX hgram_cnt_1hr2_121107_time ON hgram_cnt_1hr2_121107(epochstartux);ALTER TABLE hgram_cnt_1hr2_121107 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121107 AS SELECT 121107 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121107 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121107_time ON hgram_vol_1hr2_121107(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121109;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121109;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121109 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121109 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121109 AS SELECT 121109 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121109 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121109_date ON hgram_cnt_1hr2_121109(date);CREATE INDEX hgram_cnt_1hr2_121109_time ON hgram_cnt_1hr2_121109(epochstartux);ALTER TABLE hgram_cnt_1hr2_121109 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121109 AS SELECT 121109 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121109 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121109_time ON hgram_vol_1hr2_121109(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121004;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121004;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121004 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121004 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121004 AS SELECT 121004 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121004 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121004_date ON hgram_cnt_1hr2_121004(date);CREATE INDEX hgram_cnt_1hr2_121004_time ON hgram_cnt_1hr2_121004(epochstartux);ALTER TABLE hgram_cnt_1hr2_121004 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121004 AS SELECT 121004 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121004 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121004_time ON hgram_vol_1hr2_121004(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121019;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121019;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121019 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121019 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121019 AS SELECT 121019 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121019 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121019_date ON hgram_cnt_1hr2_121019(date);CREATE INDEX hgram_cnt_1hr2_121019_time ON hgram_cnt_1hr2_121019(epochstartux);ALTER TABLE hgram_cnt_1hr2_121019 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121019 AS SELECT 121019 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121019 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121019_time ON hgram_vol_1hr2_121019(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121022;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121022;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121022 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121022 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121022 AS SELECT 121022 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121022 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121022_date ON hgram_cnt_1hr2_121022(date);CREATE INDEX hgram_cnt_1hr2_121022_time ON hgram_cnt_1hr2_121022(epochstartux);ALTER TABLE hgram_cnt_1hr2_121022 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121022 AS SELECT 121022 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121022 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121022_time ON hgram_vol_1hr2_121022(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121017;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121017;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121017 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121017 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121017 AS SELECT 121017 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121017 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121017_date ON hgram_cnt_1hr2_121017(date);CREATE INDEX hgram_cnt_1hr2_121017_time ON hgram_cnt_1hr2_121017(epochstartux);ALTER TABLE hgram_cnt_1hr2_121017 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121017 AS SELECT 121017 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121017 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121017_time ON hgram_vol_1hr2_121017(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121023;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121023;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121023 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121023 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121023 AS SELECT 121023 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121023 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121023_date ON hgram_cnt_1hr2_121023(date);CREATE INDEX hgram_cnt_1hr2_121023_time ON hgram_cnt_1hr2_121023(epochstartux);ALTER TABLE hgram_cnt_1hr2_121023 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121023 AS SELECT 121023 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121023 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121023_time ON hgram_vol_1hr2_121023(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121216;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121216;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121216 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121216 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121216 AS SELECT 121216 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121216 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121216_date ON hgram_cnt_1hr2_121216(date);CREATE INDEX hgram_cnt_1hr2_121216_time ON hgram_cnt_1hr2_121216(epochstartux);ALTER TABLE hgram_cnt_1hr2_121216 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121216 AS SELECT 121216 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121216 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121216_time ON hgram_vol_1hr2_121216(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121225;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121225;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121225 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121225 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121225 AS SELECT 121225 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121225 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121225_date ON hgram_cnt_1hr2_121225(date);CREATE INDEX hgram_cnt_1hr2_121225_time ON hgram_cnt_1hr2_121225(epochstartux);ALTER TABLE hgram_cnt_1hr2_121225 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121225 AS SELECT 121225 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121225 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121225_time ON hgram_vol_1hr2_121225(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121102;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121102;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121102 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121102 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121102 AS SELECT 121102 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121102 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121102_date ON hgram_cnt_1hr2_121102(date);CREATE INDEX hgram_cnt_1hr2_121102_time ON hgram_cnt_1hr2_121102(epochstartux);ALTER TABLE hgram_cnt_1hr2_121102 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121102 AS SELECT 121102 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121102 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121102_time ON hgram_vol_1hr2_121102(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121202;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121202;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121202 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121202 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121202 AS SELECT 121202 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121202 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121202_date ON hgram_cnt_1hr2_121202(date);CREATE INDEX hgram_cnt_1hr2_121202_time ON hgram_cnt_1hr2_121202(epochstartux);ALTER TABLE hgram_cnt_1hr2_121202 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121202 AS SELECT 121202 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121202 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121202_time ON hgram_vol_1hr2_121202(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121018;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121018;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121018 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121018 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121018 AS SELECT 121018 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121018 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121018_date ON hgram_cnt_1hr2_121018(date);CREATE INDEX hgram_cnt_1hr2_121018_time ON hgram_cnt_1hr2_121018(epochstartux);ALTER TABLE hgram_cnt_1hr2_121018 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121018 AS SELECT 121018 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121018 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121018_time ON hgram_vol_1hr2_121018(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121005;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121005;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121005 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121005 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121005 AS SELECT 121005 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121005 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121005_date ON hgram_cnt_1hr2_121005(date);CREATE INDEX hgram_cnt_1hr2_121005_time ON hgram_cnt_1hr2_121005(epochstartux);ALTER TABLE hgram_cnt_1hr2_121005 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121005 AS SELECT 121005 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121005 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121005_time ON hgram_vol_1hr2_121005(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121011;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121011;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121011 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121011 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121011 AS SELECT 121011 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121011 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121011_date ON hgram_cnt_1hr2_121011(date);CREATE INDEX hgram_cnt_1hr2_121011_time ON hgram_cnt_1hr2_121011(epochstartux);ALTER TABLE hgram_cnt_1hr2_121011 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121011 AS SELECT 121011 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121011 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121011_time ON hgram_vol_1hr2_121011(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_120917;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_120917;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_120917 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_120917 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_120917 AS SELECT 120917 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_120917 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_120917_date ON hgram_cnt_1hr2_120917(date);CREATE INDEX hgram_cnt_1hr2_120917_time ON hgram_cnt_1hr2_120917(epochstartux);ALTER TABLE hgram_cnt_1hr2_120917 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_120917 AS SELECT 120917 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_120917 group by epochstartux;CREATE INDEX hgram_vol_1hr2_120917_time ON hgram_vol_1hr2_120917(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121221;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121221;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121221 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121221 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121221 AS SELECT 121221 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121221 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121221_date ON hgram_cnt_1hr2_121221(date);CREATE INDEX hgram_cnt_1hr2_121221_time ON hgram_cnt_1hr2_121221(epochstartux);ALTER TABLE hgram_cnt_1hr2_121221 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121221 AS SELECT 121221 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121221 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121221_time ON hgram_vol_1hr2_121221(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121228;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121228;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121228 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121228 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121228 AS SELECT 121228 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121228 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121228_date ON hgram_cnt_1hr2_121228(date);CREATE INDEX hgram_cnt_1hr2_121228_time ON hgram_cnt_1hr2_121228(epochstartux);ALTER TABLE hgram_cnt_1hr2_121228 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121228 AS SELECT 121228 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121228 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121228_time ON hgram_vol_1hr2_121228(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_120923;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_120923;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_120923 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_120923 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_120923 AS SELECT 120923 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_120923 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_120923_date ON hgram_cnt_1hr2_120923(date);CREATE INDEX hgram_cnt_1hr2_120923_time ON hgram_cnt_1hr2_120923(epochstartux);ALTER TABLE hgram_cnt_1hr2_120923 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_120923 AS SELECT 120923 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_120923 group by epochstartux;CREATE INDEX hgram_vol_1hr2_120923_time ON hgram_vol_1hr2_120923(epochstartux);"&
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_cnt_1hr2_121219;"
psql -h hops -U yaboulna -p 5433 -d full -c  "DROP TABLE IF EXISTS hgram_vol_1hr2_121219;"
psql -h hops -U yaboulna -p 5433 -d full -c  "delete from hgram_occ_121219 where ngramlen = 1 and (id,pos) in (select id,(pos+1) from hgram_occ_121219 where ngramlen = 2);CREATE TABLE hgram_cnt_1hr2_121219 AS SELECT 121219 as date, CAST(floor(timemillis/(3600 * 1000::INT8))*(3600) AS INT8) as epochstartux, ngram, CAST(count(*) AS INT4) as cnt from hgram_occ_121219 group by ngram,epochstartux;CREATE INDEX hgram_cnt_1hr2_121219_date ON hgram_cnt_1hr2_121219(date);CREATE INDEX hgram_cnt_1hr2_121219_time ON hgram_cnt_1hr2_121219(epochstartux);ALTER TABLE hgram_cnt_1hr2_121219 INHERIT hgram_cnt_1hr2;CREATE TABLE hgram_vol_1hr2_121219 AS SELECT 121219 as date, epochstartux,sum(cnt) as totalcnt from hgram_cnt_1hr2_121219 group by epochstartux;CREATE INDEX hgram_vol_1hr2_121219_time ON hgram_vol_1hr2_121219(epochstartux);"&
