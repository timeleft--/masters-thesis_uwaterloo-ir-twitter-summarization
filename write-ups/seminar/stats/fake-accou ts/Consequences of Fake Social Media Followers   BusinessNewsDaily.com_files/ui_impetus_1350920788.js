/* This source code is Copyright (c) Vibrant Media 2001-2010 and forms part of the patented Vibrant Media product "IntelliTXT" (sm). */
$iTXT.js.loader["$iTXT.ui_impetus.Hook"]=true;$iTXT.ui_impetus=$iTXT.ui_impetus||{};$iTXT.ui_impetus.Hook_Load=function(){var $itxtUtil=$iTXT.core.Util;var cleanString=$itxtUtil.cleanString;$iTXT.ui.HookHelper={defaults:{fgColr:'#009900',fgColrOld:'#006400',bgColr:'transparent',bgColrOld:'transparent',upperLnColr:'#009900',lowerLnColr:'#00CC00',icon:'icon1.png',lbIcon:'lb_icon1.png'},getStyleObjectFromString:function(str){var i,n,k,v,arr,css={};str=cleanString(str);if(!str)return{};arr=str.toLowerCase().split(';');for(i=0,n=arr.length;i<n;i++){arr[i]=arr[i].split(':');if(arr[i].length==2){k=cleanString(arr[i][0]);v=cleanString(arr[i][1]);css[k]=v;}} return css;},getStyleStringFromObject:function(css){return $iTXT.core.Util.buildQueryString(css,';',':');},isCustomStyle:function(style) {var key,numkey=0;if(!style){return false;} for(key in style){if(style.hasOwnProperty(key)){numkey++;}} if(numkey!=7&&numkey!=6){return true;} if((!style['font-weight']||!style['font-size']||!style['text-decoration']||!style['border-bottom']||!style['padding-bottom']||!style['color']||!style['background-color'])&&(!style['text-decoration']||!style['border-bottom']||!style['border-top']||!style['color']||!style['background-color']||!style['padding-bottom'])){return true;} if((style['font-weight']!='normal'||style['font-size']!='100%'||style['text-decoration']!='underline'||style['border-bottom']!='darkgreen 0.075em solid'||style['padding-bottom']!='1px'||style['color']!='darkgreen'||style['background-color']!='transparent')&&(style['text-decoration']!='underline'||style['border-bottom']!='1px solid #006400'||style['border-top']!='none'||style['color']!='#006400'||style['background-color']!='transparent'||style['padding-bottom']!='1px')){return true;} return false;},isCustomActiveStyle:function(style) {var key,numkey=0;if(!style){return false;} for(key in style){if(style.hasOwnProperty(key)){numkey++;}} if(numkey!=7&&numkey!=6){return true;} if((!style['font-weight']||!style['font-size']||!style['text-decoration']||!style['border-bottom']||!style['padding-bottom']||!style['color']||!style['background-color'])&&(!style['text-decoration']||!style['border-bottom']||!style['border-top']||!style['color']||!style['background-color']||!style['padding-bottom'])){return true;} if((style['font-weight']!='normal'||style['font-size']!='100%'||style['text-decoration']!='underline'||style['border-bottom']!='darkgreen 0.2em solid'||style['padding-bottom']!='1px'||style['color']!='darkgreen'||style['background-color']!='transparent')&&(style['text-decoration']!='underline'||style['border-bottom']!='0.2em solid #006400'||style['border-top']!='none'||style['color']!='#006400'||style['background-color']!='transparent'||style['padding-bottom']!='1px')){return true;} return false;}};$iTXT.ui_impetus.Hook=$iTXT.core.Class.create({options:null,isActive:false,childSpans:null,mouseOver:false,mouseOutFireTID:-1,mouseOverTS:null,mouseOverPos:null,mouseOverSpan:null,delayedOverTO:-1,seenAlready:false,seenAfter:-1,hkStyle:null,hkActiveStyle:null,spanStyle:null,spanActiveStyle:null,isImpetus:false,disableIcon:false,_tt:null,_bb:null,_launcher:null,_closer:null,_timer:-1,init:function(_options) {this.defaultOptions=this.options=$iTXT.core.Util.extend({id:0,uid:"id",uidh:"idh",clickUrl:"#",className:"${hk.class}",activeClassName:"${hk.class.active}",hookIconPath:'${hk.icon.path}',hookIconSrc:"${hk.icon}",activeHookIconSrc:"${hk.icon.active}",hookIconStyle:"${hk.icon.style}",value:"hook",hookStyle:"${hk.style}",hookActiveStyle:"${hk.h.style}"},_options);$iTXT.ui.HookManager.add(this);this.keyword=this.options.value;this._events=[];this.setAdvert(this.options.advert||new $iTXT.data.Advert($iTXT.tmpl.TestTemplate,{title:"Hello World!",link:"http://www.google.com",ttthbg:"yellow"}));},setAdvert:function(ad) {this.ad=ad;this.ad.params.set("H.ID",this.options.uid,$iTXT.cnst.WEIGHTING_DEFAULT_CAMPAIGN);this.ad.params.set("H.IDH",this.options.uidh,$iTXT.cnst.WEIGHTING_DEFAULT_CAMPAIGN);var ord=Math.floor(Math.random()*10e12);this.ad.params.set("hookhash",ord);this.ad.processAdvert();},setKeyword:function(kw) {this.keyword=kw;this._buildHook();},setHookId:function(id) {this.rootElement.id=id;},_buildHook:function() {if(!this.ad) return;var p=b;this.ad.createTemplate();var adps=this.ad.params;var w=$iTXT.cnst.WEIGHTING_DEFAULT_CAMPAIGN;var at=this.ad.getAdvertType();var showIcon=adps.getBool("hk.icon.show",true);var p=new $iTXT.data.Param(adps);var eati=p.getBool("eati",false);if(eati) {if(at) {var icon=p.get("atig"+at,p.get("atig"));if("none"==icon) {p.set("hk.icon","",w);p.set("hk.icon.active","",w);this.disableIcon=true;} else if(null!==icon) {p.set("hk.icon",icon,w);p.set("hk.icon.active",icon,w);this.disableIcon=false;} var atis=p.get("atis");if(null!==atis) {p.set("hk.icon.style",atis,w);this.disableIcon=false;}}} else if(showIcon){icon=$iTXT.ui.HookHelper.defaults.icon;if(this.ad.params.getBool("lbox",false)){icon=$iTXT.ui.HookHelper.defaults.lbIcon;} p.set("hk.icon",icon,w);p.set("hk.icon.active",icon,w);this.disableIcon=false;}else{p.set("hk.icon","",w);p.set("hk.icon.active","",w);this.disableIcon=true;} var align=this.ad.params.get("hk.icon.align","right");this.options.hookIconOnRight=(align=="right");var iconStyle=this.ad.params.get("hk.icon.style",p.get("hk.icon.style",null));this.options.hookIconStyle=iconStyle;if(!this.options.hookIconStyle){this.options.hookIconStyle='';} this.options.hookIconStyle=$iTXT.ui.HookHelper.getStyleObjectFromString(this.options.hookIconStyle);this.options.hookIconStyle['padding-top']='0px!important';this.options.hookIconStyle['padding-right']='0px!important';this.options.hookIconStyle['padding-bottom']='0px!important';this.options.hookIconStyle['padding-left']='4px!important';this.options.hookIconStyle['margin-top']='0px!important';this.options.hookIconStyle['margin-right']='0px!important';this.options.hookIconStyle['margin-bottom']='0px!important';this.options.hookIconStyle['margin-left']='0px!important';this.options.hookIconStyle=$iTXT.ui.HookHelper.getStyleStringFromObject(this.options.hookIconStyle);if(at) {var ul=p.get("ul"+at);if(null!==ul) {p.set("hk.style",ul,w);} var hv=p.get("hv"+at);if(null!==hv) {p.set("hk.h.style",hv,w);}} var hks=p.get("hk.style");if(null!==hks&&""!==hks&&"${hk.def.style}"!=hks) {var hkhs=p.get("hk.h.style");if(hkhs===null||""===hkhs||"${hk.def.h.style}"==hkhs) {p.set("hk.h.style","${hk.style};background-color:${hk.bg.h.col};",$iTXT.cnst.WEIGHTING_DEFAULT_CAMPAIGN);}}else{p.set("hk.style","${hk.def.style};padding-bottom:1px;",$iTXT.cnst.WEIGHTING_DEFAULT_CAMPAIGN);p.set("hk.h.style","${hk.def.h.style};padding-bottom:1px;",$iTXT.cnst.WEIGHTING_DEFAULT_CAMPAIGN);} this.ad.template.onBuildHookStyle(this.defaultOptions);this.options=$iTXT.core.Util.cloneObject(this.defaultOptions);this.options=p.tokenize(this.options);if(this.rootElement) {} var b=$iTXT.core.Builder;this.childSpans=[];this.rootElement=b.make("A",{href:this.options.clickUrl,id:"itxthook"+this.options.id,rel:"nofollow"});this.hkStyle=$iTXT.ui.HookHelper.getStyleObjectFromString(this.options.hookStyle.toLowerCase());this.hkActiveStyle=$iTXT.ui.HookHelper.getStyleObjectFromString(this.options.hookActiveStyle.toLowerCase());this.spanStyle=this.hkStyle;this.spanActiveStyle=this.hkActiveStyle;var HkHelper=$iTXT.ui.HookHelper;if(!HkHelper.isCustomStyle(this.spanStyle)&&!HkHelper.isCustomActiveStyle(this.spanActiveStyle)){this.isImpetus=true;this.rootElement.className='itxtnewhook';this.spanStyle['padding-top']=this.spanActiveStyle['padding-top']='0px!important';this.spanStyle['padding-right']=this.spanActiveStyle['padding-right']='0px!important';this.spanStyle['padding-bottom']=this.spanActiveStyle['padding-bottom']='1px!important';this.spanStyle['padding-left']=this.spanActiveStyle['padding-left']='0px!important';this.spanStyle['text-decoration']=this.spanActiveStyle['text-decoration']='underline!important';this.spanStyle['border-top']=this.spanActiveStyle['border-top']='0px none transparent';this.spanStyle['border-right']=this.spanActiveStyle['border-right']='0px none transparent';this.spanStyle['border-left']=this.spanActiveStyle['border-left']='0px none transparent';this.spanStyle['color']=HkHelper.defaults.upperLnColr;this.spanActiveStyle['color']=HkHelper.defaults.upperLnColr;this.spanStyle['border-bottom']='1px solid '+HkHelper.defaults.lowerLnColr;this.spanActiveStyle['border-bottom']='1px solid '+HkHelper.defaults.lowerLnColr;}else{this.spanStyle['padding-bottom']=this.spanStyle['padding-bottom']||'1px';this.spanActiveStyle['padding-bottom']=this.spanActiveStyle['padding-bottom']||'1px';if(this.spanStyle['padding-bottom'].indexOf('!important')<0){this.spanStyle['padding-bottom']+='!important';} if(this.spanActiveStyle['padding-bottom'].indexOf('!important')<0){this.spanActiveStyle['padding-bottom']+='!important';}} if(!this.isImpetus&&!this.ad.params.get('hk.icon')){this.disableIcon=true;} this.options.hookStyle=$iTXT.ui.HookHelper.getStyleStringFromObject(this.hkStyle);this.options.hookActiveStyle=$iTXT.ui.HookHelper.getStyleStringFromObject(this.hkActiveStyle);this.spanStyle=$iTXT.ui.HookHelper.getStyleStringFromObject(this.spanStyle);this.spanActiveStyle=$iTXT.ui.HookHelper.getStyleStringFromObject(this.spanActiveStyle);var hkw=b.make("SPAN",{id:("itxthook"+this.options.id+"w"),className:"itxtnowrap"+($iTXT.core.Browser.isIE7OrLessMode()?'_ie7':''),style:this.spanStyle},[this.keyword]);if(this.isImpetus){hkw.className+=' itxtnewhookspan';} if(!this.disableIcon&&this.options.hookIconSrc.length>0) {this.hookIcon=b.make("IMG",{className:"itxthookicon",id:("itxthook"+this.options.id+"icon"),src:(this.options.hookIconPath+this.options.hookIconSrc),style:this.options.hookIconStyle});var childSpans=[hkw,this.hookIcon];if(!this.options.hookIconOnRight) {childSpans=[this.hookIcon,hkw];} p=b.make("span",{id:("itxthook"+this.options.id+"p"),className:'itxtnowrap'+($iTXT.core.Browser.isIE7OrLessMode()?'_ie7':'')},childSpans);this.childSpans.push(p);} else {this.childSpans.push(hkw);} this.rootElement.itxtAppendChildren(this.childSpans);if($iTXT.ui_impetus.MobtManager.isMobtEnabled(this)){var m=$iTXT.ui_impetus.Mobt;this.mobt_timeout=-1;if(this.options.hookActiveStyle.indexOf("border-bottom")>-1){this.options.hookActiveStyle=this.options.hookActiveStyle.replace(/border-bottom:[^;]+;/,"");} $iTXT.ui_impetus.MobtManager.infest(this);this.rootElement.itxtSubscribe("mouseover",$iTXT.core.Event.bind(this,this._onMobtMouseOver));if(this.isImpetus&&(!$iTXT.core.Browser.supportsFeature("transforms")||!$iTXT.core.Browser.supportsFeature("transitions"))){this.rootElement.itxtSubscribe("mouseover",$iTXT.core.Event.bind(this,function(){var hasIcon=this.rootElement.getElementsByTagName('img').length>0;var span=this.rootElement.firstChild;if(hasIcon){span=span.firstChild;} span.style.color='#00CC00';span.style.borderBottomColor='#00CC00';}));} this.rootElement.itxtSubscribe("mouseout",$iTXT.core.Event.bind(this,m._onHookOut));this.rootElement.itxtSubscribe("$iTXT:tt:close",$iTXT.core.Event.bind(this,m._ttCloseMobt));this.rootElement.itxtSubscribe("$iTXT:tt:ittc",$iTXT.core.Event.bind(this,m._ttCancelled));this.rootElement.itxtSubscribe("$iTXT:tt:mouse:out",$iTXT.core.Event.bind(this,m._ttMouseOut));}else{this.rootElement.itxtSubscribe("mouseover",$iTXT.core.Event.bind(this,this._onMouseOver));this.rootElement.itxtSubscribe("mouseout",$iTXT.core.Event.bind(this,this._onMouseOut));} this.rootElement.itxtSubscribe("click",$iTXT.core.Event.bind(this,this._onClick));this.rootElement.itxtSubscribe("touchend",$iTXT.core.Event.bind(this,this._onTouch));this.ad.setHook(this);this.updateHookStyle();},updateHookStyle:function() {if(this.isActive) {this.rootElement.itxtAddClass(this.options.activeClassName,this.options.className);this.updateSpanStyle(this.spanActiveStyle);if(!this.disableIcon&&""!==this.options.hookIconSrc&&""!==this.options.activeHookIconSrc) {this.hookIcon.src=this.options.hookIconPath+this.options.activeHookIconSrc;}} else {this.rootElement.itxtAddClass(this.options.className,this.options.activeClassName);this.updateSpanStyle(this.spanStyle);if(!this.disableIcon&&""!==this.options.hookIconSrc) {this.hookIcon.src=this.options.hookIconPath+this.options.hookIconSrc;}}},updateSpanStyle:function(css) {var hasIcon=this.rootElement.getElementsByTagName('img').length>0;var span=this.rootElement.firstChild;if(hasIcon){span=span.getElementsByTagName('span')[0];} span.style.cssText=css;},getHook:function() {return this.rootElement;},isWrapped:function() {if(this.childSpans.length==1) return false;var span1Off=this.childSpans[0].itxtTotalOffset();var span2Off=this.childSpans[this.childSpans.length-1].itxtTotalOffset();return(span1Off.top!=span2Off.top);},saveTT:function(obj){this._tt=obj;},saveBounds:function(bb){this._bb=bb;},saveTTLaunchFunction:function(launch){this._launcher=launch;},_onMouseOver:function(e){this._clearMouseTID();var targ=this._captureMousePos(e);if(targ){var t=this;this.delayedOverTO=setTimeout(function(){t.fireMouseOver(targ);},10);}},_onMobtMouseOver:function(e){this.hookIn(e);this._onMouseOver(e);},_clearMouseTID:function(){if(this.mouseOutFireTID!=-1) {window.clearTimeout(this.mouseOutFireTID);this.mouseOutFireTID=-1;}},_captureMousePos:function(e) {var target=e.srcElement||e.target;var scrollTop=0,scrollLeft=0;this.mouseOverSpan=target;if(target==this.rootElement) {$iTXT.core.$(document).itxtFire("$iTXT:hook:in",{hookid:this.options.id,hook:this});return false;} $iTXT.debug.info($iTXT.debug.Category.HOOK,"Mouse over hook: "+this.options.value);this.mouseOverTS=(new Date()).getTime();try {scrollTop=document.documentElement.scrollTop||document.body.scrollTop;scrollLeft=document.documentElement.scrollLeft||document.body.scrollLeft;} catch(er) {scrollTop=0;scrollLeft=0;} this.mouseOverPos={x:e.clientX+scrollLeft,y:e.clientY+scrollTop};return target;},fireMouseOver:function(target) {this.mouseOver=true;target.itxtSetStyle({position:"relative"});var tOff=$iTXT.core.$(target).itxtTotalOffset();target.itxtSetStyle({position:""});var bb={left:tOff.left,top:tOff.top,width:target.offsetWidth,height:target.offsetHeight,target:target};$iTXT.core.$(document).itxtFire("$iTXT:hook:over",{bounds:bb,hookid:this.options.id,hook:this});},_onMouseOut:function(e) {if(this.delayedOverTO!=-1) {clearTimeout(this.delayedOverTO);} if(this.mouseOver) {var t=this;this.mouseOutFireTID=window.setTimeout(function(){t._mouseOutFire(e);},20);}},_mouseOutFire:function(e) {this.mouseOver=false;var len=(new Date()).getTime()-this.mouseOverTS;$iTXT.core.$(document).itxtFire("$iTXT:hook:out",{hookid:this.options.id,hook:this,len:len});},_onClick:function(e) {var src=(e.target==this.hookIcon)?$iTXT.data.ClickSource.ICON:$iTXT.data.ClickSource.KEYWORD;$iTXT.core.$(document).itxtFire("$iTXT:hook:click",{source:src,hookid:this.options.id,hook:this,advert:this.ad});return false;},_onTouch:function(e) {var src=(e.target==this.hookIcon)?$iTXT.data.ClickSource.ICON:$iTXT.data.ClickSource.KEYWORD;$iTXT.core.$(document).itxtFire("$iTXT:hook:touch",{source:src,hookid:this.options.id,hook:this,advert:this.ad});return false;},setState:function(s) {this.isActive=s;this.updateHookStyle();},getPosition:function() {return this.rootElement.itxtTotalOffset();},setHookStyle:function(s,as) {if(s) {this.options.hookStyle=s;} if(as) {this.options.hookActiveStyle=as;} this.updateHookStyle();},_updateSpanCol:function() {var c=this.rootElement.style.color;for(var i=0;i<this.childSpans.length;i++) {this.childSpans[i].style.color=c;if(this.childSpans[i].nodeName.toLowerCase()!='span') {this._updateInnerSpanCol(this.childSpans[i],c);}}},_updateInnerSpanCol:function(parent,color) {var nodes=parent.childNodes,node,nodeName,i=0,n=nodes.length;for(;i<n;i++) {node=nodes[i];nodeName=node.nodeName.toLowerCase();if(nodeName=='span') {node.style.color=color;}}}});};$iTXT.js.loader["$iTXT.ui_impetus.Mobt"]=true;$iTXT.ui_impetus=$iTXT.ui_impetus||{};$iTXT.ui_impetus.Mobt_Load=function(){$iTXT.ui_impetus.Mobt={defaults:{color:'#000000',colorHover:'#003399',bgColor:'#F0F0F0',bgColorHover:'#F0F0F0',iconWidth:20,iconHeight:20,openDelay:0,hideDelay:1000},initMobt:function(){var b=$iTXT.core.Builder,holder,mobtHookEl,mobtIconEl;holder=document.getElementById('itxtmobtholder');if(!holder){holder=b.make('div',{id:"itxtmobtholder"});holder.itxtSetStyle({position:"absolute",left:"0px",top:"0px"});document.body.appendChild(holder);holder.className="";} function _makeicon(ctx){var mobtIconEl,that;var icon_w=$iTXT.ui_impetus.Mobt.defaults.iconWidth,icon_h=$iTXT.ui_impetus.Mobt.defaults.iconHeight;if(ctx.options.hookMobtIconWidth&&!isNaN(parseInt(ctx.options.hookMobtIconWidth,10))){icon_w=parseInt(ctx.options.hookMobtIconWidth,10);} mobtIconEl=b.make("img",{"src":ctx.options.hookMobtIcon,"width":icon_w,"height":icon_h,style:"width:"+icon_w+"px;height:"+icon_h+"px"});mobtIconEl.className="mobt_icon";return mobtIconEl;} if(this.options.hookMobtModern){if(this.options.hookMobtIcon){mobtHookEl=b.make("div",{},[_makeicon(this),this.options.hookMobtText]);} else{mobtHookEl=b.make("div",{},[this.options.hookMobtText]);} mobtHookEl.className="mobt_hook";}else{if(this.options.hookMobtIcon){mobtHookEl=b.makeNoReset("div",{},[b.makeNoReset("div",{},[],"mobt_sprite_left"),b.makeNoReset("div",{},[_makeicon(this),this.options.hookMobtText],"mobt_sprite_middle"),b.makeNoReset("div",{},[],"mobt_sprite_right")],"mobt_hook_legacy");}else{mobtHookEl=b.makeNoReset("div",{},[b.makeNoReset("div",{},[],"mobt_sprite_left"),b.makeNoReset("div",{},[this.options.hookMobtText],"mobt_sprite_middle"),b.makeNoReset("div",{},[],"mobt_sprite_right")],"mobt_hook_legacy");}} this.mobt=b.makeEl("div",{id:"itxt_mbtc_"+this.ad.did,style:"left:-1000px"},[mobtHookEl],{resets:"mobt_container"});that=this;$iTXT.ui_impetus.MobtWatcher.add(that.mobt.id,that.closeMobt,that.keyword);var offsets=$iTXT.core.Util.getElementPosition(this.rootElement);var defaultStyles={};defaultStyles.top=(offsets.top-5)+"px";var bgcolor=$iTXT.ui_impetus.Mobt.defaults.bgColor;if(this.options.hookMobtBgColor!==undefined&&this.options.hookMobtBgColor!==""){bgcolor=this.options.hookMobtBgColor;} if(this.options.hookMobtColor!==undefined&&this.options.hookMobtColor!==""){defaultStyles.color=this.options.hookMobtColor;} this.mobt.itxtSetStyle(defaultStyles);this.mobt.itxtSubscribe('mouseover',$iTXT.core.Event.bind(this,$iTXT.ui_impetus.Mobt._onMobtIn));this.mobt.itxtSubscribe('mouseout',$iTXT.core.Event.bind(this,$iTXT.ui_impetus.Mobt._onMobtOut));this.mobt.firstChild.itxtSubscribe('click',$iTXT.core.Event.bind(this,$iTXT.ui_impetus.Mobt._onMobtClick));this.built=true;holder.appendChild(this.mobt);},addMobtOptions:function(){var opts=this.options,params=this.ad.params,def=$iTXT.ui_impetus.Mobt.defaults;opts.hookMobtModern=$iTXT.core.Browser.supportsFeature("transforms")&&$iTXT.core.Browser.supportsFeature("transitions");opts.hookMobtText=params.get("hk.mobt.text","")||this.keyword;opts.hookMobtIcon=decodeURIComponent(params.get("hk.mobt.icon",""));opts.hookMobtIconWidth=params.get("hk.mobt.icon.width",def.iconWidth);opts.hookMobtColor=decodeURIComponent(params.get("hk.mobt.text.color",""));opts.hookMobtColorHover=decodeURIComponent(params.get("hk.mobt.h.text.color",""));$iTXT.ui_impetus.Mobt._delayOptions.call(this);},_delayOptions:function(){var opts=this.options,params=this.ad.params,def=$iTXT.ui_impetus.Mobt.defaults,ttd;opts.hookMobtOpenDelay=parseInt(params.get("hk.mobt.delay",def.openDelay),10);opts.hookMobtHideDelay=parseInt(params.get("hk.mobt.hide.delay",def.hideDelay),10);ttd=parseInt(params.get("tt.open.delay",params.get("ttd",100)),10);if(isNaN(opts.hookMobtOpenDelay)||opts.hookMobtOpenDelay<=0){opts.hookMobtOpenDelay=def.openDelay;} if(isNaN(opts.hookMobtHideDelay)||opts.hookMobtHideDelay<=0){opts.hookMobtHideDelay=def.hideDelay;} if(isNaN(ttd)){ttd=100;}else if(ttd>1000){ttd=750;} if(opts.hookMobtOpenDelay>ttd){opts.hookMobtOpenDelay=(ttd-200)<0?def.openDelay:ttd-200;}},_mobtCoverOn:function(el){if(document.getElementById("cover_"+el.ad.did)){return;} var offsets=el.rootElement.itxtTotalOffset();var topModifier=4;var leftModifier=el.options.hookMobtModern?-1:-2;var widther=8;var style=["position: absolute","top:"+(offsets[1]-topModifier)+"px","left:"+((offsets[0]-widther/2)+leftModifier)+"px","width:"+(el.rootElement.itxtBounds().width)+"px","height:"+(el.rootElement.itxtBounds().height)+"px"];var hotdog=$iTXT.core.Builder.make("div",{"style":style.join(';')},[]);if(!el.options.hookMobtModern){hotdog.style.backgroundColor='transparent';hotdog.style.boxShadow='none';} hotdog.id="cover_"+el.ad.did;hotdog.className="mobt_hook_cover";document.getElementById('itxtmobtholder').appendChild(hotdog);return hotdog;},preMobt:function(){var that=this,el;function getHookStyle(props){var util=$iTXT.core.Util,hk=that.rootElement,css={},i,n,val;for(i=0,n=props.length;i<n;i++){val=util.getStyle(hk,props[i][0],props[i][1]);if(val){css[props[i][0]]=val;}} return css;} if(!this.isImpetus){return;} el=document.createElement('div');el.className=this.options.hookMobtModern?'mobt_premobt_modern':'mobt_premobt_legacy';for(var i=0,n=this.rootElement.childNodes.length;i<n;i++){var clone=this.rootElement.childNodes[i].cloneNode(true);el.appendChild(clone);} if(this.options.hookMobtModern){var hookSpans=el.getElementsByTagName('span');var styleFromHook=getHookStyle([['font-family','fontFamily'],['font-size','fontSize'],['font-weight','fontWeight']]);styleFromHook=$iTXT.ui.HookHelper.getStyleStringFromObject(styleFromHook);for(i=0,n=hookSpans.length;i<n;i++){var style;style=hookSpans[i].style.cssText.toLowerCase();style=$iTXT.ui.HookHelper.getStyleObjectFromString(style);style['border-bottom-width']='0px!important';style['border-bottom-style']='none!important';style['border-bottom-color']='transparent!important';style['text-decoration']='none!important';style=$iTXT.ui.HookHelper.getStyleStringFromObject(style);hookSpans[i].style.cssText=style+';'+styleFromHook;}} else{this.rootElement.style.visibility='hidden';} if(this.mobtCover){this.mobtCover.appendChild(el);} setTimeout(function(){el.className+=' animate';},20);},flipMobt:function(left,l_offset,t_offset){var that=this;var top_off=0;this.mobtCover=$iTXT.ui_impetus.Mobt._mobtCoverOn(this);this.preMobt();this.mobt.itxtSetStyle({left:Math.floor(left)+"px"});this.mobt.firstChild.itxtSetStyle({left:l_offset+"px",top:top_off+"px",MozTransitionDelay:"250ms",MozTransform:"rotateX(0deg)",WebkitTransitionDelay:"250ms",WebkitTransform:"rotateX(0deg)",transitionDelay:"250ms",transform:"rotateX(0deg)"});if(this.mobtCover){this.mobtCover.itxtSubscribe('click',$iTXT.core.Event.bind(this,$iTXT.ui_impetus.Mobt._onMobtClick));this.mobt.itxtSubscribe('click',$iTXT.core.Event.bind(this,$iTXT.ui_impetus.Mobt._onMobtClick));this.mobtCover.itxtSubscribe('mouseover',$iTXT.core.Event.bind(this,$iTXT.ui_impetus.Mobt._onHotdogIn));this.mobtCover.itxtSubscribe('mouseout',$iTXT.core.Event.bind(this,$iTXT.ui_impetus.Mobt._onHotdogOut));} return true;},legacyReveal:function(left,l_offset,t_offset){this.mobtCover=$iTXT.ui_impetus.Mobt._mobtCoverOn(this);this.preMobt();this.mobt.itxtSetStyle({left:(Math.floor(left)+l_offset)+"px"});this.mobt.firstChild.itxtSetStyle({top:t_offset+"px",marginTop:"-3px"});if(this.mobtCover){this.mobtCover.itxtSubscribe('click',$iTXT.core.Event.bind(this,$iTXT.ui_impetus.Mobt._onMobtClick));this.mobt.itxtSubscribe('click',$iTXT.core.Event.bind(this,$iTXT.ui_impetus.Mobt._onMobtClick));this.mobtCover.itxtSubscribe('mouseover',$iTXT.core.Event.bind(this,$iTXT.ui_impetus.Mobt._onHotdogIn));this.mobtCover.itxtSubscribe('mouseout',$iTXT.core.Event.bind(this,$iTXT.ui_impetus.Mobt._onHotdogOut));} return true;},closeMobt:function(data){window.clearTimeout(this.mobt_timeout);if(this.built&&this.mobt!==undefined&&$iTXT.ui_impetus.MobtWatcher.canClose(this.mobt.id)){this.rootElement.style.visibility='visible';this.mobt.firstChild.itxtSetStyle({MozTransitionDelay:"0ms",MozTransform:"rotateX(-90deg)",WebkitTransitionDelay:"0ms",WebkitTransform:"rotateX(-90deg)",transitionDelay:"0ms",transform:"rotateX(-90deg)"});try{document.getElementById("cover_"+this.ad.did).parentNode.removeChild(document.getElementById("cover_"+this.ad.did));}catch(e){} this.built=false;var that=this;setTimeout(function(){var dead_id=that.mobt.id;that.mobt.parentNode.removeChild(that.mobt);$iTXT.ui_impetus.MobtWatcher.del(dead_id);},300);$iTXT.fire("$iTXT:mobt:close",{hook:this,ttWasOpen:data&&data.ttWasOpen});} return true;},_onHookIn:function(e){var that=this,b=$iTXT.core.Builder;if(!this.built){this.initMobt();} var new_left=$iTXT.core.Util.getElementPosition(this.rootElement).left;var new_width=this.rootElement.itxtBounds().width;var off_setobj=this.rootElement;if(this.isWrapped()){for(var i in this.childSpans){var ins=$iTXT.core.Math.pointInside({l:this.childSpans[i].offsetLeft,t:this.childSpans[i].offsetTop,h:this.childSpans[i].offsetHeight,w:this.childSpans[i].offsetHeight},{x:e.clientX,y:e.clientY},50);if(ins){new_left=$iTXT.core.Util.getElementPosition(this.childSpans[i]).left;new_width=this.childSpans[i].itxtBounds().width;off_setobj=this.childSpans[i];}}} var w_offset=(off_setobj.itxtBounds().width-this.mobt.firstChild.itxtBounds().width)/2;var h_offset;if(!this.options.hookMobtModern){h_offset=-3;var nodes=this.mobt.firstChild.children,begin=0,end=100;for(var k=0,ln=nodes.length;k<ln;k++){if(nodes[k].className==="mobt_sprite_left"){} if(nodes[k].className==="mobt_sprite_right"){end=nodes[k].offsetLeft+nodes[k].offsetWidth;}} w_offset=(off_setobj.itxtBounds().width-(end-begin))/2;} if(off_setobj!==this.rootElement){h_offset=off_setobj.offsetTop-this.rootElement.offsetTop;var poses=$iTXT.core.Util.getElementPosition(off_setobj);if(poses.left-this.mobt.firstChild.itxtBounds().width<0){new_left=1;w_offset=2;}else if(document.body.offsetWidth>poses.left+new_width/2){new_left=document.body.offsetWidth;w_offset=-this.mobt.firstChild.itxtBounds().width;}} this._closeMobt=$iTXT.ui_impetus.Mobt._closeMobt;if(!this.options.hookMobtModern){this.mobt.itxtSetStyle({'height':'30px','width':($iTXT.data.Dom.getElementsByClassName("mobt_sprite_middle",this.mobt)[0].offsetWidth+28)+'px'});}else{this.mobt.style.width=(this.mobt.firstChild.offsetWidth+w_offset)+"px";} function reveal(){if(that.flipMobt(new_left,w_offset,h_offset)){$iTXT.fire("$iTXT:mobt:open",{hook:that});}} if(this.options.hookMobtOpenDelay){setTimeout(reveal,this.options.hookMobtOpenDelay);} else{reveal();} $iTXT.ui_impetus.MobtWatcher.hookIn(this.mobt.id);},_onHookOut:function(e){var th=this;setTimeout(function(){if(!$iTXT.ui_impetus.MobtWatcher.canFireTT(th.mobt.id)){$iTXT.core.$(document).itxtFire("$iTXT:mobt:ittc",e);th._scheduleClose();}},20);$iTXT.ui_impetus.MobtWatcher.hookOut(this.mobt.id);},_onMobtIn:function(e){window.clearTimeout(this.mobt_timeout);var css={},opts=this.options,def=$iTXT.ui_impetus.Mobt.defaults;css.color=opts.hookMobtColorHover||def.colorHover;this.mobt.firstChild.itxtAddClass('hover');this.mobt.firstChild.itxtSetStyle(css);$iTXT.fire("$iTXT:mobt:in",{hook:this});if(this.visited){setTimeout(this._launcher,60);} this.visited=true;$iTXT.ui_impetus.MobtWatcher.mobtIn(this.mobt.id);},_onMobtOut:function(e){$iTXT.fire("$iTXT:mobt:out",{hook:this,src:"mobt out"});var css={},opts=this.options,def=$iTXT.ui_impetus.Mobt.defaults;css.color=opts.hookMobtColor||def.color;this.mobt.firstChild.itxtRemoveClass('hover');this.mobt.firstChild.itxtSetStyle(css);$iTXT.ui_impetus.MobtWatcher.mobtOut(this.mobt.id);this._mouseOutFire(e);var self=this;setTimeout(function(){self.visited=false;},500);},_onHotdogIn:function(e){window.clearTimeout(this.mobt_timeout);$iTXT.ui_impetus.MobtWatcher.mobtIn(this.mobt.id);},_onHotdogOut:function(e){$iTXT.fire("$iTXT:mobt:out",{hook:this,src:"hotdog out"});var css={},opts=this.options,def=$iTXT.ui_impetus.Mobt.defaults;css.color=opts.hookMobtColor||def.color;this.mobt.firstChild.itxtRemoveClass('hover');this.mobt.firstChild.itxtSetStyle(css);$iTXT.ui_impetus.MobtWatcher.mobtOut(this.mobt.id);},_onMobtClick:function(e){var src=(e.target==this.hookIcon)?$iTXT.data.ClickSource.ICON:$iTXT.data.ClickSource.KEYWORD;$iTXT.fire("$iTXT:hook:click",{source:src,so:25,hookid:this.options.id,hook:this,advert:this.ad});return false;},_ttCloseMobt:function(e){if(this.mobt!==undefined&&e.data.did!==this.ad.did){this.closeMobt(e);}},_ttCancelled:function(e){if(this.id===e.data.data.hook.id){this._scheduleClose();}},_scheduleClose:function(e){window.clearTimeout(this.mobt_timeout);var th=this;this.mobt_timeout=setTimeout(function(){$iTXT.ui_impetus.MobtWatcher.hookOut(th.mobt.id);th.closeMobt(e);},this.options.hookMobtHideDelay);},_ttMouseOut:function(){if(this.mobt){$iTXT.ui_impetus.MobtWatcher.mobtOut(this.mobt.id);}},_closeMobt:function(e){var that=this;if(this.mobt&&this.mobt.id&&this.built&&this.ad.did===$iTXT.ui.tt.currentAdvert.did){setTimeout(function(){that.closeMobt({ttWasOpen:true,id:that.id,source:"_close"});},60);}}};$iTXT.ui_impetus.MobtWatcher={};(function(exports){var mobtQ={},current_id,length=0;var safe_set=function(id,prop,value){if(mobtQ[id]){mobtQ[id][prop]=value;}};var find_largest=function(){var cand,ts=0,length=0;for(var i in mobtQ){if(mobtQ[i].timestamp>ts){cand=mobtQ[i];ts=cand.timestamp;}} return cand;};var isCurrent=function(in_id){return(in_id===current_id);};var closeOthers=function(){var curr=find_largest();for(var i in mobtQ){if(mobtQ[i]){if(mobtQ[i].timestamp<curr.timestamp){if(!mobtQ[i].closing){mobtQ[i].close();}}}}};exports.add=function(mobtId,close,keyword){mobtQ[mobtId]={close:close,timestamp:(new Date().getTime()),kw:keyword||"something"};length++;current_id=mobtId;};exports.del=function(mobtId){delete mobtQ[mobtId];length--;};exports.hookIn=function(id){safe_set(id,"hookin",true);};exports.hookOut=function(id){safe_set(id,"hookin",false);};exports.mobtIn=function(id){safe_set(id,"mobtin",true);};exports.mobtOut=function(id){safe_set(id,"mobtin",false);};exports.canFireTT=function(id){return mobtQ[id].mobtin;};exports.canClose=function(id){if(mobtQ[id].closing){return true;} if(length>2){closeOthers();} if(!!id){if(isCurrent(id)&&length<=2){if(!mobtQ[id].hookin&&!mobtQ[id].mobtin){mobtQ[id].closing=true;return true;}} if(!isCurrent(id)){mobtQ[id].closing=true;return true;}} return false;};}).call(this,$iTXT.ui_impetus.MobtWatcher);};$iTXT.js.loader["$iTXT.ui_impetus.MobtManager"]=true;$iTXT=$iTXT||{};$iTXT.ui_impetus=$iTXT.ui_impetus||{};$iTXT.ui_impetus.MobtManager_Load=function(){$iTXT.ui_impetus.MobtManager={curMobt:null,infest:function(hook){var m=$iTXT.ui_impetus.Mobt,opts=hook.options,enabled=$iTXT.ui_impetus.MobtManager.isMobtEnabled(hook);if(!enabled||hook.initMobt==m.initMobt){return;} hook.addMobtOptions=m.addMobtOptions;hook.initMobt=m.initMobt;hook.preMobt=m.preMobt;hook.flipMobt=m.flipMobt;hook.closeMobt=m.closeMobt;hook.hookIn=m._onHookIn;hook._scheduleClose=m._scheduleClose;hook.addMobtOptions();if(!opts.hookMobtModern){var host=$iTXT.glob.params.get('tt.img.dir','http://images.intellitxt.com/ast/tt/09/');hook.flipMobt=m.legacyReveal;var i=new Image();i.src=host+"mobt/mobt_sprites.png";}},isMobtEnabled:function(hook){var paramValue,campaignEnabled,channelEnabled;var isMobile=$iTXT.core.Browser.isTargetedSmartphone($iTXT.glob.params.getBool("tt.force.mobile",false));var allowMobile=$iTXT.glob.params.getBool("ui.mobt.mobile",false);if(isMobile&&!allowMobile){return false;} if(hook.ad.getAdvertType()===0){return false;} if(hook.ad.params.getBool("lbox.bar",false)&&'classic'==($iTXT.glob.params.get('ui.set.progressbar',$iTXT.glob.params.get('ui.set','classic')).toLowerCase())){return false;} paramValue=$iTXT.glob.params.getBool("ui.mobt");if(false===paramValue){channelEnabled=0;} else if(true===paramValue){channelEnabled=1;} else{channelEnabled=-1;} paramValue=hook.ad.params.getBool("hk.mobt");if(true===paramValue){campaignEnabled=1;} else if(false===paramValue){campaignEnabled=0;} else{campaignEnabled=-1;} if(campaignEnabled==1&&channelEnabled!==0){return true;} if(campaignEnabled==-1&&channelEnabled==1){return true;} return false;},_setCurMobt:function(mobt){var that=$iTXT.ui_impetus.MobtManager;if(that.curMobt&&that.curMobt.ad.did!=mobt.ad.did){that.curMobt.closeMobt();that.curMobt=mobt;}else if(!that.curMobt){that.curMobt=mobt;}},_mobtOpen:function(e){var that=$iTXT.ui_impetus.MobtManager,curAd=$iTXT.ui.tt.currentAdvert;that._setCurMobt(e.data.hook);that.curMobt.timeOpen=$iTXT.core.Util.ts();$iTXT.data.al.logAV(that.curMobt.ad,$iTXT.data.AdViewValue.ADVIEW_MOBT_OPEN,0,{});},_mobtClose:function(e){var that=$iTXT.ui_impetus.MobtManager,curMobt=that.curMobt,curAd=$iTXT.ui.tt.currentAdvert,mtrData;if(curMobt&&curMobt.ad.did===e.data.hook.ad.did){curMobt.timeClose=$iTXT.core.Util.ts();mtrData={advert:curMobt.ad,mt:125,mv:e.data.ttWasOpen?'1':'0',mv2:curMobt.timeClose-curMobt.timeOpen};$iTXT.fire("$iTXT:data:log:monitor",mtrData);} that.curMobt=null;},_mobtIn:function(e){var that=$iTXT.ui_impetus.MobtManager;that._setCurMobt(e.data.hook);}};$iTXT.subscribe("$iTXT:mobt:open",$iTXT.ui_impetus.MobtManager._mobtOpen);$iTXT.subscribe("$iTXT:mobt:close",$iTXT.ui_impetus.MobtManager._mobtClose);$iTXT.subscribe("$iTXT:mobt:in",$iTXT.ui_impetus.MobtManager._mobtIn);$iTXT.subscribe("$iTXT:mobt:out",$iTXT.ui_impetus.MobtManager._mobtOut);$iTXT.subscribe("$iTXT:tt:lightbox:close",function(){var curMobt=$iTXT.ui_impetus.MobtManager.curMobt;if(curMobt){curMobt.closeMobt({ttWasOpen:true});}});};$iTXT.js.loader["$iTXT.ui_impetus.Tooltip"]=true;$iTXT.ui_impetus=$iTXT.ui_impetus||{};$iTXT.ui_impetus.Tooltip_Load=function(){$iTXT.ui_impetus.Tooltip=$iTXT.core.Class.create($iTXT.ui.ComponentBase,{options:null,currentHook:null,currentHookBB:null,hideTID:-1,openTID:-1,lastDID:-1,isOpen:false,fixedOpen:false,openTS:null,hdrDown:false,hdrDownX:0,hdrDownY:0,loading:false,isMouseOver:false,mouseOutTID:-1,mouseOverTS:null,defaultBgCol:"#f3f3f3",defaultHoverBgCol:"#f6f6f6",defaultImageDirectory:'http://images.intellitxt.com/ast/tt/09/',mouseOutLogged:false,resetSizeDuringExpando:true,type48:false,init:function(_options,$super) {var defOpts=$iTXT.core.Util.extend({id:"itxttt",ps:$iTXT.ui.TooltipPosition.AR,bgcol:"#ececec",hbgcol:'#f6f6f6',ftrbgcol:'#f3f3f3',tailbgcol:'#f3f3f3',minShowTime:0,tthd:1500,mintthd:0,openDelay:100,draggable:true,invisible:false,fadeShadow:true},_options);$iTXT.glob.dbParams.set('tt.img.dir',this.defaultImageDirectory,$iTXT.cnst.WEIGHTING_DEFAULT_DEFAULT);$iTXT.debug.info($iTXT.debug.Category.UI,"Creating Tooltip");this.zindex=9910000;$super(defOpts);this.rootElement.style.zIndex=this.zindex;var t=this;var evt=$iTXT.core.Event;this.rootElement.itxtBatchSubscribe([["mouseover",$iTXT.core.Event.bind(this,this._onMouseOver)],["mouseout",$iTXT.core.Event.bind(this,this._onMouseOut)],["mouseup",$iTXT.core.Event.bind(this,this._onMouseDownUp)],["mousedown",$iTXT.core.Event.bind(this,this._onMouseDownUp)],["contextmenu",$iTXT.core.Event.bind(this,this._onMouseDownUp)]],this.evtDspFuncs);$iTXT.core.$(document.body).itxtBatchSubscribe([["mouseover",$iTXT.core.Event.bind(this,this._bodyOver)],["mouseup",$iTXT.core.Event.bind(this,this._hdrUp)]],this.evtDspFuncs);$iTXT.core.$(document).itxtBatchSubscribe([["mousemove",evt.bind(this,this._onBodyMouseMove)],["$iTXT:tt:close",evt.bind(this,this.close)],["$iTXT:tt:expand",evt.bind(this,this._expand)],["$iTXT:hook:over",evt.bind(this,this._hookOver)],["$iTXT:hook:in",evt.bind(this,this._hookIn)],["$iTXT:mobt:in",evt.bind(this,this._mobtIn)],["$iTXT:hook:out",evt.bind(this,this._hookOut)],["$iTXT:hook:click",evt.bind(this,this._hookClick)],["$iTXT:mobt:ittc",evt.bind(this,this._clearLaunch)],["$iTXT:tt:hdr:mouse:down",evt.bind(this,this._hdrDown)],["$iTXT:tt:hdr:mouse:up",evt.bind(this,this._hdrUp)],["$iTXT:tt:open",evt.bind(this,this._decorateOnTTOpen)],["$iTXT:tt:content:loaded",evt.bind(this,this._resizeOnTTOpenFreeform)],["$iTXT:tt:close",evt.bind(this,this._resetDecorations)],["$iTXT:tt:resize",evt.bind(this,this._resizeTooltip)],["$iTXT:tt:resize:smooth",evt.bind(this,this._smoothResizeTooltip)],["$iTXT:tt:set:fixed:open",evt.bind(this,this._setFixedOpen)],["$iTXT:tt:over",evt.bind(this,this._ttOver)],["$iTXT:tt:out",evt.bind(this,this._ttOut)],["$iTXT:tt:content:change:ad",evt.bind(this,this._changeAdvert)],["$iTXT:tt:content:loaded",$iTXT.core.Event.bind(this,this._contentLoaded)],["$iTXT:tt:expand",evt.bind(this,this._resizeOnExpand)],["$iTXT:function:mvuExpand",evt.bind(this,this._mvuExpand)],["$iTXT:function:fExp",evt.bind(this,this._fExp)],["$iTXT:function:fClick",evt.bind(this,this._fClick)],["$iTXT:tt:iframe:out",evt.bind(this,this._iframeOut)],["$iTXT:tt:global:set:bgcol",$iTXT.core.Event.bind(this,this._setBGCol)],["$iTXT:tt:global:set:hvcol",$iTXT.core.Event.bind(this,this._setHVCol)]],this.evtDspFuncs);this.hide();},build:function() {$iTXT.debug.info($iTXT.debug.Category.UI,"Tooltip.build()");this.chrome=new $iTXT.ui.TooltipChrome({ps:this.options.ps,bgcol:this.options.bgcol,draggable:this.options.draggable});this.chrome.build(this.options.bgcol);this.addChild(this.chrome);this.content=new $iTXT.ui.TooltipContent({ps:this.options.ps,bgcol:this.options.bgcol});this.chrome.rootElement.appendChild(this.content.rootElement);},setPositionState:function(ps) {if(ps) {$iTXT.debug.info($iTXT.debug.Category.UI,"Setting Tooltip Position State: "+ps);this.ps=ps;if(this.shadow) this.shadow.setPositionState(ps);this.chrome.setPositionState(ps);}},setSize:function(w,h,resizeContent,$super) {$iTXT.debug.info($iTXT.debug.Category.UI,"Setting Tooltip Size (width: "+w+", height: "+h+")");var shadSize=(this.shadow)?this.shadow.getShadowSize():0;$iTXT.debug.debug($iTXT.debug.Category.UI,"shadow size:"+shadSize+"px");this.chrome.setPosition(shadSize,shadSize);if(resizeContent) {$iTXT.debug.debug($iTXT.debug.Category.UI,"resizing content");this.content.resize(null,null,false);} var contentW=this.content.getWidth();var contentH=this.content.getHeight();var contentOverlap=this.content.heightOverlap;$iTXT.debug.debug($iTXT.debug.Category.UI,"content w/h: "+contentW+"px/"+contentH+"px");$iTXT.debug.debug($iTXT.debug.Category.UI,"overlap: "+contentOverlap);this.chrome.setSize(contentW,contentH-contentOverlap,contentOverlap);if(this.shadow) this.shadow.setSize(this.chrome.getWidth()+10,this.chrome.getHeight());var contentOff=this.chrome.getContentOffset();this.content.setPosition(contentOff[0],contentOff[1]);var thisHeight=Math.max(((this.shadow)?this.shadow.getHeight():0),this.chrome.getOverlappedHeight());$super(contentW,thisHeight);},open:function(l,t,state) {var useShadow;useShadow=$iTXT.ui.tt.currentAdvert.params.getBool('tt.shadow',false);if(useShadow&&!this.shadow){this.shadow=new $iTXT.ui.TooltipShadow({ps:this.options.ps,bgcol:this.options.bgcol});this.addChild(this.shadow);} $iTXT.debug.info($iTXT.debug.Category.UI,"Start Tooltip Open l: "+l+"px, t: "+t+"px, state: "+state);$iTXT.core.$(document).itxtFire("$iTXT:tt:before:open");this.hide();this.content.hide();if(useShadow&&this.shadow) this.shadow.hide();this.chrome.hide();this.setPositionState(state);this.rootElement.itxtRemoveClass("minimise");this.setPosition(l,t);this.setSize(null,null,false);if(!this.options.invisible) {this.content.show();this.chrome.show();if(!this.options.fadeShadow) {if(useShadow&&this.shadow) this.shadow.show();} $iTXT.debug.info($iTXT.debug.Category.UI,"<b>Show Tooltip</b>");this.show();} else {$iTXT.debug.info($iTXT.debug.Category.UI,"<b>Invisible Tooltip Shown</b>");} $iTXT.core.$(document).itxtFire("$iTXT:tt:after:open");if(!this.options.invisible) {if(this.options.fadeShadow) {if(useShadow&&this.shadow) this.shadow.fadeIn();} this.isOpen=true;} this.openTS=(new Date()).getTime();},close:function(e) {var opts=e.data||{};$iTXT.core.$(document).itxtFire("$iTXT:tt:before:close");this.content.beforeClose();if(this.currentHookBB!==null&&opts.closeSource!=$iTXT.data.TTCloseSource.OVERNEWHOOK) {var ttOff=this.rootElement.itxtTotalOffset();var dX=(this.currentHookBB.left-ttOff.left)+(this.currentHookBB.width/2);var dY=this.currentHookBB.top-ttOff.top;this.rootElement.itxtAddClass("minimise");this.content.hide();if(this.shadow) this.shadow.hide();this.chrome.hide();var t=this;var combOpts={start:true,duration:150,effects:[new $iTXT.fx.Move({target:this.rootElement,dX:dX,dY:dY}),new $iTXT.fx.Size({target:this.rootElement,width:5,height:5})],afterFinish:function() {t.hideTooltip();$iTXT.core.$(document).itxtFire("$iTXT:tt:after:minimise");}};$iTXT.core.$(document).itxtFire("$iTXT:tt:before:minimise");$iTXT.debug.debug($iTXT.debug.Category.UI,"Starting Tooltip Minimize Effect (dX: "+dX+", dY: "+dY+")");new $iTXT.fx.Combination(combOpts);} else {this.hideTooltip();}},hideTooltip:function() {$iTXT.debug.info($iTXT.debug.Category.UI,"Hiding Tooltip");if(this.hideTID!=-1&&(this.currentAdvert.did!==this.lastDID||!this.currentAdvert)){window.clearTimeout(this.hideTID);this.hideTID=-1;this.lastDID=this.currentAdvert.did;} this.hide();this.rootElement.itxtSetStyle({left:"-1000px",top:"-1000px",width:"300px",height:"300px"});this.isOpen=false;this.fixedOpen=false;this.openTS=null;this.isMouseOver=false;if(this.content.advert) {this.content.advert.template.isMouseOver=false;} if(this.currentHook!==null) {this.currentHook.setState(false);this.currentHook=null;this.currentHookBB=null;} $iTXT.core.$(document).itxtFire("$iTXT:tt:after:close");this.content.afterClose();},queueHide:function(t) {if(this.isMouseOver) {$iTXT.debug.info($iTXT.debug.Category.UI,"Queue Hide Ignored: Mouse is still over!");return;} if(this.currentAdvert&&this.currentAdvert.params&&this.currentAdvert.params.get("tt.disable.hide")) {$iTXT.debug.info($iTXT.debug.Category.UI,"Queue Hide Failed: tt.disable.hide Parameter Set");return;} if(this.hideTID!=-1) {window.clearTimeout(this.hideTID);this.hideTID=-1;} if(!this.fixedOpen) {$iTXT.core.$(document).itxtFire("$iTXT:tt:queue:hide");var toAdjustment=0;if(this.options.mintthd>0) {var timeOpenFor=this.openTS?(new Date()).getTime()-this.openTS:0;var timeLeft=this.options.mintthd-timeOpenFor;if(timeLeft>0) {toAdjustment=timeLeft;}} var hideTO=parseInt(this.options.tthd,10)+toAdjustment;if(this.openTS!==null) {var tSO=((new Date()).getTime()-this.openTS);hideTO+=Math.max(this.options.minShowTime-tSO,0);} $iTXT.debug.debug($iTXT.debug.Category.UI,"Queing Tooltip Hide: "+(t||hideTO)+"ms (tthd: "+this.options.tthd+"ms, mintthd: "+this.options.mintthd+"ms)");this.hideTID=window.setTimeout(function(){$iTXT.core.$(document).itxtFire("$iTXT:tt:close",{closeSource:$iTXT.data.TTCloseSource.MOUSEOUT});},(t||hideTO));}},_hookIn:function(e) {if(this.hideTID!=-1&&e.data&&e.data.hook&&e.data.hook==this.currentHook) {$iTXT.debug.debug($iTXT.debug.Category.UI,"Clear Tooltip Hide Timeout (Hook In)");window.clearTimeout(this.hideTID);this.hideTID=-1;}},_mobtIn:function(e) {if(this.hideTID!=-1&&e.data&&e.data.hook&&e.data.hook==this.currentHook) {$iTXT.debug.debug($iTXT.debug.Category.UI,"Clear Tooltip Hide Timeout (Hook In)");window.clearTimeout(this.hideTID);this.hideTID=-1;}},_hookOver:function(e) {if(this.hideTID!=-1&&e.data&&e.data.hook&&e.data.hook==this.currentHook) {$iTXT.debug.debug($iTXT.debug.Category.UI,"Clear Tooltip Hide Timeout (Hook Over)");window.clearTimeout(this.hideTID);this.hideTID=-1;} var hookSnapTo=$iTXT.glob.params.get('hk.snapmode');if(hookSnapTo==$iTXT.ui.SnapMode.Mouse) {e.data.bounds.left=e.data.hook.mouseOverPos.x;e.data.bounds.top=e.data.hook.mouseOverPos.y;} if(e.data&&e.data.hook&&e.data.hook!=this.currentHook) {var t=this;var adParams=e.data.hook.ad.params;var tooltipDelay=adParams.getInt("tt.open.delay",adParams.getInt("ttd",100));$iTXT.debug.debug($iTXT.debug.Category.UI,"Getting tooltip open delay (tt.open.delay/ttd): "+tooltipDelay);if(tooltipDelay>1000) {$iTXT.debug.debug($iTXT.debug.Category.UI,"Tooltip open delay was >1000, reducing to 750");tooltipDelay=750;} this.options.mintthd=e.data.hook.ad.params.get("mintthd",0);var launcher=function(){t._showOnHook(e.data.hook,e.data.bounds);};if(e&&e.data&&e.data.hook){e.data.hook.saveTTLaunchFunction(launcher);} this.openTID=window.setTimeout(launcher,tooltipDelay);}},_clearLaunch:function(){window.clearTimeout(this.openTID);},_hookOut:function(e) {if(this.openTID!=-1&&(e.data&&e.data.hook&&e.data.hook!=this.currentHook)) {var adParams=e.data.hook.ad.params;var ittc=adParams.getBool("tt.stop.pending.open",adParams.getBool("ittc",false));if(ittc) {$iTXT.debug.info($iTXT.debug.Category.UI,"<b>Mouse out of hook, pending tooltip open cancelled as tt.stop.pending.open/ittc=1<b/>");window.clearTimeout(this.openTID);$iTXT.core.$(document).itxtFire("$iTXT:tt:ittc",e);} else {$iTXT.debug.info($iTXT.debug.Category.UI,"<b>Mouse out of hook, pending tooltip open will continue as tt.stop.pending.open/ittc=0</b>");}} if(e.data&&e.data.hook&&e.data.hook==this.currentHook&&!this.isMouseOver) {this.queueHide();} else if(this.openTID!=-1) {this.queueHide();}},_hookClick:function(e) {this.hideTail();this.fixedOpen=true;},_showOnHook:function(hk,bb) {try {if(this.isOpen) {$iTXT.debug.info($iTXT.debug.Category.UI,"Close Tooltip (Show On Another Hook)");$iTXT.core.$(document).itxtFire("$iTXT:tt:close",{closeSource:$iTXT.data.TTCloseSource.OVERNEWHOOK,tso:this.getTimeSinceOpen(),did:this.currentAdvert.did});} $iTXT.debug.info($iTXT.debug.Category.UI,"Show Tooltip On Hook: "+hk.options.value+" (id: "+hk.id+")");this.showTail();this.currentHook=hk;this.currentAdvert=hk.ad;this.currentHookBB=bb;this.currentHook.setState(true);if(undefined!==hk.ad) {this.setAdvert(hk.ad);} this.show();this.content.show();if(this.shadow) this.shadow.show();this.chrome.show();this.setSize(null,null,true);this.hide();this.content.hide();if(this.shadow) this.shadow.hide();this.chrome.hide();var placeOpts={bb:bb,tt:$iTXT.ui.tt};this.content.beforeOpen();if(this.options.invisible) {this.onTooltipOpen({left:-1000,top:-1000,state:$iTXT.ui.TooltipPosition.AR});} else {if($iTXT.core.Util.parseBool($iTXT.glob.dbParams.get("tt.placer.extended",false),false)){this.onTooltipOpen($iTXT.ui.Aura2TooltipPlacer.place(placeOpts));}else{this.onTooltipOpen($iTXT.ui.TooltipPlacer.place(placeOpts));}} this.content.afterOpen(this.chrome);$iTXT.core.$(document).itxtFire("$iTXT:tt:open",{advert:hk.ad});} catch(e) {$iTXT.debug.error($iTXT.debug.Category.GENERAL,e);throw(e);}},openWithAdvert:function(advert,leftPos,topPos,posState) {this.showTail();this.currentAdvert=advert;this.currentHook=null;this.currentHookBB=null;this.setAdvert(advert);this.show();this.content.show();if(this.shadow) this.shadow.show();this.chrome.show();this.setSize(null,null,true);this.hide();this.content.hide();if(this.shadow) this.shadow.hide();this.chrome.hide();this.content.beforeOpen();this.onTooltipOpen({left:leftPos,top:topPos,state:posState});this.content.afterOpen();$iTXT.core.$(document).itxtFire("$iTXT:tt:open",{advert:advert});},_onMouseOver:function(e) {$iTXT.debug.debug($iTXT.debug.Category.UI,"tooltip._onMouseOver "+e.target.tagName+", "+e.target.id);this.mouseOutLogged=false;if(this.mouseOutTID!=-1) {window.clearTimeout(this.mouseOutTID);} if((e.target!=this.rootElement)&&(e.target!=this.chrome.rootElement)) {if(this.mouseOutTID!=-1) {window.clearTimeout(this.mouseOutTID);this.mouseOutTID=-1;} if(!this.isMouseOver) {this.isMouseOver=true;if(this.content.advert) {this.content.advert.template.isMouseOver=true;} this.tooltipOver();this.mouseOverTS=(new Date()).getTime();$iTXT.core.$(document).itxtFire("$iTXT:tt:mouse:over",e);} if(this.hideTID!=-1) {$iTXT.debug.debug($iTXT.debug.Category.UI,"Clear Tooltip Hide Timeout (Tooltip Over)");window.clearTimeout(this.hideTID);this.hideTID=-1;}} e.stop();},_ttOver:function() {this.isMouseOver=true;if(this.content.advert) {this.content.advert.template.isMouseOver=true;} if(this.mouseOutTID!=-1) {window.clearTimeout(this.mouseOutTID);} if(this.hideTID!=-1) {$iTXT.debug.debug($iTXT.debug.Category.UI,"Clear Tooltip Hide Timeout (Tooltip Over Component)");window.clearTimeout(this.hideTID);this.hideTID=-1;}},_ttOut:function() {if(!this.mouseOutLogged){$iTXT.debug.debug($iTXT.debug.Category.UI,"Tooltip Out (Component)");this.mouseOutLogged=true;} this._onMouseOut();},_onMouseOut:function(e) {var t=this;this.mouseOutTID=window.setTimeout(function(){t._ttMouseOut(e);},50);},_onMouseDownUp:function(e) {var rc=false;if(e.which)rc=(e.which==3);else if(e.button)rc=(e.button==2);if(rc) {return false;} return true;},_ttMouseOut:function(e) {if(this.isMouseOver) {this.isMouseOver=false;if(this.content.advert) {this.content.advert.template.isMouseOver=false;} this.tooltipOut();var len=(new Date()).getTime()-this.mouseOverTS;$iTXT.core.$(document).itxtFire("$iTXT:tt:mouse:out",{len:len});this.queueHide();}},showTail:function() {if(this.shadow) this.shadow.showTail();this.chrome.showTail();},hideTail:function() {if(this.shadow) this.shadow.hideTail();this.chrome.hideTail();},setLoading:function(l) {},_onBodyMouseMove:function(e) {if(this.hdrDown&&this.options.draggable) {this.hideTail();this.fixedOpen=true;this.setPosition(e.clientX-this.hdrDownX,e.clientY-this.hdrDownY);}},_setFixedOpen:function() {this.fixedOpen=true;},_hdrDown:function(e) {this.hdrDown=true;var thisOff=this.rootElement.itxtTotalOffset();this.hdrDownX=e.data.clientX-thisOff.left;this.hdrDownY=e.data.clientY-thisOff.top;},_hdrUp:function() {this.hdrDown=false;},_expand:function(e) {var opts=e.data||{};if(opts.disableClose) {this._setFixedOpen();} if(opts.hideTail) {this.hideTail();} var hOffset=0;var oHOffset=this.content.heightOverlap;if(opts.hOffset) {hOffset=opts.hOffset;} var oW=(undefined!==opts.oW)?opts.oW:this.content.getWidth();var oH=(undefined!==opts.oH)?opts.oH:this.content.getHeight();var eW=(undefined!==opts.eW)?opts.eW:this.content.getExpandedWidth();var eH=(undefined!==opts.eH)?opts.eH:this.content.getExpandedHeight();var wD=eW-oW;var hD=eH-oH;if(undefined!==opts.dX) {wD=opts.dX;} if(undefined!==opts.dY) {hD=opts.dY;} if(0===wD&&0===hD) {if(opts.afterFinish) {opts.afterFinish.apply(t);} return;} var dX=0;var dY=0;var ttps=$iTXT.ui.TooltipPosition;if(this.ps==ttps.AR) {dY=-hD+hOffset;} else if(this.ps==ttps.AL) {dY=-hD+hOffset;dX=-wD;} else if(this.ps==ttps.BR) {} else if(this.ps==ttps.BL) {dX=-wD;} var duration=200;if($iTXT.core.Browser.performance<60) {duration=0;} $iTXT.debug.info($iTXT.debug.Category.UI,"<b style='color:blue;'>Expand Tooltip</b>");$iTXT.debug.debug($iTXT.debug.Category.UI,"Start: "+oW+"px/"+oH+"px");$iTXT.debug.debug($iTXT.debug.Category.UI,"Change: "+wD+"px/"+hD+"px");$iTXT.debug.debug($iTXT.debug.Category.UI,"Duration: "+duration+"ms");var t=this;var moveOpts={start:true,duration:duration,target:this.rootElement,dX:dX,dY:dY,afterUpdate:function(p) {var nW=Math.round(oW+(wD*p));var nH=Math.round(oH+(hD*p));var hO=Math.round(oHOffset+(hOffset*p));if(t.resetSizeDuringExpando||t.expandableFlash||t.chrome.expandable){t._setContentSize(nW,nH,hO);} if(opts.afterUpdate) {opts.afterUpdate.apply(t,[p]);}},afterFinish:function() {t.content.afterExpand(t.chrome);if(opts.afterFinish) {opts.afterFinish.apply(t);}}};new $iTXT.fx.Move(moveOpts);},_decorateOnTTOpen:function(data){var ad=data.data.advert;var adtype=ad.getAdvertType();if(adtype===5||adtype===79||adtype===122||adtype===160){this.chrome.addPaddingAndBorder(data.data.advert.template.width,data.data.advert.template.height);}else{if(adtype!==155&&adtype!==39&&adtype!==58){this.chrome.addDoubleBorder();}} var isLightBox=ad.params.getBool("lbox",false);var isProgressBar=ad.params.getBool("lbox.bar");this.chrome.removeLeftMargin();if(adtype===38||adtype===79||adtype===54||adtype===60||(isLightBox&&!isProgressBar)){this.chrome.addLeftMargin();} if(adtype===54||adtype===48){this.chrome.expandable=true;} if(adtype===48){this.type48=true;} if((adtype===153||adtype===155||(isLightBox&&isProgressBar))&&this.chrome.suppressWings){this.chrome.suppressWings();} if(isProgressBar){this.content.rootElement.itxtSetStyle({'border':'0px none transparent'});}},_resetDecorations:function(){this.chrome.resetPaddingAndBorder();},_resizeOnTTOpenFreeform:function(){var t=this;if(t.currentAdvert.getAdvertType()===122){setTimeout(function(){t.chrome.addPaddingAndBorder(document.getElementById("itxtcontent").offsetWidth,document.getElementById("itxtcontent").offsetHeight);},400);setTimeout(function(){t.chrome.addPaddingAndBorder(document.getElementById("itxtcontent").offsetWidth,document.getElementById("itxtcontent").offsetHeight);},700);}},_resizeOnExpand:function(data){this.resetSizeDuringExpando=false;var hihi=data.data.cH||data.data.eH;if(this.chrome.expandable){this.chrome.addPadding(parseInt(data.data.eW,10),hihi-data.data.hOffset);}else{this.chrome.addPaddingAndBorder(parseInt(data.data.eW,10),hihi-data.data.hOffset);}},_setContentSize:function(w,h,hO) {this.content.setContentSize(w,h,hO);if(this.type48){this.chrome.setSize(w+10,h-23);this.chrome.addLeftMargin();} if(!this.chrome.expandable){this.setSize(null,null,false);}},setAdvert:function(ad) {var adopts=ad.params;var nott=adopts.get("nott",false);if(nott) {adopts.set("scmh",1,$iTXT.cnst.WEIGHTING_DEFAULT_CAMPAIGN);} this.options.invisible=nott;var tmpl=ad.getTemplate();var tmplopts=(null!==tmpl)?(tmpl.options||{}):{};var adBgCol=adopts.parse(adopts.get("tt.bg.col","#f0f0f0"));adBgCol=(adBgCol.length>0)?adBgCol:"#f0f0f0";this.options.bgcol=$iTXT.core.Util.validHexColor(tmplopts.ttbgcol||adBgCol);$iTXT.core.$(document).itxtFire("$iTXT:tt:impetus:bgchange",{col:this.options.bgcol});var adHvBgColor=adopts.parse(adopts.get("tt.bg.h.col",adBgCol));adHvBgColor=(adHvBgColor.length>0)?adHvBgColor:"#f0f0f0";this.options.hbgcol=$iTXT.core.Util.validHexColor(tmplopts.ttbghcol||adHvBgColor);this.options.tthd=adopts.getInt("tthd",this.defaultOptions.tthd);this.chrome.setAdvert(ad);if(this.options.invisible) {this.content.clearContent();} else {this.content.setAdvert(ad);} $iTXT.core.$(document).itxtFire("$iTXT:tt:ad:set",{did:ad.did});},onTooltipOpen:function(opts) {if(undefined===opts.left||undefined===opts.top||!opts.state) return;this.options.ps=opts.state;$iTXT.ui.tt.open(opts.left,opts.top,opts.state);},_resizeTooltip:function() {this.setSize(null,null,true);},_smoothResizeTooltip:function(e) {var dX=0,dY=0,sW=this.content.getWidth(),sH=this.content.getHeight();var newSize=this.content.tryResize(null,null);$iTXT.debug.info($iTXT.debug.Category.UI,"<b style='color:red;'>Smooth Resize Tooltip</b>");$iTXT.debug.debug($iTXT.debug.Category.UI,"Initial Start: "+sW+"px/"+sH+"px");if(isNaN(sW)) {sW=newSize[0];$iTXT.debug.debug($iTXT.debug.Category.UI,"Invalid start width, setting to: "+sW+"px");} if(isNaN(sH)) {sH=newSize[1];$iTXT.debug.debug($iTXT.debug.Category.UI,"Invalid start height, setting to: "+sH+"px");} dX=newSize[0]-sW;dY=newSize[1]-sH;$iTXT.debug.debug($iTXT.debug.Category.UI,"Finish: "+newSize[0]+"px/"+newSize[1]+"px");$iTXT.debug.debug($iTXT.debug.Category.UI,"Change: "+dX+"px/"+dY+"px");var expe={data:{dX:dX,dY:dY,oW:sW,oH:sH,afterFinish:function() {if(e&&e.data&&'function'==typeof e.data) {window.setTimeout(function(){e.data();},150);} $iTXT.core.$(document).itxtFire("$iTXT:tt:ready");}}};this._expand(expe);},_iframeOut:function() {this.mouseOutTID=window.setTimeout($iTXT.core.Event.bind(this,this._ttMouseOut),20);},getTimeSinceOpen:function() {if(this.isOpen) {return(new Date()).getTime()-this.openTS;} return null;},_changeAdvert:function(e) {if(e.data) {this.currentAdvert=e.data;}},tooltipOver:function() {this.chrome.tooltipOver();},tooltipOut:function() {this.chrome.tooltipOver();},_mvuExpand:function(e) {var opts=e.data||{};$iTXT.debug.info($iTXT.debug.Category.UI,"mvuExpand called: "+$iTXT.core.Util.serialiseJSON(opts));if(opts.rt==1) {this._expand({data:{eW:opts.w,eH:opts.h}});} else if(opts.rt===0) {this._expand({data:{eW:this.content.getTemplateDefaultWidth(),eH:this.content.getTemplateDefaultHeight()}});}},_fExp:function(e) {$iTXT.debug.info($iTXT.debug.Category.UI,"fExp called");this._expand({});},_fClick:function(e) {$iTXT.debug.info($iTXT.debug.Category.UI,"fClick called");this.hideTooltip();},_setBGCol:function(e) {this.options.bgcol=$iTXT.core.Util.validHexColor(e.data);},_setHVCol:function(e) {this.options.hbgcol=$iTXT.core.Util.validHexColor(e.data);},_bodyOver:function(e) {this._ttOut(e);},_contentLoaded:function(e) {this.resetSizeDuringExpando=true;var opts=e.data||{};var loadTimeout=opts.loadTimeout||0;var t=this;window.setTimeout(function(){t._smoothResizeTooltip();},loadTimeout);}});};$iTXT.js.loader["$iTXT.ui_impetus.TooltipChrome"]=true;$iTXT.ui_impetus=$iTXT.ui_impetus||{};$iTXT.ui_impetus.TooltipChrome_Load=function(){$iTXT.ui_impetus.TooltipChrome=$iTXT.core.Class.create($iTXT.ui.ComponentBase,{options:null,w:0,h:0,overlappedHeight:0,allowCustomHeader:true,init:function(_options,$super) {var defOpts=$iTXT.core.Util.extend({id:"itxtchrome",ps:$iTXT.ui.TooltipPosition.AR},_options);this.expandable=false;$super(defOpts);},build:function(bg) {var bgcol=bg||"#ffffff";this.slideOut=new $iTXT.ui.TooltipSlideOut({});this.contentBG=$iTXT.core.Builder.make("DIV",{style:"background-color:"+bgcol,id:"itxtcontentbg"});this.contentBG.appendChild($iTXT.core.Builder.make("div",{id:"itxt12_left_edge",className:"itxt12_left_edge"},[]));this.contentBG.appendChild($iTXT.core.Builder.make("div",{id:"itxt12_right_edge",className:"itxt12_right_edge"},[]));this.contentBG.appendChild($iTXT.core.Builder.make("div",{id:"itxt_bg_inside",className:"itxt_bg_inside"},[]));this.rootElement.appendChild(this.contentBG);this.defaultHeader=this.header=new $iTXT.ui.TooltipHeader({ps:this.options.ps,bgcol:this.options.bgcol,draggable:this.options.draggable});this.header.build();this.defaultFooter=this.footer=new $iTXT.ui.TooltipFooter({ps:this.options.ps,bgcol:this.options.bgcol});this.footer.build();this.defaultTail=this.tail=new $iTXT.ui.TooltipTail({ps:this.options.ps,bgcol:this.options.bgcol});this.addChildren([this.slideOut,this.header,this.footer,this.tail]);$iTXT.subscribe("$iTXT:tt:impetus:bgchange",function(s){document.getElementById("itxtcontentbg").style.backgroundColor=s.data.col;});},setPositionState:function(ps) {this.options.ps=ps;if(this.tail) this.tail.setPositionState(ps);this.resize(this.w,this.h);},_sset:function(el,prop,styl){try{document.getElementById(el).style[prop]=styl;}catch(e){}},addPaddingAndBorder:function(w,h){this.addBorder();this.addPadding(w,h);},addPadding:function(w,h){this._sset('itxtcontent',"margin-left","4px");this.setSize(w+10,h,0);},addDoubleBorder:function(){this._sset("itxt_underliner","display","block");},addBorder:function(){this._sset("itxtcontent","border","1px solid #c1c1c1");},resetPaddingAndBorder:function(){this._sset("itxt_underliner","display","none");this._sset("itxtcontent","border","none");this._sset("itxtcontent","margin-left","0");this._sset("itxt12_left_edge","display","block");this._sset("itxt12_right_edge","display","block");},addLeftMargin:function(){document.getElementById("itxtcontent").itxtAddClass("leftshift");},removeLeftMargin:function(){document.getElementById("itxtcontent").itxtRemoveClass("leftshift");},suppressWings:function(){document.getElementById("itxt12_left_edge").style.display="none";document.getElementById("itxt12_right_edge").style.display="none";},setSize:function(w,h,overlap) {var tailLeft;overlap=overlap||0;var ttps=$iTXT.ui.TooltipPosition;this.width=w;var headerAndContentHeight=h+this.getHeaderHeight();this.height=headerAndContentHeight+ this.getFooterHeight()+ this.getTailHeight();this.overlappedHeight=Math.max(headerAndContentHeight+overlap,this.height);this.rootElement.itxtSetStyle({width:this.width+"px",height:this.overlappedHeight+"px"});this.contentBG.itxtSetStyle({width:this.width+"px",height:h+"px"});if((ttps.AR==this.options.ps)||(ttps.AL==this.options.ps)) {if(this.header) {this.header.setPosition(0,0);this.header.setSize(this.width,this.height);} if(this.footer) {this.footer.setPosition(0,h+this.getHeaderHeight());this.footer.setSize(this.width,this.height);} if(this.tail) {tailLeft=(ttps.AR==this.options.ps)?50:(this.width-50-this.getTailWidth());this.tail.setPosition(tailLeft,h+this.getHeaderHeight()+this.getFooterHeight());} if(this.contentBG) this.contentBG.itxtSetStyle({top:this.getHeaderHeight()+"px"});} else {if(this.header) {this.header.setPosition(0,this.getTailHeight());this.header.setSize(this.width,this.height);} if(this.footer) {this.footer.setPosition(0,h+this.getHeaderHeight()+this.getTailHeight());this.footer.setSize(this.width,this.height);} if(this.tail) {tailLeft=(ttps.BR==this.options.ps)?50:(this.width-50-this.getTailWidth());this.tail.setPosition(tailLeft,0);} if(this.contentBG) this.contentBG.itxtSetStyle({top:(this.getHeaderHeight()+this.getTailHeight())+"px"});} var ttsoH=h+this.getHeaderHeight()+this.getFooterHeight();var ttsoOffH=0;if((ttps.BR==this.options.ps)||(ttps.BL==this.options.ps)) {ttsoOffH=this.getTailHeight();} if(this.slideOut) {this.slideOut.setSize(this.width,ttsoH);this.slideOut.setOffset(0,ttsoOffH);}},getOverlappedHeight:function() {return this.overlappedHeight;},getContentOffset:function() {var ttps=$iTXT.ui.TooltipPosition;var h=this.getHeaderHeight();if((ttps.BR==this.options.ps)||(ttps.BL==this.options.ps)) {h+=this.getTailHeight();} return[0,h];},showTail:function() {if(this.tail) this.tail.show();},hideTail:function() {if(this.tail) this.tail.hide();},getTTHeight:function() {var ttps=$iTXT.ui.TooltipPosition;return((ttps.AR==this.options.ps)||(ttps.AL==this.options.ps))?0:this.getTailHeight();},setAdvert:function(ad,$super) {var tmpl=ad.getTemplate();if(this.allowCustomHeader) {if(this.footer) {if(tmpl.options.customFooter) {if(this.footer) {this.removeChild(this.footer);this.footer.dispose();} this.footer=new tmpl.options.customFooter({ps:this.options.ps,bgcol:this.options.bgcol});if(this.footer.build) {this.footer.build();} this.addChild(this.footer);this.defaultFooter.hide();} else if(this.defaultFooter!=this.footer) {if(this.footer) {this.removeChild(this.footer);this.footer.dispose();} this.footer=this.defaultFooter;this.addChild(this.defaultFooter);this.footer.show();}} if(this.header) {if(tmpl.options.customHeader) {if(this.header) {this.removeChild(this.header);this.header.dispose();} this.header=new tmpl.options.customHeader({ps:this.options.ps,bgcol:this.options.bgcol,draggable:this.options.draggable});if(this.header.build) {this.header.build();} this.addChild(this.header);this.defaultHeader.hide();} else if(this.defaultHeader!=this.header) {if(this.header) {this.removeChild(this.header);this.header.dispose();} this.header=this.defaultHeader;this.addChild(this.defaultHeader);this.header.show();}} if(this.tail) {if(tmpl.options.customTail) {if(this.tail) {this.removeChild(this.tail);this.tail.dispose();} this.tail=new tmpl.options.customTail({ps:this.options.ps,bgcol:this.options.bgcol,draggable:this.options.draggable});if(this.tail.build) {this.tail.build();} this.addChild(this.tail);this.defaultTail.hide();} else if(this.defaultTail!=this.tail) {if(this.tail) {this.removeChild(this.tail);this.tail.dispose();} this.tail=this.defaultTail;this.addChild(this.defaultTail);this.tail.show();}}} if(this.header) this.header.setAdvert(ad);if(this.footer) this.footer.setAdvert(ad);if(this.tail) this.tail.setAdvert(ad);if(this.slideOut) this.slideOut.setAdvert(ad);$super(ad);},tooltipOver:function() {if(this.header) this.header.tooltipOver();if(this.footer) this.footer.tooltipOver();if(this.tail) this.tail.tooltipOver();},tooltipOut:function() {if(this.header) this.header.tooltipOut();if(this.footer) this.footer.tooltipOut();if(this.tail) this.tail.tooltipOut();},getTailWidth:function() {return(this.tail)?this.tail.getWidth():0;},getTailHeight:function() {return(this.tail)?this.tail.getHeight():0;},getFooterWidth:function() {return(this.footer)?this.footer.getWidth():0;},getFooterHeight:function() {return(this.footer)?this.footer.getHeight():0;},getHeaderWidth:function() {return(this.header)?this.header.getWidth():0;},getHeaderHeight:function() {return(this.header)?this.header.getHeight():0;},changeBgColor:function(col){document.getElementById('itxtcontentbg').style.backgroundColor=col;}});};$iTXT.js.loader["$iTXT.ui_impetus.TooltipContent"]=true;$iTXT.ui_impetus=$iTXT.ui_impetus||{};$iTXT.ui_impetus.TooltipContent_Load=function(){$iTXT.ui_impetus.TooltipContent=$iTXT.core.Class.create($iTXT.ui.ComponentBase,{options:null,template:null,loading:false,ccTS:null,advert:null,heightOverlap:0,drawers:null,init:function(_options,$super) {this.componentParams=$iTXT.core.Util.extend({'tt.loading.img.name':'loading.gif','tt.loading.img':'${tt.img.dir}${tt.loading.img.name}','tt.loading.img.width':'32','tt.loading.img.height':'32'},this.componentParams);var defOpts=$iTXT.core.Util.extend({id:"itxtcontent",className:"itxt12content",loadingImage:"${tt.loading.img}",loadingImageWidth:"${tt.loading.img.width}",loadingImageHeight:"${tt.loading.img.height}"},_options);$super(defOpts);var o=this.options;$iTXT.core.Util.cacheImages([o.loadingImage]);this.width=300;this.height=100;this.loadingImg=$iTXT.core.Builder.make("IMG",{src:o.loadingImage,width:o.loadingImageWidth,height:o.loadingImageHeight,id:this.options.id+"LdgImg",style:"position: absolute; left: 50%; top: 50%;"});this.loadingDiv=$iTXT.core.Builder.make("DIV",{id:this.options.id+"Ldg",style:"position: absolute; display: none;"},[this.loadingImg]);this.rootElement.appendChild(this.loadingDiv);this.resize();this.rootElement.itxtBatchSubscribe([["mouseover",function(e){$iTXT.core.$(document).itxtFire("$iTXT:tt:cnt:mouse:over",e);}],["mouseout",function(e){$iTXT.core.$(document).itxtFire("$iTXT:tt:cnt:mouse:out",e);}],["mouseup",function(e){$iTXT.core.$(document).itxtFire("$iTXT:tt:cnt:mouse:up",e);}]],this.evtDspFuncs);$iTXT.core.$(document).itxtBatchSubscribe([["$iTXT:tt:content:drawer:add",$iTXT.core.Event.bind(this,this._addDrawerContent)],["$iTXT:tt:content:drawer:open",$iTXT.core.Event.bind(this,this._showDrawerContent)],["$iTXT:tt:content:drawer:close",$iTXT.core.Event.bind(this,this._hideDrawerContent)],["$iTXT:tt:content:drawers:reset",$iTXT.core.Event.bind(this,this._resetDrawers)],["$iTXT:tt:close:btn:click",$iTXT.core.Event.bind(this,this._hdrCloseClk)],["$iTXT:tt:what:btn:click",$iTXT.core.Event.bind(this,this._hdrWhatsClk)],["$iTXT:tt:vmlogo:click",$iTXT.core.Event.bind(this,this._hdrVMLogoClk)],["$iTXT:function:setClickThrough",$iTXT.core.Event.bind(this,this._setClickThrough)],["$iTXT:tt:content:change:ad",$iTXT.core.Event.bind(this,this.changeAdvert)],["$iTXT:tt:ready",$iTXT.core.Event.bind(this,this._tooltipReady)]],this.evtDspFuncs);this.drawers=[];},setSize:function(w,h,$super) {$iTXT.debug.debug($iTXT.debug.Category.UI,"TooltipContent.setSize("+w+", "+h+")");$super(w,h);this.loadingDiv.itxtSetStyle({width:w+"px",height:h+"px"});this.loadingImg.itxtSetStyle({marginLeft:-(this.loadingImg.offsetWidth/2)+"px",marginTop:-(this.loadingImg.offsetHeight/2)+"px"});},resize:function(w,h,force) {if(null!==this.template) {var nW=w||this.currentWidth||this.template.defaultWidth;var nH=h||this.currentHeight||this.template.defaultHeight;this.setSize(nW,nH);var dim=this.template.resize(nW,nH,force);if(!force) {this.width=dim[0];this.height=dim[1];}} this.setSize(this.width,this.height);this._resizeDrawers();},hideContent:function() {if(null!==this.template&&null!==this.template.rootElement) {this.template.rootElement.style.visibility="hidden";}},showContent:function() {if(null!==this.template&&null!==this.template.rootElement) {this.template.rootElement.style.visibility="visible";if(this.template.afterShow) {this.template.afterShow();}}},tryResize:function(w,h) {if(null!==this.template) {var nW=w||this.currentWidth||this.template.defaultWidth;var nH=h||this.currentHeight||this.template.defaultHeight;var dim=this.template.resize(nW,nH);this.width=dim[0];this.height=dim[1];} return[this.width,this.height];},setContentSize:function(w,h,hO) {if(hO) {this.heightOverlap=hO;} $iTXT.debug.debug($iTXT.debug.Category.UI,"setContentSize("+w+", "+h+")");this.currentWidth=w;this.currentHeight=h;this.resize(null,null,true);},setAdvert:function(ad,$super) {$iTXT.debug.debug($iTXT.debug.Category.UI,"Set New Tooltip Advert");$super(ad);this.ccTS=(new Date()).getTime();this._changeAdvert(ad);},changeAdvert:function(e,$super) {$iTXT.debug.debug($iTXT.debug.Category.UI,"Update Tooltip Advert");$super(e.data);this._changeAdvert(e.data);},_changeAdvert:function(ad,$super) {if(!ad) {return;} this.loadingImg.src=this.options.loadingImage;this.heightOverlap=0;var h=this.advert.params.get("FTROVERLAP");if(null!==h) {this.heightOverlap=h;} this.currentWidth=undefined;this.currentHeight=undefined;if(this.template) {this.template.remove();this.template=null;} this.template=this.advert.getTemplate();if(null!==this.template) {this.rootElement.appendChild(this.template.rootElement);window.setTimeout($iTXT.core.Event.bind(this,this._handleAdvert),1);if(!this.advert.template.fullyBuilt) {this.setLoading(true);}}},_handleAdvert:function() {$iTXT.debug.debug($iTXT.debug.Category.UI,"Calling the templates advert handler");var adHandler=this.template.getAdvertHandler();adHandler.handle($iTXT.core.Event.bind(this,this._handleAdvertCallback));},_handleAdvertCallback:function() {this.template.buildTemplate($iTXT.core.Event.bind(this,this._templateLoadCallback));},_templateLoadCallback:function(templateNode) {$iTXT.debug.info($iTXT.debug.Category.UI,"All Template Content Loaded");var td=(new Date()).getTime()-this.ccTS;var tout=Math.max(250-td,0);$iTXT.debug.info($iTXT.debug.Category.UI,"Sleeping Template Display For: "+tout+"ms");$iTXT.core.$(document).itxtFire("$iTXT:tt:content:loaded",{loadTimeout:tout});},beforeOpen:function() {if(null!==this.template) {this.template.beforeOpen();}},afterOpen:function(chrome) {if(null!==this.template) {this.template.afterOpen(chrome);}},beforeClose:function() {if(null!==this.template) {this.template.beforeClose();}},afterClose:function() {if(null!==this.template) {this.template.afterClose();this.template.remove();this.template=null;}},afterExpand:function(khrome){if(null!==this.template) {this.template.afterExpand(khrome);}},getTemplateDefaultWidth:function() {return this.template?this.template.defaultWidth:0;},getTemplateDefaultHeight:function() {return this.template?this.template.defaultHeight:0;},getExpandedWidth:function() {return this.template?(this.template.expandedWidth||this.template.defaultWidth):0;},getExpandedHeight:function() {return this.template?(this.template.expandedHeight||this.template.defaultHeight):0;},setLoading:function(b) {this.loading=b;if(this.loading) {$iTXT.debug.debug($iTXT.debug.Category.UI,"Tooltip Loading: <b>true</b>");if(""!==this.options.loadingImage) {this.loadingDiv.itxtShow();} if(this.template) {this.template.onHide();} this.hideContent();} else {$iTXT.debug.debug($iTXT.debug.Category.UI,"Tooltip Loading: <b>false</b>");this.loadingDiv.itxtHide();if(this.template) {this.template.onShow();} this.showContent();}},_allLoaded:function() {$iTXT.core.$(document).itxtFire("$iTXT:tt:resize:smooth",$iTXT.core.Event.bind(this,this._finishSmoothRs));},_finishSmoothRs:function() {$iTXT.debug.debug($iTXT.debug.Category.UI,"Tooltip smooth resize finished!");this.setLoading(false);},getWidth:function() {return parseInt(this.width,10);},getHeight:function() {return parseInt(this.height,10);},_addDrawerContent:function(e) {var d=e.data||null;if(null!==d) {this.rootElement.itxtAppendChild(d.drawerContent);d.setSize(this.width,this.height);d.drawerContent.itxtSetStyle({left:"0px",top:this.height+"px"});this.drawers.push(d);}},_showDrawerContent:function(e) {var openDrawer=e.data||null;var closeDrawer,dr;for(var i=0;i<this.drawers.length;i++) {dr=this.drawers[i];if(openDrawer!=dr&&dr.isOpen) {closeDrawer=dr;break;}} if(openDrawer&&closeDrawer) {new $iTXT.fx.Queue(new $iTXT.fx.Move({target:dr.drawerContent,dX:0,y:this.height,duration:150,afterFinish:function(){closeDrawer.startHide();}})).push(new $iTXT.fx.Move({target:openDrawer.drawerContent,dX:0,y:0,duration:150,afterFinish:function(){openDrawer.finishShow();}}));} else if(openDrawer) {new $iTXT.fx.Move({start:true,target:openDrawer.drawerContent,dX:0,y:0,duration:150,afterFinish:function(){openDrawer.finishShow();}});}},_hideDrawerContent:function(e) {var closeDrawer=e.data||null;if(null!==closeDrawer) {closeDrawer.startHide();new $iTXT.fx.Move({start:true,target:closeDrawer.drawerContent,dX:0,y:this.height,duration:150});}},_resetDrawers:function() {if(this.drawers) {for(var i=0;i<this.drawers.length;i++) {var d=this.drawers[i];this.rootElement.removeChild(d.drawerContent);}} this.drawers=[];},_resizeDrawers:function() {if(!this.drawers) return;for(var i=0;i<this.drawers.length;i++) {var d=this.drawers[i];d.setSize(this.width,this.height);if(!d.isOpen) {d.drawerContent.itxtSetStyle({top:this.height+"px"});}}},_hdrCloseClk:function(e) {if(this.template&&this.template.onCloseClick&&this.template.onCloseClick()) {e.closeSource=$iTXT.data.TTCloseSource.CLOSECLICK;$iTXT.core.$(document).itxtFire("$iTXT:tt:close",e);}},_hdrWhatsClk:function() {if(this.template&&this.template.onWhatsThisClick&&this.template.onWhatsThisClick()) {this._defWhatsThisClk();}},_hdrVMLogoClk:function() {if(this.template&&this.template.onVibrantLogoClick&&this.template.onVibrantLogoClick()) {this._defWhatsThisClk();}},_defWhatsThisClk:function() {var adPms=this.advert.params;var wtcl=adPms.get("wtcl");if(wtcl&&"template"==wtcl) {var opts={mt:20,mv:adPms.get("A.AT"),ipid:adPms.get("IPID")};$iTXT.fire("$iTXT:data:log:monitor",opts);}},_setClickThrough:function(e) {var opts=e.data||{};if(opts.url){if(opts.did!=this.advert.did){$iTXT.debug.debug($iTXT.debug.Category.UI,"opts.did ("+opts.did+") does not match advert.did ("+this.advert.did+"), ignoring");return;} this.advert.params.set("CLICKTAG",opts.url,$iTXT.cnst.WEIGHTING_DEFAULT_CAMPAIGN);}},clearContent:function() {if(this.template) {this.template.remove();this.template=null;}},_tooltipReady:function() {this.setLoading(false);}});};$iTXT.js.loader["$iTXT.ui_impetus.TooltipDrawer"]=true;$iTXT.ui_impetus=$iTXT.ui_impetus||{};$iTXT.ui_impetus.TooltipDrawer_Load=function(){$iTXT.ui_impetus.TooltipDrawer=$iTXT.core.Class.create($iTXT.ui.ComponentBase,{options:null,isOpen:false,parent:null,contentWidth:0,contentHeight:0,init:function(_options,$super) {this.componentParams=$iTXT.core.Util.extend({'DRAWERNAME':'${TITLE}','DRAWERTITLEOPEN':'Click to close ${DRAWERNAME}','DRAWERTITLECLOSED':'Click to open ${DRAWERNAME}','DRAWERICON':'http://images.intellitxt.com/ast/adTypes/3b.gif'},this.componentParams);var defOpts=$iTXT.core.Util.extend({id:"itxtdrawer",height:21,margins:[1,1,2,2,4,6],colors:["#aaaaaa","#b6b6b6","#a7a7a7","#979797","#888888","#797979","#6b6b6b","#5f5f5f","#545454","#4b4b4b","#010101","#010101","#060606","#0d0d0d","#161616","#202020","#2b2b2b","#363636","#414141","#4b4b4b","#525252"],onColors:[],drawerTitleOpen:"${DRAWERTITLEOPEN}",drawerTitleClosed:"${DRAWERTITLECLOSED}",drawerIcon:"${DRAWERICON}"},_options);$super(defOpts);this.height=this.options.height;if(!this.options.lastDrawer) {this.options.margins=[];} this._build();this.rootElement.itxtBatchSubscribe([["click",$iTXT.core.Event.bind(this,this._mouseClick)],["mouseover",$iTXT.core.Event.bind(this,this._mouseOver)],["mouseout",$iTXT.core.Event.bind(this,this._mouseOut)]],this.evtDspFuncs);this.parent=this.options.parent||{};$iTXT.core.$(document).itxtBatchSubscribe([["$iTXT:tt:element:loaded",$iTXT.core.Event.bind(this,this._checkLoaded)]],this.evtDspFuncs);$iTXT.core.$(document).itxtFire("$iTXT:tt:content:drawer:add",this);},_build:function() {var childNodes=[];this.bgDiv=$iTXT.core.Builder.make("DIV",{className:"itxtbg"});childNodes.push(this.bgDiv);for(var i=0;i<this.options.height;i++) {var bgCol=this.options.colors[i]||"black";var m=(i>(this.options.height-6))?this.options.margins[i-(this.options.height-6)]:0;this.bgDiv.appendChild(this._createDiv(m,m,bgCol));} this.statusIcon=$iTXT.core.Builder.make("IMG",{className:"itxtstatusicon",src:"http://mymachine.intellitxt.com/testpages/wb678/imgs/drawers_open.gif"});this.typeIcon=$iTXT.core.Builder.make("IMG",{className:"itxticon",src:this.options.drawerIcon});this.textSpan=$iTXT.core.Builder.make("SPAN",{className:"itxtcontentout"},[this.options.drawerTitleClosed]);this.contentDiv=$iTXT.core.Builder.make("DIV",{className:"itxtcontentoff"},[this.typeIcon,this.textSpan,this.statusIcon]);childNodes.push(this.contentDiv);this.rootElement.itxtAppendChildren(childNodes);this.drawerContent=$iTXT.core.Builder.make("DIV",{className:"itxtdrawercontent"});},_createDiv:function(lm,rm,bgc) {return $iTXT.core.Builder.make("DIV",{className:"itxtftr",style:"background-color: "+bgc+"; margin-left: "+(lm||0)+"px; margin-right:"+(rm||0)+"px"});},setStatus:function(b) {this.isOpen=b;if(this.isOpen) {this.toggleGradient(false);this.contentDiv.itxtAddClass("itxtcontenton","itxtcontentoff");this.statusIcon.src="http://mymachine.intellitxt.com/testpages/wb678/imgs/drawers_close.gif";this.textSpan.innerHTML=this.options.drawerTitleOpen;this.createDrawerContent();$iTXT.core.$(document).itxtFire("$iTXT:tt:content:drawer:open",this);} else {this.toggleGradient(true);this.contentDiv.itxtAddClass("itxtcontentoff","itxtcontenton");this.statusIcon.src="http://mymachine.intellitxt.com/testpages/wb678/imgs/drawers_open.gif";this.textSpan.innerHTML=this.options.drawerTitleClosed;$iTXT.core.$(document).itxtFire("$iTXT:tt:content:drawer:close",this);}},_mouseClick:function() {this.setStatus(!this.isOpen);if(this.parent.setActive) {this.parent.setActive(this,this.isOpen);}},_mouseOver:function() {this.textSpan.itxtAddClass("itxtcontentover","itxtcontentout");},_mouseOut:function() {this.textSpan.itxtAddClass("itxtcontentout","itxtcontentover");},toggleGradient:function(b) {var bgCol;for(var i=0;i<this.bgDiv.children.length;i++) {var c=this.bgDiv.children[i];if(b) {bgCol=this.options.colors[i]||"black";c.itxtSetStyle({backgroundColor:bgCol});} else {bgCol="black";c.itxtSetStyle({backgroundColor:bgCol});}}},finishShow:function() {this.template.rootElement.style.visibility="visible";},startHide:function() {},setSize:function(w,h) {this.drawerContent.itxtSetStyle({width:w+"px",height:h+"px"});this.contentWidth=w;this.contentHeight=h;},createDrawerContent:function() {if(!this.template) {this.template=this.options.advert.getTemplate();if(this.template) {this.template.beforeBuild();this.templateRoot=this.template.build(this.options.advert);this.drawerContent.appendChild(this.templateRoot);this.template.afterBuild();var bgcol=this.template.options.bgcol||this.options.advert.params.get("ttbg",this.template.options.ttbg||"#fbfbfb");this.drawerContent.itxtSetStyle({backgroundColor:bgcol});}} this.template.resize(this.contentWidth,this.contentHeight,true);this.template.rootElement.style.visibility="visible";},_checkLoaded:function(e) {if(e.data&&e.data==this.options.advert&&this.template&&this.template.checkLoaded()) {this.template.resize(this.contentWidth,this.contentHeight,true);}}});};$iTXT.js.loader["$iTXT.ui_impetus.TooltipDrawerFooter"]=true;$iTXT.ui_impetus=$iTXT.ui_impetus||{};$iTXT.ui_impetus.TooltipDrawerFooter_Load=function(){$iTXT.ui_impetus.TooltipDrawerFooter=$iTXT.core.Class.create($iTXT.ui.ComponentBase,{options:null,drawers:[],init:function(_options,$super) {var defOpts=$iTXT.core.Util.extend({id:"itxtdrawerfooter",height:21,margins:[1,1,2,2,4,6]},_options);$super(defOpts);this.bgColor=this.options.bgcol;this._build();this.height=0;},setSize:function(w,h,$super) {$super(w,this.height);},_build:function() {},_createDrawer:function(i,ad,last) {var d=new $iTXT.ui.TooltipDrawer({lastDrawer:last,margins:this.options.margins,parent:this,advert:ad});this.drawers.push(d);var t=this.options.height*i;d.rootElement.itxtSetStyle({top:t+"px"});this.rootElement.appendChild(d.rootElement);},setAdvert:function(a,$super) {$iTXT.core.$(document).itxtFire("$iTXT:tt:content:drawers:reset");if(this.drawers.length>0) {for(var i=0;i<this.drawers.length;i++) {this.drawers[i].dispose();} this.drawers=[];} var drwAds=a.params.get("DRAWERADVERTS");if(null!==drwAds) {for(var j=0;j<drwAds.length;j++) {var dad=drwAds[j];this._createDrawer(j,dad,(j==(drwAds.length-1)));}} if(this.drawers.length===0) {this.rootElement.itxtHide();} else {this.rootElement.itxtShow();this.height=this.drawers.length*this.options.height;} $super(a);},hasDrawers:function() {return this.drawers.length>0;},setActive:function(drawer,isActive) {for(var i=0;i<this.drawers.length;i++) {var d=this.drawers[i];if(d!=drawer) {d.setStatus(false);}}}});};$iTXT.js.loader["$iTXT.ui_impetus.TooltipFooter"]=true;$iTXT.ui_impetus=$iTXT.ui_impetus||{};$iTXT.ui_impetus.TooltipFooter_Load=function(){$iTXT.ui_impetus.TooltipFooter=$iTXT.core.Class.create($iTXT.ui.ComponentBase,{options:null,init:function(_options,$super) {var defOpts=$iTXT.core.Util.extend({id:"itxtfooter",height:6},_options);$super(defOpts);this.height=this.options.height;},setSize:function(w,h,$super) {$super(w,this.height);},build:function() {var b=$iTXT.core.Builder;var cont=b.makeEl("div",{},[b.makeEl("div",{"id":"itxt12_ftr_left "},[],{resets:"itxt12_ftr_left itxt12_sprited"}),b.makeEl("div",{"id":"itxt12_ftr_mid"},[],{resets:"itxt12_ftr_mid itxt12_sprited"}),b.makeEl("div",{"id":"itxt12_ftr_right"},[],{resets:"itxt12_ftr_right itxt12_sprited"})],{resets:"itxt12_ftr"});this.rootElement.appendChild(cont);},setAdvert:function(ad,$super) {this.hasDrawers=true;var h=ad.params.get("FTRHIGHT");if(null!==h) {this.height=h;} else {this.height=this.options.height;} this.rootElement.itxtSetStyle({backgroundColor:"transparent"});$super(ad);var adopts=ad.params;var tmpl=this.advert.getTemplate();var tmplopts=(null!==tmpl)?(tmpl.options||{}):{};},_onMouseOver:function(e) {$iTXT.core.$(document).itxtFire("$iTXT:tt:ftr:mouse:over",e);},_onMouseOut:function(e) {$iTXT.core.$(document).itxtFire("$iTXT:tt:ftr:mouse:out",e);},_onMouseClick:function(e) {$iTXT.core.$(document).itxtFire("$iTXT:tt:ftr:mouse:click",e);},setDrawers:function(b) {this.hasDrawers=b;this.height=0;}});};$iTXT.js.loader["$iTXT.ui_impetus.TooltipHeader"]=true;$iTXT.ui_impetus=$iTXT.ui_impetus||{};$iTXT.ui_impetus.TooltipHeader_Load=function(){$iTXT.ui_impetus.TooltipHeader=$iTXT.core.Class.create($iTXT.ui.ComponentBase,{adchoices:null,whatsthis:null,options:{},init:function(_options,$super) {this.componentParams=$iTXT.core.Util.extend({'hdr.privacyicon.txt':'${trans.privacyicon.txt}'},this.componentParams);var defOpts=$iTXT.core.Util.extend({id:"itxtheader",height:30,defbgcol:"#F0F0F0",privIconTxt:"${hdr.privacyicon.txt}"},_options);$super(defOpts);var o=this.options;this.height=this.options.height;this.rootElement.itxtBatchSubscribe([["mouseover",function(e){$iTXT.core.$(document).itxtFire("$iTXT:tt:hdr:mouse:over",e);}],["mouseout",function(e){$iTXT.core.$(document).itxtFire("$iTXT:tt:hdr:mouse:out",e);}]],this.evtDspFuncs);},setSize:function(w,h,$super) {$super(w,this.options.height);},build:function() {var b=$iTXT.core.Builder;this.rootElement.ondragstart=function(){return false;};this.rootElement.onselectstart=function(){return false;};if(!this.options.draggable) {this.rootElement.className="fixed";} this.cornerHolder=b.make("DIV",{className:"itxtcrnhldr"},[b.makeEl("div",{},[],{resets:"itxt12_tlc itxt12_sprited"}),b.makeEl("div",{},[],{resets:"itxt12_tm itxt12_sprited"}),b.makeEl("div",{},[],{resets:"itxt12_trc itxt12_sprited"})]);this.rootElement.appendChild(this.cornerHolder);var ad_choice=this._buildAdChoices();var what_this=this._buildWhatsThis();this.rootElement.appendChild(this._buildBlock([this.buildLogo(),ad_choice],"itxt12_hdr_lft"));this.rootElement.appendChild(this._buildBlock([what_this,this.buildCloseButton()],"itxt12_hdr_rt"));this.rootElement.appendChild(this._buildUnderLine());this.adchoices=ad_choice;this.whatsthis=what_this;this.rootElement.itxtSubscribe("mousedown",$iTXT.core.Event.bind(this,this._hdrDown));this.rootElement.itxtSubscribe("mouseup",$iTXT.core.Event.bind(this,this._hdrUp));},_buildBlock:function(children,klass){return $iTXT.core.Builder.makeEl("div",{className:klass},children,{noResets:true});},showAdChoices:function(){this.adchoices.style.display="block";this.whatsthis.style.display="none";},hideAdChoices:function(){this.adchoices.style.display="none";this.whatsthis.style.display="block";},buildLogo:function() {var pubLogo=decodeURIComponent($iTXT.glob.params.get('hdr.logo'));if("null"==pubLogo||pubLogo.indexOf('vm_logo2009')>=0){pubLogo=null;} var vmLogo;if(pubLogo){var pubLogoEl=$iTXT.core.Builder.make("APNG",{className:"itxtvmlogo",src:pubLogo});vmLogo=$iTXT.core.Builder.makeEl("div",{className:"itxt12_publogo"},[pubLogoEl],{noResets:true});}else{vmLogo=$iTXT.core.Builder.makeEl("div",{className:"itxt12_vmlogo itxt_sprited"},[],{noResets:true});this.spritedInteraction(vmLogo,{over:{x:-60,y:-123},out:{x:-60,y:-93},down:{x:-60,y:-123}});} vmLogo.ondragstart=function(){return false;};vmLogo.itxtSubscribe("mousedown",function(e){$iTXT.core.Event.preventDefault(e);});vmLogo.itxtSubscribe("click",$iTXT.core.Event.bind(this,this._vmLogoBtnClk));var vmLogoWrapper=$iTXT.core.Builder.make("A",{target:'_blank'},[vmLogo]);return vmLogoWrapper;},spritedInteraction:function(el,pos_arr,targEl,otherfx){var actor=targEl||el;el.itxtSubscribe("mouseover",function(){actor.style.backgroundPosition=pos_arr.over.x+"px "+pos_arr.over.y+"px";if(otherfx!==undefined)otherfx("over");});el.itxtSubscribe("mouseout",function(){actor.style.backgroundPosition=pos_arr.out.x+"px "+pos_arr.out.y+"px";if(otherfx!==undefined)otherfx("out");});el.itxtSubscribe("mousedown",function(){actor.style.backgroundPosition=pos_arr.down.x+"px "+pos_arr.down.y+"px";if(otherfx!==undefined)otherfx("down");});},buildCloseButton:function() {var closeBtn=$iTXT.core.Builder.makeEl("div",{},[],{resets:"itxt12_cls_btn"});this.spritedInteraction(closeBtn,{over:{x:-60,y:-30},out:{x:-60,y:0},down:{x:-60,y:-60}});closeBtn.itxtSubscribe("click",$iTXT.core.Event.bind(this,this._closeBtnClk));return closeBtn;},_buildAdChoices:function() {var logo=$iTXT.core.Builder.makeEl("div",{id:"itxt_ad_choices"},[],{resets:"itxt12_adchoices"});var txt=$iTXT.core.Builder.makeEl("div",{},[this.options.privIconTxt],{resets:"itxt12_adchoices_txt"});var priv=$iTXT.core.Builder.makeEl("div",{},[logo,txt],{resets:"itxt12_priv"});var hlText=function(st){switch(st){case"over":txt.style.color="#333333";break;case"down":txt.style.color="#333333";break;default:txt.style.color="#bababa";}};this.spritedInteraction(priv,{over:{x:-67,y:-173},out:{x:-67,y:-153},down:{x:-67,y:-173}},logo,hlText);priv.itxtSubscribe("click",$iTXT.core.Event.bind(this,this._onPrivacyIconClick));return priv;},_buildWhatsThis:function(){var wassit=$iTXT.core.Builder.makeEl("div",{id:"itxt_whats_this"},[],{resets:"itxt12_sprited"});this.spritedInteraction(wassit,{over:{x:-19,y:-172},out:{x:-6,y:-172},down:{x:-32,y:-172}});wassit.itxtSubscribe("click",$iTXT.core.Event.bind(this,this._whatBtnClk));return wassit;},_buildUnderLine:function(){var underline=$iTXT.core.Builder.makeEl("div",{id:"itxt_underliner"},[],{resets:"itxt_underliner"});underline.innerHTML='&nbsp;';return underline;},_onPrivacyIconClick:function() {var opts={mt:124,mv:this.advert.params.get("A.AT"),ipid:this.advert.params.get("IPID")};$iTXT.fire("$iTXT:data:log:monitor",opts);var wtUrl=this.advert.params.parse("${tt.wturl}");$iTXT.core.Util.openUrl(this.advert.params.parse(this.advert.params.get(this.advert.params.parse("tt.privacyicon.url.${cc}"),wtUrl)),false);},_hdrDown:function(e) {if(this._hdrTarget(e.target)) {$iTXT.core.$(document).itxtFire("$iTXT:tt:hdr:mouse:down",e);}},_hdrUp:function(e) {if(this._hdrTarget(e.target)) {$iTXT.core.$(document).itxtFire("$iTXT:tt:hdr:mouse:up",e);}},_hdrTarget:function(t) {return((t!=this.closeBtn)&&(t!=this.whatBtn)&&(t!=this.vmLogo));},_closeBtnClk:function(e) {$iTXT.core.$(document).itxtFire("$iTXT:tt:close:btn:click");},_whatBtnClk:function(e) {$iTXT.core.$(document).itxtFire("$iTXT:tt:what:btn:click");var wtUrl=this.advert.params.parse("${tt.wturl}");$iTXT.core.Util.openUrl(wtUrl,false);},_vmLogoBtnClk:function() {$iTXT.core.$(document).itxtFire("$iTXT:tt:vmlogo:click");var wtUrl=this.advert.params.parse("${tt.wturl}");$iTXT.core.Util.openUrl(wtUrl);},setAdvert:function(ad,$super) {if(this.advert==ad){return;} if(ad.useAdChoices()){this.showAdChoices();}else{this.hideAdChoices();} $super(ad);}});};$iTXT.js.loader["$iTXT.ui_impetus.TooltipShadow"]=true;$iTXT.ui_impetus=$iTXT.ui_impetus||{};$iTXT.ui_impetus.TooltipShadow_Load=function(){$iTXT.ui_impetus.TooltipShadow=$iTXT.core.Class.create($iTXT.ui.ComponentBase,{options:null,contentWidth:0,contentHeight:0,whAdjust:0,transparentTooltip:false,init:function(_options,$super) {this.updateAdjust();this.componentParams=$iTXT.core.Util.extend({'tt.shadow.img.name':'lg_shadow_sprite.png','tt.shadow.img':'${tt.img.dir}${tt.shadow.img.name}'},this.componentParams);var defOpts=$iTXT.core.Util.extend({id:"itxtshadow",size:6,ps:$iTXT.ui.TooltipPosition.AR,tailWidth:58,tailHeight:36,showTail:true,shadowImage:"${tt.shadow.img}"},_options);this.lastPS=$iTXT.ui.TooltipPosition.AR;$super(defOpts);var o=this.options;$iTXT.core.Util.cacheImages([o.shadowImage]);var b=$iTXT.core.Builder;this.spriteImages=[b.make("APNG",{src:o.shadowImage,width:765,height:641}),b.make("APNG",{src:o.shadowImage,width:765,height:641}),b.make("APNG",{src:o.shadowImage,width:765,height:641}),b.make("APNG",{src:o.shadowImage,width:765,height:641}),b.make("APNG",{src:o.shadowImage,width:765,height:641}),b.make("APNG",{src:o.shadowImage,width:765,height:641}),b.make("APNG",{src:o.shadowImage,width:765,height:641}),b.make("APNG",{src:o.shadowImage,width:765,height:641})];this.spriteHolders=[b.make("DIV",{style:"width: 765px; height: 641px;"},[this.spriteImages[0]]),b.make("DIV",{style:"width: 765px; height: 641px;"},[this.spriteImages[1]]),b.make("DIV",{style:"width: 765px; height: 641px;"},[this.spriteImages[2]]),b.make("DIV",{style:"width: 765px; height: 641px;"},[this.spriteImages[3]]),b.make("DIV",{style:"width: 765px; height: 641px;"},[this.spriteImages[4]]),b.make("DIV",{style:"width: 765px; height: 641px;"},[this.spriteImages[5]]),b.make("DIV",{style:"width: 765px; height: 641px;"},[this.spriteImages[6]]),b.make("DIV",{style:"width: 765px; height: 641px;"},[this.spriteImages[7]])];this.divTL=b.make("DIV",{className:"itxtshdw itxttl"},[this.spriteHolders[0]]);this.divBL=b.make("DIV",{className:"itxtshdw itxtbl"},[this.spriteHolders[1]]);this.divTR=b.make("DIV",{className:"itxtshdw itxttr"},[this.spriteHolders[2]]);this.divBR=b.make("DIV",{className:"itxtshdw itxtbr"},[this.spriteHolders[3]]);this.divTM=b.make("DIV",{className:"itxtshdw itxttm"},[this.spriteHolders[4]]);this.divBM=b.make("DIV",{className:"itxtshdw itxtbm"},[this.spriteHolders[5]]);this.divFILL=b.make("DIV",{className:"itxtshdw itxtfill"},[this.spriteHolders[6]]);this.divTAIL=b.make("DIV",{className:"itxtshdw itxttail"},[this.spriteHolders[7]]);this.rootElement.itxtAppendChildren([this.divTL,this.divBL,this.divTR,this.divBR,this.divTM,this.divBM,this.divFILL,this.divTAIL]);this.rootElement.itxtBatchSubscribe([["mouseover",function(e){$iTXT.core.$(document).itxtFire("$iTXT:tt:shdw:mouse:over",e);e.stop();}],["mouseout",function(e){$iTXT.core.$(document).itxtFire("$iTXT:tt:shdw:mouse:out",e);e.stop();}]],this.evtDspFuncs);},_refresh:function() {},setPositionState:function(ps) {this.options.ps=ps;if(this.divTAIL.firstChild) {this.divTAIL.firstChild.itxtAddClass(this.options.ps,this.lastPS);} if(this.divFILL.firstChild) {this.divFILL.firstChild.itxtAddClass(this.options.ps,this.lastPS);} this.lastPS=ps;this.setSize(this.contentWidth,this.contentHeight);},setSize:function(w,h) {this.contentWidth=w;this.contentHeight=h;var ttps=$iTXT.ui.TooltipPosition;var tailW=58;var tailH=36;var tailOff=22;var tailInd=tailH-tailOff;var tMarg=((ttps.BR==this.options.ps)||(ttps.BL==this.options.ps))?tailOff:0;this.width=w+(this.options.size*2);this.height=h+(this.options.size*2);var intHght=h+(this.options.size*2)-tailOff;if(this.rootElement.itxtSetStyle){this.rootElement.itxtSetStyle({width:this.width+"px",height:this.height+"px"});} var tH=Math.ceil(intHght/2);var bH=intHght-tH;var mW=this.width-100;var tMW=this.options.showTail?(mW-tailW):mW;var tML=this.options.showTail?(tailW+50):50;this.divBL.firstChild.itxtSetStyle({top:(-(512-bH))+"px"});this.divBR.firstChild.itxtSetStyle({top:(-(512-bH))+"px"});this.divBM.firstChild.itxtSetStyle({top:(-(512-bH))+"px"});this.divFILL.firstChild.itxtSetStyle({top:""});var leftW=(50-this.whAdjust);this.divTL.itxtSetStyle({top:tMarg+"px",left:"0px",width:leftW+"px",height:(tH-this.whAdjust)+"px"});this.divBL.itxtSetStyle({top:(tH+tMarg)+"px",left:"0px",width:leftW+"px",height:bH+"px"});this.divTR.itxtSetStyle({top:tMarg+"px",left:(mW+50)+"px",width:"50px",height:(tH-this.whAdjust)+"px"});this.divBR.itxtSetStyle({top:(tH+tMarg)+"px",left:(mW+50)+"px",width:"50px",height:bH+"px"});if(ttps.AR==this.options.ps) {this.divTM.itxtSetStyle({top:tMarg+"px",left:"50px",width:(mW-this.whAdjust)+"px",height:(tH-this.whAdjust)+"px"});this.divBM.itxtSetStyle({top:(tH+tMarg)+"px",left:tML+"px",width:(tMW-this.whAdjust)+"px",height:bH+"px"});this.divFILL.itxtSetStyle({top:(tH+tMarg)+"px",left:"50px",width:(tailW-this.whAdjust)+"px",height:(bH-tailInd)+"px"});this.divTAIL.itxtSetStyle({top:(intHght-tailInd)+"px",left:"50px",width:(tailW-this.whAdjust)+"px",height:tailH+"px"});this.divFILL.firstChild.itxtSetStyle({top:(-(512-bH))+"px"});} else if(ttps.AL==this.options.ps) {this.divTM.itxtSetStyle({top:tMarg+"px",left:"50px",width:(mW-this.whAdjust)+"px",height:(tH-this.whAdjust)+"px"});this.divBM.itxtSetStyle({top:(tH+tMarg)+"px",left:"50px",width:(tMW-this.whAdjust)+"px",height:bH+"px"});this.divFILL.itxtSetStyle({top:(tH+tMarg)+"px",left:(mW-tailW+50)+"px",width:(tailW-this.whAdjust)+"px",height:(bH-tailInd)+"px"});this.divTAIL.itxtSetStyle({top:(intHght-tailInd)+"px",left:(mW-tailW+50)+"px",width:(tailW-this.whAdjust)+"px",height:tailH+"px"});this.divFILL.firstChild.itxtSetStyle({top:(-(512-bH))+"px"});} else if(ttps.BR==this.options.ps) {this.divTM.itxtSetStyle({top:tMarg+"px",left:tML+"px",width:(tMW-this.whAdjust)+"px",height:(tH-this.whAdjust)+"px"});this.divBM.itxtSetStyle({top:(tH+tMarg)+"px",left:"50px",width:(mW-this.whAdjust)+"px",height:bH+"px"});this.divFILL.itxtSetStyle({top:tailH+"px",left:"50px",width:(tailW-this.whAdjust)+"px",height:(tH-tailInd-this.whAdjust)+"px"});this.divTAIL.itxtSetStyle({top:"0px",left:"50px",width:(tailW-this.whAdjust)+"px",height:(tailH-this.whAdjust)+"px"});} else if(ttps.BL==this.options.ps) {this.divTM.itxtSetStyle({top:tMarg+"px",left:"50px",width:(tMW-this.whAdjust)+"px",height:(tH-this.whAdjust)+"px"});this.divBM.itxtSetStyle({top:(tH+tMarg)+"px",left:"50px",width:(mW-this.whAdjust)+"px",height:bH+"px"});this.divFILL.itxtSetStyle({top:tailH+"px",left:(mW-tailW+50)+"px",width:(tailW-this.whAdjust)+"px",height:(tH-tailInd-this.whAdjust)+"px"});this.divTAIL.itxtSetStyle({top:"0px",left:(mW-tailW+50)+"px",width:(tailW-this.whAdjust)+"px",height:(tailH-this.whAdjust)+"px"});} this.divTAIL.itxtSetStyle({display:(this.options.showTail?"":"none")});this.divFILL.itxtSetStyle({display:(this.options.showTail?"":"none")});},getShadowSize:function() {return this.options.size;},fadeIn:function() {$iTXT.core.$(document).itxtFire("$iTXT:tts:before:fade:in");var fadeTo=1;if(window.ActiveXObject) {fadeTo=0.45;} var fadeFrom=0;if(window.ActiveXObject) {fadeFrom=0.02;} this.show();for(var i=0;i<this.spriteHolders.length;i++) {this.spriteHolders[i].itxtOpacity(0);} var t=this;new $iTXT.fx.Fade({to:fadeTo,delay:100,target:this.rootElement,start:true,duration:400,notifyOnly:true,afterUpdate:function(o) {for(var i=0;i<t.spriteHolders.length;i++) {t.spriteHolders[i].itxtOpacity(o);}},afterFinish:function() {$iTXT.core.$(document).itxtFire("$iTXT:tts:after:fade:in");}});},showTail:function() {if(!this.options.showTail) {this.options.showTail=true;this.setSize(this.contentWidth,this.contentHeight);}},hideTail:function() {if(this.options.showTail) {this.options.showTail=false;this.setSize(this.contentWidth,this.contentHeight);}},setAdvert:function(ad,$super) {if(this.advert==ad) return;var adopts=ad.params;var tmpl=ad.getTemplate();var tmplopts=(null!==tmpl)?(tmpl.options||{}):{};this.transparentTooltip=tmplopts.transparentTooltip||false;this.updateAdjust();var oldSprite=this.options.shadowImage;$super(ad);if(oldSprite!=this.options.shadowImage) {for(var i=0;i<this.spriteImages.length;i++) {this.spriteImages[i].itxtChangeSrc(this.options.shadowImage);}}},updateAdjust:function() {if((undefined!==$iTXT.core.Browser.ie8CompatMode)&&(this.transparentTooltip&&($iTXT.core.Browser.is("Explorer",8)||$iTXT.core.Browser.ie8CompatMode||$iTXT.core.Browser.quirksMode||($iTXT.core.Browser.is("Explorer",7)&&!$iTXT.core.Browser.ie8CompatMode)))) {this.whAdjust=1;} else {this.whAdjust=0;}}});};$iTXT.js.loader["$iTXT.ui_impetus.TooltipSlideOut"]=true;$iTXT.ui_impetus=$iTXT.ui_impetus||{};$iTXT.ui_impetus.TooltipSlideOut_Load=function(){$iTXT.ui_impetus.TooltipSlideOut=$iTXT.core.Class.create($iTXT.ui.ComponentBase,{css3Mode:false,open:false,opening:false,ttWidth:0,ttHeight:0,offsetLeft:0,offsetTop:0,closeDX:0,closeDY:0,ison:false,init:function(_options,$super) {this.css3Mode=$iTXT.core.Browser.supportsFeature('cssgradients','cssborderradius');this.componentParams={'tt.so.width':300,'tt.so.height':250,'tt.so.img.dir':'http://images.intellitxt.com/ast/vmimages/ttso/','tt.so.btn.off':'${tt.so.img.dir}close_off.gif','tt.so.btn.on':'${tt.so.img.dir}close_on.gif','tt.so.btn.width':'13','tt.so.btn.height':'13','iefh':'','tt.so.content':'${iefh}'};var defOpts=$iTXT.core.Util.extend({id:"itxtslideout",headerHeight:21,margins:[6,4,2,2,1,1],background:"#545454",opacity:0.85,title:"${sspl}",direction:"L",padding:10,content:"${tt.so.content}",duration:500,width:'${tt.so.width}',height:'${tt.so.height}',btnOff:'${tt.so.btn.off}',btnOn:'${tt.so.btn.on}',btnWidth:'${tt.so.btn.width}',btnHeight:'${tt.so.btn.height}'},_options);$super(defOpts);this.rootElement.itxtSetStyle({position:'absolute'});if(this.css3Mode) {this.rootElement.appendChild(this._buildBgCSS3());} else {this.rootElement.appendChild(this._buildBg());} this.rootElement.appendChild(this._buildHeader());this.rootElement.appendChild(this._buildContent());$iTXT.core.$(document).itxtSubscribe("$iTXT:tt:open",$iTXT.core.Event.bind(this,this.ttOpen));},setSize:function(w,h) {var d=$iTXT.ui.TooltipSlideOutDirection;var o=this.options;this.ttWidth=w;this.ttHeight=h;this.width=parseInt(o.width,10)+(2*o.padding);this.height=parseInt(o.height,10)+o.padding+o.headerHeight;if(d.RIGHT==o.direction||d.LEFT==o.direction) {this.height=this.ttHeight;this.width=Math.min(this.ttWidth,this.width);} else {this.width=this.ttWidth;this.height=Math.min(this.ttHeight,this.height);} this._sizeContent();},setOffset:function(l,t) {this.offsetLeft=l;this.offsetTop=t;},ttOpen:function() {if(this.open||this.opening) {return;} if(this.ison) {var d=$iTXT.ui.TooltipSlideOutDirection;var o=this.options;var ttl=$iTXT.ui.tt.getLeft();var winSize=$iTXT.core.Util.getWindowSize();var winW=winSize.width;var rightSpace=winW-ttl-this.ttWidth;var rightPercent=rightSpace/this.width;var leftSpace=ttl;var leftPercent=leftSpace/this.width;if(rightPercent>leftPercent) {o.direction=d.RIGHT;} else {o.direction=d.LEFT;} var startX=0,startY=0,moveX=0,moveY=0;if(d.RIGHT==o.direction) {var diff=this.ttWidth-this.width;startX=diff;moveX=this.width-o.padding;this.headerTitle.itxtSetStyle({marginLeft:(o.padding*2)+"px"});this.headerBtn.itxtSetStyle({marginRight:"4px"});} else if(d.LEFT==o.direction) {moveX=-(this.width-o.padding);this.headerTitle.itxtSetStyle({marginLeft:(o.padding)+"px"});this.headerBtn.itxtSetStyle({marginRight:(o.padding+4)+"px"});} else if(d.UP==o.direction) {} else if(d.DOWN==o.direction) {} this.rootElement.itxtSetStyle({left:(startX+this.offsetLeft)+"px",top:(startY+this.offsetTop)+"px",width:this.width+"px",height:this.height+"px"});this.content.itxtHide();this.show();this.closeDX=-moveX;this.closeDY=-moveY;var t=this;this.opening=true;var opts={target:this.rootElement,start:true,dX:moveX,dY:moveY,duration:this.options.duration,afterFinish:function() {t.open=true;t.opening=false;t.content.innerHTML=o.content;t.content.itxtShow();}};new $iTXT.fx.Move(opts);} else {this.hide();}},close:function() {var t=this;this.opening=true;var opts={target:this.rootElement,start:true,dX:this.closeDX,dY:this.closeDY,duration:this.options.duration,afterFinish:function() {t.open=false;t.opening=false;t.hide();}};new $iTXT.fx.Move(opts);},setAdvert:function(ad,$super) {$super(ad);this.open=this.opening=false;this.ison=ad.params.getBool("iesoa",false)&&ad.params.getBool("tmpl.soa.enabled",false);var o=this.options;this.headerTitle.innerHTML=o.title;var opts={ll:'0',llip:'0',hbll:'0',uf:null,ur:null};opts.so=$iTXT.data.ClickSource.LOGO;this.params.set('stub.tu',$iTXT.data.al.getClickURL(this,opts),$iTXT.cnst.WEIGHTING_DEFAULT_CAMPAIGN);opts.so=$iTXT.data.ClickSource.ICON;this.params.set('stub.t',$iTXT.data.al.getClickURL(this,opts),$iTXT.cnst.WEIGHTING_DEFAULT_CAMPAIGN);opts.so='0';opts.av=1;this.params.set('stub.av',$iTXT.data.al.getClickURL(this,opts,$iTXT.data.al.avPrms,true),$iTXT.cnst.WEIGHTING_DEFAULT_CAMPAIGN);},_buildBgCSS3:function() {var b=$iTXT.core.Builder;var o=this.options;this.bgElement=b.make("DIV");this.bgElement.itxtSetStyle({width:'100%',height:'100%',backgroundColor:o.background,opacity:o.opacity,filter:'alpha(opacity='+(o.opacity*100)+')','borderRadius':'7px','WebkitBorderRadius':'7px','MozBorderRadius':'7px'});return this.bgElement;},_buildBg:function() {var b=$iTXT.core.Builder;var o=this.options;var topCorners=b.make("DIV");topCorners.itxtSetStyle({width:'100%',height:'6px'});for(var i=0;i<6;i++) {topCorners.appendChild(this._createDiv(i));} var bottomCorners=b.make("DIV");bottomCorners.itxtSetStyle({width:'100%',height:'6px'});for(var j=0;j<6;j++) {bottomCorners.appendChild(this._createDiv(5-j));} this.bgContent=b.make("DIV");this.bgContent.itxtSetStyle({backgroundColor:o.background,width:'100%',height:'100%'});this.bgElement=b.make("DIV",{},[topCorners,this.bgContent,bottomCorners]);this.bgElement.itxtSetStyle({width:'100%',height:'100%',opacity:o.opacity,filter:'alpha(opacity='+(o.opacity*100)+')'});return this.bgElement;},_createDiv:function(i) {var lm=this.options.margins[i];var rm=this.options.margins[i];var d=$iTXT.core.Builder.make("DIV",{width:'auto',style:"overflow:hidden;padding:0;line-height:0;height:1px;font-size:1px;padding:0;background-color: "+this.options.background+";margin:0;margin-left:"+lm+"px;margin-right:"+rm+"px;"});return d;},_buildHeader:function() {var b=$iTXT.core.Builder;var o=this.options;this.headerBtn=b.make("IMG",{src:o.btnOff,width:o.btnWidth,height:o.btnHeight,style:'vertical-align:middle;float:right;margin-right:4px;margin-top:4px;'});this.headerBtn.itxtSubscribe('mouseover',function(){this.src=o.btnOn;});this.headerBtn.itxtSubscribe('mouseout',function(){this.src=o.btnOff;});this.headerBtn.itxtSubscribe('click',$iTXT.core.Event.bind(this,this.close));this.headerTitle=b.make("SPAN",{style:'margin-left: '+o.padding*2+'px;line-height:'+o.headerHeight+'px;'},[o.title]);this.header=b.make("DIV",{style:'position:absolute;left:0;top:0;width:100%;height:'+o.headerHeight+'px;line-height:'+o.headerHeight+'px;color:white;font-size:11px;font-weight:bold;'},[this.headerBtn,this.headerTitle]);return this.header;},_buildContent:function() {var b=$iTXT.core.Builder;var o=this.options;var ch=this.height-o.headerHeight-o.padding;var w=this.width-(o.padding*3);var l=o.padding*2;this.content=b.make("DIV",{style:'overflow:hidden;position:absolute;left:'+l+'px;top:'+o.headerHeight+'px;width:100%;height:'+ch+'px;width:'+w+'px;'});return this.content;},_sizeContent:function() {var o=this.options;var h=this.height-o.headerHeight-o.padding;var w=this.width-(o.padding*3);var l=o.padding*2;var t=o.headerHeight;this.content.itxtSetStyle({left:l+'px',top:t+'px',width:w+'px',height:h+'px'});if(this.bgContent) {this.bgContent.style.height=(this.height-12)+"px";}}});};$iTXT.js.loader["$iTXT.ui_impetus.TooltipTail"]=true;$iTXT.ui_impetus=$iTXT.ui_impetus||{};$iTXT.ui_impetus.TooltipTail_Load=function(){$iTXT.ui_impetus.TooltipTail=$iTXT.core.Class.create($iTXT.ui.ComponentBase,{options:null,init:function(_options,$super) {var defOpts=$iTXT.core.Util.extend({id:"itxttail",height:22,bgcol:[],transparent:false},_options);$super(defOpts);this.width=46;this.height=22;this._build();this.resize();},setPositionState:function(ps) {this.options.ps=ps;if($iTXT.ui.TooltipPosition.BL==ps||$iTXT.ui.TooltipPosition.BR==ps) {var tmpl=this.advert.getTemplate();var tmplopts=(null!==tmpl)?(tmpl.options||{}):{};this.options.transparent=(tmplopts.transparenttoptail===true);} else {this.options.transparent=false;} this._build();this.resize();},_build:function() {this.rootElement.innerHTML="";var ttps=$iTXT.ui.TooltipPosition;var tail=$iTXT.core.Builder.make("div",{id:"itxt12_tail",className:"itxt12_tail itxt12_sprited"},[]);var poses;switch(this.options.ps){case ttps.BL:poses="-3px -101px";break;case ttps.AL:poses="-3px -131px";break;case ttps.BR:poses="-3px -40px";break;default:poses="-3px -70px";} tail.itxtSetStyle({backgroundPosition:poses,marginTop:(this.options.ps==ttps.AL||this.options.ps==ttps.AR?'-4px':'-1px')});this.rootElement.itxtAppendChild(tail);},setAdvert:function(ad,$super) {this.customBgCol=undefined;$super(ad);},tooltipOver:function() {},tooltipOut:function() {},getHeight:function($super) {if(this.advert.getAdvertType()===155){return 0;}else{return $super();}}});}; ; 